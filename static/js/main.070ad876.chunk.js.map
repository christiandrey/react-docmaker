{"version":3,"sources":["../../src/core/constants/index.ts","../../src/core/utils/index.ts","../../src/core/tools/index.ts","../../src/modules/button/index.tsx","../../src/modules/header/index.tsx","../../src/core/contexts/orphan-nodes.ts","../../src/modules/template-editor/index.tsx","../../src/modules/elements/image/index.tsx","../../src/modules/elements/editable/index.tsx","../../src/modules/template-element/index.tsx","../../src/modules/template-leaf/index.tsx","../../src/core/hooks/index.ts","../../src/modules/icon/index.tsx","../../src/modules/popup/content/index.tsx","../../src/modules/popup/index.tsx","../../src/modules/popups/image/index.tsx","../../src/modules/popups/color/index.tsx","../../src/modules/field/index.tsx","../../src/modules/popups/condition/index.tsx","../../src/modules/segmented-control/index.tsx","../../src/modules/popups/editable/copy-existing/index.tsx","../../src/modules/switch/index.tsx","../../src/modules/popups/editable/create-new/index.tsx","../../src/modules/popups/editable/index.tsx","../../src/modules/icon-button/index.tsx","../../src/modules/icon-group/index.tsx","../../src/modules/popups/image-size/index.tsx","../../src/modules/popups/orphan-nodes/index.tsx","../../src/modules/popups/text-size/index.tsx","../../src/modules/toolbar/index.tsx","../../src/core/plugins/paste-html.ts","../../src/index.tsx","../../src/core/plugins/editable.ts","App.tsx","index.tsx"],"names":["LIST_TYPES","HOT_KEYS","PRESET_COLORS","ALIGNMENTS","EDITABLE_DATA_TYPES","text","options","radio","date","time","DATE_FORMATS","TIME_FORMATS","nil","value","notNil","getImageSizeAsync","url","Promise","resolve","img","document","width","height","naturalHeight","clamp","min","max","Math","parseNumber","parsed","parseFloat","isNaN","formatDate","dateTime","token","format","Date","error","isHexColor","test","areEqualColors","left","right","generateUUID","uuidv4","isBlockActive","editor","match","n","Editor","SlateElement","isMarkActive","marks","nodesInSelection","getMatchingNodesInSelection","o","editableNodes","marksResolution","editablesResolution","includes","getColorMark","marksValue","editablesValue","toggleMarkActive","Transforms","hanging","toggleColorMarkActive","existingMark","color","toggleBlockActive","split","type","setBlockInactive","isList","newProperties","block","children","setBlockActive","focusEditor","ReactEditor","composeWithClassName","attributes","className","classnames","composeWithAlignmentClassName","alignment","composeWithStyle","style","getCurrentNode","selection","parentNode","getIndentation","currentNode","getIndentationPercent","composeWithEditable","editable","id","createEditableNode","isOrphan","editableNode","insertImageBlock","dimensions","label","imageNode","insertEditableBlock","getEditableAttributes","showTip","valueRef","parsedAttributes","dataType","defaultValue","getEditableAttributesValidity","copyExisting","tip","dateTimeFormat","getMatchingNodes","node","matching","child","generator","Array","Button","memo","onPress","onClick","Header","onPressSave","editorRef","useRef","state","innerRef","css","placeholder","html","current","onChange","event","onBlur","onChangeTitle","createdAt","toCapitalizedFirst","formatRelative","disabled","OrphanNodesContext","createContext","TemplateEditor","ImageElement","element","selected","useSelected","focused","useFocused","useMemo","src","EditableElement","useEffect","fontSize","contentEditable","TemplateElement","paddingLeft","indentation","React","href","TemplateLeaf","leaf","usePopupUtils","initialOpen","useState","handleOpen","useCallback","setVisible","handleClose","handleToggle","popupActions","visible","open","close","toggle","useEditor","useSlate","useAlignmentValue","getAlignment","useMouseDown","fn","e","useOrphanNodes","useContext","Icon","handlePress","onMouseDown","cloneElement","Content","hideArrow","x","y","useLayoutEffect","computedDimensions","JSON","setDimensions","onLayoutUpdate","composedClassName","arrowClassName","arrow","top","getViewportWidth","window","getViewportHeight","getPositioningWithoutAnchor","viewportWidth","viewportHeight","getValidPositioning","contentPosition","anchorElement","anchorRef","position","anchorY","anchorX","anchorWidth","anchorHeight","getPositioningWithAnchor","xOffset","offsets","yOffset","rightEdge","bottomEdge","Popup","onRequestClose","handleClickOverlay","handleKeyUp","isVisible","transparent","contentClassName","popupContentPosition","setPopupContentPosition","distance","overlayCloseOnClick","ImagePopup","onSubmitEditing","decimalScale","handleChangeImageUrl","setImageState","handleChangeScale","setScaleState","handleBlurImageInput","a","imageState","setImageDimensions","handleRequestClose","handlePressSubmit","imageDimensions","maxLength","scaleState","ColorBox","title","active","ColorPopup","handlePressColorOption","option","selectedColor","setColorState","onChangeColorOption","handleChangeInput","inputValue","parsedColor","key","colorState","Field","ConditionPopup","isValid","parent","handleChangeParent","setParent","setValue","handleChangeValue","hidden","SegmentedControl","onChangeValue","i","handlePressOption","EditableCopyExisting","onSubmit","handleChangeValueRef","setValueRef","setDefaultValue","handleChangeDefaultValue","data","Switch","checked","offColor","onColor","checkedIcon","uncheckedIcon","handleDiameter","activeBoxShadow","EditableCreateNew","now","dataTypeOptions","Object","dateFormatOptions","timeFormatOptions","handlePressDeleteOption","eventualValue","index","setOptions","handlePressAddOption","editingOption","groundValue","setEditingOption","handleEditingOptionKeydown","multiline","handleChangeDataType","setDataType","setDateTimeFormat","handleChangeDateTimeFormat","handleChangeEditingOption","handleChangeLabel","setLabel","handleChangeTip","setTip","setMultiline","onKeyDown","setShowTip","setIsOrphan","EditablePopupProps","handleSubmit","setSegment","segment","IconButton","forwardRef","ref","IconGroup","ImageSizePopup","handleChangeWidth","setWidth","handleChangeHeight","setHeight","OrphanNodesPopup","handlePressDelete","setOrphanNodes","orphanNodes","TextSizeOption","TextSizePopup","onPressOption","Toolbar","editorSelection","textSizePopupAnchorRef","colorPopupAnchorRef","imagePopupAnchorRef","imageSizePopupAnchorRef","conditionPopupAnchorRef","orphanNodesPopupAnchorRef","textSizePopup","colorPopup","imagePopup","imageSizePopup","editablePopup","conditionPopup","orphanNodesPopup","textSizeValue","headingOneActive","headingTwoActive","headingThreeActive","name","results","useTextSizeValue","leafColorValue","alignmentValue","canUndo","useCanUndo","canRedo","useCanRedo","conditionActive","handleChangeTextSizeOption","prevValue","handleChangeColorOption","focus","handleCreateImage","handleCreateEditableImage","handleCreateEditable","handleSetConditionActive","condition","setConditionActive","handlePressTextSize","handlePressColor","handlePressImage","handlePressEditableImage","handlePressInsertEditable","handlePressCondition","unsetConditionActive","handlePressInlineFormat","handlePressAlignment","setAlignment","handlePressIncreaseIndentation","increaseIndentation","handlePressDecreaseIndentation","decreaseIndentation","handlePressNumberedList","handlePressBulletedList","handlePressUndo","HistoryEditor","handlePressRedo","backgroundColor","ELEMENT_TAGS","A","BLOCKQUOTE","H1","H2","H3","H4","H5","H6","IMG","LI","OL","P","PRE","UL","TEXT_TAGS","CODE","code","DEL","strikethrough","EM","italic","I","S","STRONG","bold","U","underline","withHTML","isVoid","isInline","console","fragment","el","deserializeHTML","nodeName","jsx","attrs","DOMParser","parseFromString","insertData","DocmakerEditor","onSubmitChanges","initialData","initialValue","withEditable","withReact","withHistory","createEditor","toDate","renderElement","props","renderLeaf","handleEditorKeydown","isHotkey","hotkey","handlePressSave","nodes","orphans","editorState","setEditorState","setTitle","spellCheck","App","log","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.070ad876.chunk.js","sourcesContent":["export const LIST_TYPES = ['numbered-list', 'bulleted-list']\n\nexport const HOT_KEYS = {\n  'mod+b': 'bold',\n  'mod+i': 'italic',\n  'mod+u': 'underline',\n  'mod+shift+x': 'strikethrough'\n}\n\nexport const PRESET_COLORS = [\n  '#FF6900',\n  '#FCB900',\n  '#7BDCB5',\n  '#00D084',\n  '#8ED1FC',\n  '#326FF3',\n  '#ABB8C3',\n  '#EB144C',\n  '#F78DA7',\n  '#9900EF'\n]\n\nexport const ALIGNMENTS = {\n  left: 'left',\n  right: 'right',\n  center: 'center',\n  justify: 'justify'\n}\n\nexport const INDENTATION_FACTOR = 3\n\nexport const EDITABLE_DATA_TYPES = {\n  text: 'Text',\n  options: 'Dropdown',\n  radio: 'Radio',\n  date: 'Date',\n  time: 'Time'\n}\n\nexport const DATE_FORMATS = [\n  'do MMMM, yyyy',\n  'dd MMMM, yyyy',\n  'MMMM dd, yyyy',\n  'dd/MM/yyyy',\n  'MM/dd/yyyy',\n  'MMM d, yyyy',\n  'dd MMM, yy',\n  'dd-MM-yyyy',\n  'dd-MM-yy'\n]\n\nexport const TIME_FORMATS = ['hh:mm a', 'hh:mm aaaa', 'HH:mm']\n","import format from 'date-fns/format'\nimport formatRelative from 'date-fns/formatRelative'\nimport { v4 as uuidv4 } from 'uuid'\n\nexport type ValidDate = Date | string | number\n\nexport type ImageDimensions = {\n  width: number\n  height: number\n}\n\n// ----------------------------------------------------------------\n// UTILITY\n// ----------------------------------------------------------------\n\nexport function nil<T>(value: T): boolean {\n  return typeof value === 'undefined' || value === null\n}\n\nexport function notNil<T>(value: T): boolean {\n  return !nil(value)\n}\n\nexport function getImageSizeAsync(url: string): Promise<ImageDimensions> {\n  if (!url) {\n    return null\n  }\n\n  return new Promise((resolve) => {\n    const img = document.createElement('img')\n\n    img.onload = () => {\n      resolve({ width: img.naturalWidth, height: img.naturalHeight })\n    }\n\n    img.onerror = () => {\n      resolve(null)\n    }\n\n    img.src = url\n  })\n}\n\n// ----------------------------------------------------------------\n// NUMBER\n// ----------------------------------------------------------------\nexport function clamp(value: number, min: number, max: number) {\n  return Math.min(Math.max(value, min), max)\n}\n\nexport function parseNumber(value: string): number {\n  if (nil(value)) {\n    return null\n  }\n\n  const parsed = parseFloat(value)\n  return isNaN(parsed) ? 0 : parsed\n}\n\n// ----------------------------------------------------------------\n// DATETIME\n// ----------------------------------------------------------------\n\nexport function fromNow(dateTime: ValidDate): string {\n  return formatRelative(new Date(dateTime), new Date())\n}\n\nexport function formatDate(dateTime: ValidDate, token = 'yyyy-MM-dd'): string {\n  if (nil(dateTime)) return undefined\n\n  try {\n    return format(\n      dateTime instanceof Date ? dateTime : new Date(dateTime),\n      token\n    )\n  } catch (error) {\n    return undefined\n  }\n}\n\nexport function toDate(dateTime: ValidDate): Date {\n  if (!dateTime) {\n    return new Date()\n  }\n\n  return dateTime instanceof Date ? dateTime : new Date(dateTime)\n}\n\n// ----------------------------------------------------------------\n// STRING\n// ----------------------------------------------------------------\n\nexport function toTitleCase(text: string) {\n  if (nil(text)) {\n    return text\n  }\n  return `${text[0]?.toUpperCase()}${text?.substr(1).toLowerCase()}`\n}\n\nexport function toCapitalizedFirst(text: string) {\n  if (nil(text)) {\n    return text\n  }\n  return `${text[0]?.toUpperCase()}${text?.substr(1)}`\n}\n\nexport function stripHTMLEntities(text: string) {\n  return text\n    ?.replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/\"/g, '&nbsp;')\n}\n\nexport function isHexColor(text: string) {\n  return /^#([0-9A-F]{3}){1,2}$/i.test(text)\n}\n\nexport function areEqualColors(left: string, right: string) {\n  left = left?.replace(/^#/gi, '')?.toLowerCase()\n  right = right?.replace(/^#/gi, '')?.toLowerCase()\n\n  return left === right\n}\n\nexport function getPlaceholderImage(width: number, height?: number) {\n  return `https://dummyimage.com/${width}x${height || width}/326FF3/FFFFFF`\n}\n\nexport function generateUUID() {\n  return uuidv4()\n}\n","import { Editor, Node, Element as SlateElement, Transforms } from 'slate'\nimport { INDENTATION_FACTOR, LIST_TYPES } from '../constants'\nimport { areEqualColors, clamp, generateUUID, nil, notNil } from '../utils'\n\nimport { CSSProperties } from 'react'\nimport { HistoryEditor } from 'slate-history'\nimport { ImageElementType } from '../../modules/elements/image'\nimport { ImageProps } from '../../modules/popups/image'\nimport { ReactEditor } from 'slate-react'\nimport classnames from 'classnames'\n\nexport type BlockAlignment = 'left' | 'center' | 'right' | 'justify'\n\nexport type LeafFormatType =\n  | 'bold'\n  | 'code'\n  | 'italic'\n  | 'underline'\n  | 'strikethrough'\n  | 'color'\n  | 'ref'\n\nexport type HeadingFormatType = 'heading-one' | 'heading-two' | 'heading-three'\n\nexport type ListFormatType = 'numbered-list' | 'bulleted-list'\n\nexport type QuoteFormatType = 'block-quote'\n\nexport type ElementFormatType =\n  | HeadingFormatType\n  | ListFormatType\n  | QuoteFormatType\n\nexport type SlateEditorType = Editor & ReactEditor & HistoryEditor\n\nexport type EditableElementType<T> = {\n  id?: string\n  editable?: true\n} & T\n\nexport type EditableDataType =\n  | 'text'\n  | 'options'\n  | 'radio'\n  | 'time'\n  | 'date'\n  | 'image'\n\nexport type EditableOption = {\n  id: string\n  label: string\n}\n\nexport type EditableRefAttributes = {\n  parent: string\n  value: string\n}\n\nexport type EditableAttributes = Partial<{\n  dataType: EditableDataType\n  dateTimeFormat: string\n  defaultValue: string\n  label: string\n  multiline: boolean\n  options: Array<EditableOption>\n  tip: string\n  valueRef: string\n  ref: EditableRefAttributes\n  isOrphan: boolean\n  children: Array<EditableAttributes & { text: string }>\n}>\n\nexport type DocmakerNode = EditableElementType<\n  EditableAttributes & { text: string }\n>\n\nexport type DocmakerData = Partial<{\n  title: string\n  createdAt: string\n  nodes: Array<DocmakerNode>\n  orphans: Array<DocmakerNode>\n}>\n\nexport function isBlockActive(\n  editor: SlateEditorType,\n  format: ElementFormatType\n) {\n  const [match] = Editor.nodes(editor, {\n    match: (n) =>\n      !Editor.isEditor(n) && SlateElement.isElement(n) && n.type === format\n  }) as any\n\n  return !!match\n}\n\nexport function isMarkActiveLegacy(\n  editor: SlateEditorType,\n  format: LeafFormatType\n) {\n  if (!editor) {\n    return null\n  }\n\n  const marks = Editor.marks(editor)\n\n  if (notNil(marks)) {\n    const value = marks[format]\n    return format === 'ref' ? notNil(value) : value === true\n  }\n\n  return false\n}\n\nexport function isMarkActive(editor: SlateEditorType, format: LeafFormatType) {\n  if (!editor) {\n    return null\n  }\n\n  const marks = Editor.marks(editor)\n  const nodesInSelection = getMatchingNodesInSelection(editor, (o) =>\n    Editor.isInline(editor, o)\n  )\n  const editableNodes = getMatchingNodesInSelection(\n    editor,\n    (o) => o.type === 'editable'\n  )\n\n  let marksResolution = false\n  let editablesResolution = false\n\n  if (notNil(marks)) {\n    const value = marks[format]\n    marksResolution = ['color', 'ref'].includes(format)\n      ? notNil(value)\n      : value === true\n  }\n\n  if (editableNodes?.length) {\n    editablesResolution = editableNodes\n      .map((o) =>\n        ['color', 'ref'].includes(format)\n          ? notNil(o[format])\n          : o[format] === true\n      )\n      .every((o) => o)\n  }\n\n  if (\n    nodesInSelection?.length &&\n    nodesInSelection.every((o) => editableNodes.includes(o))\n  ) {\n    return editablesResolution\n  }\n\n  return editableNodes?.length\n    ? editablesResolution && marksResolution\n    : marksResolution\n}\n\nexport function isColorMarkActive(editor: SlateEditorType) {\n  if (!editor) {\n    return null\n  }\n\n  const marks = Editor.marks(editor)\n  return marks ? notNil(marks.color) : false\n}\n\nexport function getColorMark(editor: SlateEditorType) {\n  if (!editor) {\n    return null\n  }\n\n  const marks = Editor.marks(editor)\n  const nodesInSelection = getMatchingNodesInSelection(editor, (o) =>\n    Editor.isInline(editor, o)\n  )\n  const editableNodes = getMatchingNodesInSelection(\n    editor,\n    (o) => o.type === 'editable'\n  )\n\n  const marksValue = marks?.color\n  let editablesValue = null\n\n  if (editableNodes?.length) {\n    editablesValue = editableNodes[0].color\n  }\n\n  if (\n    nodesInSelection?.length &&\n    nodesInSelection.every((o) => editableNodes.includes(o))\n  ) {\n    return editablesValue\n  }\n\n  return editableNodes?.length ? editablesValue : marksValue\n}\n\nexport function toggleMarkActiveLegacy(\n  editor: SlateEditorType,\n  format: LeafFormatType\n) {\n  const isActive = isMarkActive(editor, format)\n\n  if (isActive) {\n    Editor.removeMark(editor, format)\n  } else {\n    Editor.addMark(editor, format, true)\n  }\n}\n\nexport function toggleMarkActive(\n  editor: SlateEditorType,\n  format: LeafFormatType\n) {\n  const isActive = isMarkActive(editor, format)\n\n  if (isActive) {\n    Editor.removeMark(editor, format)\n    Transforms.unsetNodes(editor, format, {\n      match: (o) => Editor.isVoid(editor, o) && o.type === 'editable'\n    })\n  } else {\n    Transforms.setNodes(\n      editor,\n      { [format]: true },\n      {\n        match: (o) => Editor.isVoid(editor, o) && o.type === 'editable',\n        hanging: true\n      }\n    )\n    Editor.addMark(editor, format, true)\n  }\n}\n\nexport function toggleColorMarkActive(editor: SlateEditorType, value?: string) {\n  const existingMark = getColorMark(editor)\n\n  if (notNil(existingMark) && areEqualColors(existingMark, value)) {\n    Editor.removeMark(editor, 'color')\n    Transforms.unsetNodes(editor, 'color', {\n      match: (o) => Editor.isVoid(editor, o) && o.type === 'editable'\n    })\n  } else {\n    Transforms.setNodes(\n      editor,\n      { color: value },\n      {\n        match: (o) => Editor.isVoid(editor, o) && o.type === 'editable',\n        hanging: true\n      }\n    )\n    Editor.addMark(editor, 'color', value)\n  }\n}\n\nexport function toggleBlockActive(\n  editor: SlateEditorType,\n  format: ElementFormatType\n) {\n  const isActive = isBlockActive(editor, format)\n\n  if (isActive) {\n    setBlockInactive(editor)\n    return\n  }\n\n  setBlockActive(editor, format)\n}\n\nexport function setBlockActive(\n  editor: SlateEditorType,\n  format: ElementFormatType\n) {\n  const isList = LIST_TYPES.includes(format)\n\n  Transforms.unwrapNodes(editor, {\n    match: (n) =>\n      LIST_TYPES.includes(\n        !Editor.isEditor(n) && SlateElement.isElement(n) && (n.type as any)\n      ),\n    split: true\n  })\n\n  const newProperties: Partial<SlateElement> = {\n    type: isList ? 'list-item' : format\n  }\n\n  Transforms.setNodes(editor, newProperties)\n\n  if (isList) {\n    const block = { type: format, children: [] }\n    Transforms.wrapNodes(editor, block)\n  }\n}\n\nexport function setBlockInactive(editor: SlateEditorType) {\n  Transforms.unwrapNodes(editor, {\n    match: (n) =>\n      LIST_TYPES.includes(\n        !Editor.isEditor(n) && SlateElement.isElement(n) && (n.type as any)\n      ),\n    split: true\n  })\n\n  const newProperties: Partial<SlateElement> = {\n    type: 'paragraph'\n  }\n\n  Transforms.setNodes(editor, newProperties)\n}\n\nexport function focusEditor(editor: SlateEditorType) {\n  ReactEditor.focus(editor as ReactEditor)\n}\n\nexport function composeWithClassName(attributes: any, className?: string) {\n  return {\n    ...attributes,\n    className: classnames(attributes?.className, className)\n  }\n}\n\nexport function composeWithAlignmentClassName(\n  attributes: any,\n  alignment?: BlockAlignment,\n  className?: string\n) {\n  return {\n    ...attributes,\n    className: classnames(attributes?.className, className, {\n      'text-right': alignment === 'right',\n      'text-center': alignment === 'center',\n      'text-justify': alignment === 'justify'\n    })\n  }\n}\n\nexport function composeWithStyle(attributes: any, style: CSSProperties = {}) {\n  return {\n    ...attributes,\n    style: { ...(attributes?.style || {}), ...style }\n  }\n}\n\nexport function getCurrentNode(editor: SlateEditorType) {\n  const selection = editor?.selection\n\n  if (selection !== null && selection.anchor !== null) {\n    const parentNode = editor.children[selection.anchor.path[0]]\n\n    if (LIST_TYPES.includes(parentNode?.type as BlockAlignment)) {\n      return parentNode.children[selection.anchor.path[1]]\n    }\n\n    return parentNode\n  } else {\n    return null\n  }\n}\n\nexport function getAlignment(editor: SlateEditorType): BlockAlignment {\n  const currentNode = getCurrentNode(editor) as any\n  return currentNode?.alignment\n}\n\nexport function setAlignment(editor: SlateEditorType, value?: BlockAlignment) {\n  const alignment = value === 'left' ? null : value\n  const newProperties: Partial<SlateElement> = {\n    alignment\n  }\n\n  Transforms.setNodes(editor, newProperties)\n}\n\nexport function getIndentation(editor: SlateEditorType): number {\n  const currentNode = getCurrentNode(editor) as any\n  return currentNode?.indentation\n}\n\nexport function getIndentationPercent(value: number): string {\n  if (!value) {\n    return null\n  }\n\n  return `${value}%`\n}\n\nexport function increaseIndentation(editor: SlateEditorType) {\n  const currentIndentation = getIndentation(editor) || 0\n  const indentation = clamp(currentIndentation + INDENTATION_FACTOR, 0, 99)\n  const newProperties: Partial<SlateElement> = {\n    indentation\n  }\n\n  Transforms.setNodes(editor, newProperties)\n}\n\nexport function decreaseIndentation(editor: SlateEditorType) {\n  const currentIndentation = getIndentation(editor) || 0\n  const indentation = clamp(currentIndentation - INDENTATION_FACTOR, 0, 99)\n  const newProperties: Partial<SlateElement> = {\n    indentation: indentation === 0 ? null : indentation\n  }\n\n  Transforms.setNodes(editor, newProperties)\n}\n\nexport function composeWithEditable<T extends object>(\n  attributes: T\n): EditableElementType<T> {\n  if (nil(attributes)) {\n    return null\n  }\n\n  return {\n    ...attributes,\n    editable: true,\n    id: generateUUID()\n  }\n}\n\nexport function createEditableNode(\n  attributes: EditableAttributes,\n  isOrphan = false\n) {\n  let editableNode: SlateElement & EditableAttributes = {\n    type: 'editable',\n    ...attributes,\n    children: [{ text: '' }]\n  }\n\n  if (isOrphan) {\n    editableNode.isOrphan = isOrphan\n  }\n\n  editableNode = composeWithEditable(editableNode)\n\n  return editableNode\n}\n\nexport function insertImageBlock(\n  editor: SlateEditorType,\n  attributes: ImageProps,\n  editable?: boolean\n) {\n  const {\n    url,\n    dimensions: { width, height },\n    label\n  } = attributes\n\n  let imageNode: SlateElement & ImageElementType = {\n    type: 'image',\n    url,\n    width,\n    height,\n    children: [{ text: '' }]\n  }\n\n  if (editable) {\n    imageNode.type = 'editable'\n    imageNode.dataType = 'image'\n    imageNode.label = label\n    imageNode = composeWithEditable(imageNode)\n  }\n\n  Transforms.insertNodes(editor, imageNode)\n  Transforms.move(editor)\n}\n\nexport function insertEditableBlock(\n  editor: SlateEditorType,\n  attributes: EditableAttributes\n) {\n  const editableNode = createEditableNode(attributes)\n\n  Transforms.insertNodes(editor, editableNode)\n  Transforms.move(editor)\n}\n\nexport function getEditableAttributes(\n  attributes: EditableAttributes,\n  showTip = false\n) {\n  const {\n    dataType,\n    dateTimeFormat,\n    multiline,\n    defaultValue,\n    label,\n    options,\n    tip,\n    valueRef\n  } = attributes\n\n  const parsedAttributes = {\n    dataType,\n    defaultValue\n  } as EditableAttributes\n\n  if (valueRef?.length) {\n    parsedAttributes.valueRef = valueRef\n    return parsedAttributes\n  }\n\n  if (showTip) {\n    parsedAttributes.tip = tip\n  }\n\n  if (dataType === 'text' && multiline) {\n    parsedAttributes.multiline = multiline\n  }\n\n  if (['options', 'radio'].includes(dataType)) {\n    parsedAttributes.options = options\n  }\n\n  if (['date', 'time'].includes(dataType)) {\n    parsedAttributes.dateTimeFormat = dateTimeFormat\n  }\n\n  parsedAttributes.label = label\n\n  return parsedAttributes\n}\n\nexport function getEditableAttributesValidity(\n  attributes: EditableAttributes,\n  showTip = false,\n  copyExisting = false\n): boolean {\n  const {\n    dataType,\n    dateTimeFormat,\n    defaultValue,\n    label,\n    options,\n    tip,\n    valueRef\n  } = attributes\n\n  if (copyExisting) {\n    return !!valueRef?.length && !!defaultValue?.length\n  }\n\n  if (\n    !dataType?.length ||\n    !defaultValue?.length ||\n    !label?.length ||\n    (showTip && !tip.length)\n  ) {\n    return false\n  }\n\n  if (['options', 'radio'].includes(dataType)) {\n    return !!options?.length\n  }\n\n  if (['date', 'time'].includes(dataType)) {\n    return !!dateTimeFormat?.length\n  }\n\n  return true\n}\n\nexport function getMatchingNodes(\n  node: Node,\n  match: (node: Node) => boolean = () => true,\n  matching: Array<Node> = []\n) {\n  if (match(node)) {\n    matching.push(node)\n  }\n\n  const children = node.children as Array<Node>\n\n  if (children?.length) {\n    for (const child of children) {\n      getMatchingNodes(child, match, matching)\n    }\n  }\n\n  return matching\n}\n\nexport function getMatchingNodesInSelection(\n  node: SlateEditorType,\n  match: (node: Node) => boolean = () => true\n) {\n  const generator = Editor.nodes(node, {\n    match\n  })\n\n  return Array.from(generator).map((o) => o[0])\n}\n\nexport function setConditionActive(\n  editor: SlateEditorType,\n  condition: EditableRefAttributes\n) {\n  Editor.addMark(editor, 'ref', condition)\n  Transforms.setNodes(\n    editor,\n    { ref: condition },\n    {\n      match: (o) => Editor.isVoid(editor, o) && o.type === 'editable'\n    }\n  )\n}\n\nexport function unsetConditionActive(editor: SlateEditorType) {\n  Editor.removeMark(editor, 'ref')\n  Transforms.unsetNodes(editor, 'ref', {\n    match: (o) => Editor.isVoid(editor, o) && o.type === 'editable'\n  })\n}\n","import React, { FC, memo, PropsWithChildren } from 'react'\nimport classnames from 'classnames'\n\ntype ButtonProps = PropsWithChildren<{\n  className?: string\n  disabled?: boolean\n  onPress?: Fn\n}>\n\nconst BaseButton: FC<ButtonProps> = ({\n  children,\n  className,\n  disabled,\n  onPress\n}) => {\n  return (\n    <button\n      onClick={onPress}\n      className={classnames(\n        'border-transparent rounded-default font-medium cursor-pointer text-white px-18 flex items-center justify-center transition-colors duration-250 hover:bg-blue-600',\n        {\n          'bg-blue-500': !disabled,\n          'pointer-events-none bg-blue-300': disabled,\n          'h-40': !/\\bh-[0-9]/gi.test(className)\n        },\n        className\n      )}\n    >\n      {children}\n    </button>\n  )\n}\n\nconst Button = memo(BaseButton)\n\nexport default Button\n","import React, { FC, useRef } from 'react'\nimport ContentEditable, { ContentEditableEvent } from 'react-contenteditable'\nimport Button from '../button'\nimport classnames from 'classnames'\nimport css from './style.module.css'\nimport { fromNow, toCapitalizedFirst } from '../../core/utils'\n\ntype HeaderProps = {\n  title?: string\n  createdAt?: string\n  onChangeTitle?: (value: string) => void\n  onPressSave?: Fn\n}\n\nconst Header: FC<HeaderProps> = ({\n  title,\n  createdAt,\n  onChangeTitle,\n  onPressSave\n}) => {\n  const editorRef = useRef(null)\n  const state = useRef(title)\n\n  const handleBlur = () => {\n    onChangeTitle?.(state.current)\n  }\n\n  const handleChange = (event: ContentEditableEvent) => {\n    const value = event.target.value\n    state.current = value\n\n    if (value === '<br>') {\n      editorRef.current.innerHTML = ''\n    }\n  }\n\n  return (\n    <div className='bg-white py-18 px-60 flex items-center justify-between'>\n      <div>\n        <ContentEditable\n          innerRef={editorRef}\n          className={classnames(\n            css.container,\n            'text-heading-2 font-medium mb-4'\n          )}\n          placeholder='Untitled document'\n          html={state.current}\n          onChange={handleChange}\n          onBlur={handleBlur}\n        />\n        {createdAt && (\n          <div className='font-medium text-gray-400 text-subhead'>\n            {toCapitalizedFirst(fromNow(createdAt))}\n          </div>\n        )}\n      </div>\n      <Button disabled={!state.current?.length} onPress={onPressSave}>\n        Save changes\n      </Button>\n    </div>\n  )\n}\n\nexport default Header\n","import { createContext, Dispatch, SetStateAction } from 'react'\nimport { Node } from 'slate'\n\nconst OrphanNodesContext = createContext<\n  [Array<Node>, Dispatch<SetStateAction<Array<Node>>>]\n>(null)\n\nexport default OrphanNodesContext\n","import React, { FC } from 'react'\n\ntype TemplateEditorProps = {}\n\nconst TemplateEditor: FC<TemplateEditorProps> = ({ children }) => {\n  return <div className='max-w-6xl m-auto pt-120 pb-120 px-60'>{children}</div>\n}\n\nexport default TemplateEditor\n","import React, { FC, PropsWithChildren, useMemo } from 'react'\nimport { useFocused, useSelected } from 'slate-react'\n\nimport { EditableElementType } from '../../../core/tools'\nimport classnames from 'classnames'\nimport { getPlaceholderImage } from '../../../core/utils'\n\nexport type ImageElementType = EditableElementType<{\n  url: string\n  label?: string\n  width?: number\n  height?: number\n}>\n\ntype ImageElementProps = PropsWithChildren<{\n  attributes: any\n  element: ImageElementType\n}>\n\nconst ImageElement: FC<ImageElementProps> = ({\n  attributes,\n  children,\n  element\n}) => {\n  const selected = useSelected()\n  const focused = useFocused()\n  const url = useMemo(\n    () =>\n      element.editable\n        ? getPlaceholderImage(element.width, element.height)\n        : element.url,\n    [element.editable, element.height, element.url, element.width]\n  )\n\n  return (\n    <span {...attributes}>\n      {children}\n      <img\n        src={url}\n        style={{ width: element.width, height: element.height }}\n        className={classnames(\n          'inline-block max-w-full rounded-default align-bottom',\n          {\n            'shadow-outline': selected && focused\n          }\n        )}\n      />\n    </span>\n  )\n}\n\nexport default ImageElement\n","import {\n  EditableAttributes,\n  EditableElementType,\n  composeWithClassName,\n  composeWithStyle\n} from '../../../core/tools'\nimport React, { FC, PropsWithChildren, useEffect } from 'react'\nimport { useFocused, useSelected } from 'slate-react'\n\nimport classnames from 'classnames'\n\ntype EditableElementProps = PropsWithChildren<{\n  attributes: any\n  element: EditableElementType<EditableAttributes>\n}>\n\nconst EditableElement: FC<EditableElementProps> = ({\n  attributes,\n  children,\n  element\n}) => {\n  const selected = useSelected()\n  const focused = useFocused()\n\n  useEffect(() => {\n    return () => {\n      // TODO: Find refs that match unset ref value\n    }\n  }, [])\n\n  return (\n    <span\n      {...composeWithStyle(\n        composeWithClassName(\n          attributes,\n          classnames(\n            'bg-blue-500 text-white font-medium px-4 py-2 rounded-default mx-1',\n            {\n              'shadow-outline': selected && focused\n            }\n          )\n        ),\n        { fontSize: '0.82em' }\n      )}\n      contentEditable={false}\n    >\n      {element.defaultValue}\n      {children}\n    </span>\n  )\n}\n\nexport default EditableElement\n","import React, { FC, PropsWithChildren } from 'react'\nimport ImageElement, { ImageElementType } from '../elements/image'\nimport {\n  BlockAlignment,\n  composeWithAlignmentClassName,\n  composeWithStyle,\n  EditableAttributes,\n  EditableElementType,\n  getIndentationPercent\n} from '../../core/tools'\nimport EditableElement from '../elements/editable'\n\nexport type ElementType =\n  | 'quote'\n  | 'code'\n  | 'bulleted-list'\n  | 'heading-one'\n  | 'heading-two'\n  | 'heading-three'\n  | 'heading-four'\n  | 'heading-five'\n  | 'heading-six'\n  | 'list-item'\n  | 'numbered-list'\n  | 'link'\n  | 'image'\n  | 'editable'\n\ntype TemplateElementType = {\n  type: ElementType\n  alignment?: BlockAlignment\n  indentation?: number\n} & ImageElementType &\n  EditableElementType<EditableAttributes>\n\ntype TemplateElementProps = PropsWithChildren<{\n  attributes: any\n  element: TemplateElementType\n}>\n\nconst TemplateElement: FC<TemplateElementProps> = ({\n  attributes,\n  children,\n  element\n}) => {\n  const { type, url, alignment, indentation, dataType } = element\n\n  switch (type) {\n    default:\n      return (\n        <p\n          {...composeWithStyle(\n            composeWithAlignmentClassName(attributes, alignment),\n            { paddingLeft: getIndentationPercent(indentation) }\n          )}\n        >\n          {children}\n        </p>\n      )\n    case 'quote':\n      return <blockquote {...attributes}>{children}</blockquote>\n    case 'code':\n      return (\n        <pre>\n          <code {...attributes}>{children}</code>\n        </pre>\n      )\n    case 'bulleted-list':\n      return (\n        <ul\n          {...composeWithAlignmentClassName(\n            attributes,\n            alignment,\n            'list-disc list-inside'\n          )}\n        >\n          {children}\n        </ul>\n      )\n    case 'heading-one':\n      return (\n        <h1\n          {...composeWithStyle(\n            composeWithAlignmentClassName(\n              attributes,\n              alignment,\n              'text-heading-2'\n            ),\n            { paddingLeft: getIndentationPercent(indentation) }\n          )}\n        >\n          {children}\n        </h1>\n      )\n    case 'heading-two':\n      return (\n        <h2\n          {...composeWithStyle(\n            composeWithAlignmentClassName(\n              attributes,\n              alignment,\n              'text-heading-3'\n            ),\n            { paddingLeft: getIndentationPercent(indentation) }\n          )}\n        >\n          {children}\n        </h2>\n      )\n    case 'heading-three':\n      return (\n        <h3\n          {...(composeWithStyle(\n            composeWithAlignmentClassName(\n              attributes,\n              alignment,\n              'text-headline'\n            )\n          ),\n          { paddingLeft: getIndentationPercent(indentation) })}\n        >\n          {children}\n        </h3>\n      )\n    case 'heading-four':\n      return <h4 {...attributes}>{children}</h4>\n    case 'heading-five':\n      return <h5 {...attributes}>{children}</h5>\n    case 'heading-six':\n      return <h6 {...attributes}>{children}</h6>\n    case 'list-item':\n      return (\n        <li\n          {...composeWithStyle(attributes, {\n            paddingLeft: getIndentationPercent(indentation)\n          })}\n        >\n          {children}\n        </li>\n      )\n    case 'numbered-list':\n      return (\n        <ol\n          {...composeWithAlignmentClassName(\n            attributes,\n            alignment,\n            'list-decimal list-inside'\n          )}\n        >\n          {children}\n        </ol>\n      )\n    case 'link':\n      return (\n        <a href={url} {...attributes}>\n          {children}\n        </a>\n      )\n    case 'image':\n      return <ImageElement {...{ attributes, children, element }} />\n    case 'editable':\n      return dataType === 'image' ? (\n        <ImageElement {...{ attributes, children, element }} />\n      ) : (\n        <EditableElement {...{ attributes, children, element }} />\n      )\n  }\n}\n\nexport default TemplateElement\n","import React, { FC, PropsWithChildren } from 'react'\nimport {\n  composeWithClassName,\n  composeWithStyle,\n  EditableRefAttributes\n} from '../../core/tools'\nimport classnames from 'classnames'\nimport { notNil } from '../../core/utils'\n\nexport type TemplateLeafType = Partial<{\n  bold: boolean\n  code: boolean\n  italic: boolean\n  underline: boolean\n  strikethrough: boolean\n  color: string\n  ref: EditableRefAttributes\n}>\n\ntype TemplateLeafProps = PropsWithChildren<{\n  attributes: any\n  leaf: TemplateLeafType\n}>\n\nconst TemplateLeaf: FC<TemplateLeafProps> = ({\n  attributes,\n  children,\n  leaf\n}) => {\n  if (leaf.bold) {\n    children = <strong>{children}</strong>\n  }\n\n  if (leaf.code) {\n    children = <code>{children}</code>\n  }\n\n  if (leaf.italic) {\n    children = <em>{children}</em>\n  }\n\n  if (leaf.underline) {\n    children = <u>{children}</u>\n  }\n\n  if (leaf.strikethrough) {\n    children = <del>{children}</del>\n  }\n\n  return (\n    <span\n      {...composeWithClassName(\n        composeWithStyle(attributes, { color: leaf.color }),\n        classnames({ 'bg-green-highlight': notNil(leaf.ref) })\n      )}\n    >\n      {children}\n    </span>\n  )\n}\n\nexport default TemplateLeaf\n","import { useState, useCallback, useMemo, MouseEvent, useContext } from 'react'\nimport { useSlate } from 'slate-react'\nimport OrphanNodesContext from '../contexts/orphan-nodes'\nimport {\n  BlockAlignment,\n  getAlignment,\n  getColorMark,\n  HeadingFormatType,\n  isBlockActive,\n  isMarkActive,\n  SlateEditorType\n} from '../tools'\n\ntype PopupActions = {\n  visible: boolean\n  open: Fn\n  close: Fn\n  toggle: Fn\n}\n\nexport type TextSizeValue = {\n  name: HeadingFormatType\n  label: string\n  value: boolean\n}\n\nexport function usePopupUtils(initialOpen: boolean = false): PopupActions {\n  const [visible, setVisible] = useState(initialOpen)\n\n  const handleOpen = useCallback(() => {\n    setVisible(true)\n  }, [])\n\n  const handleClose = useCallback(() => {\n    setVisible(false)\n  }, [])\n\n  const handleToggle = useCallback(() => {\n    setVisible((o) => !o)\n  }, [])\n\n  const popupActions: PopupActions = useMemo(\n    () => ({\n      visible,\n      open: handleOpen,\n      close: handleClose,\n      toggle: handleToggle\n    }),\n    [handleClose, handleOpen, handleToggle, visible]\n  )\n\n  return popupActions\n}\n\nexport function useEditor(): SlateEditorType {\n  return useSlate() as SlateEditorType\n}\n\nexport function useTextSizeValue(): TextSizeValue {\n  const editor = useEditor()\n\n  const headingOneActive = isBlockActive(editor, 'heading-one')\n  const headingTwoActive = isBlockActive(editor, 'heading-two')\n  const headingThreeActive = isBlockActive(editor, 'heading-three')\n\n  const results = useMemo(\n    () =>\n      [\n        { name: 'heading-one', label: 'Heading 1', value: headingOneActive },\n        { name: 'heading-two', label: 'Heading 2', value: headingTwoActive },\n        { name: 'heading-three', label: 'Heading 3', value: headingThreeActive }\n      ] as Array<TextSizeValue>,\n    [headingOneActive, headingThreeActive, headingTwoActive]\n  )\n\n  return results.find((o) => o.value)\n}\n\nexport function useLeafColorValue(): string {\n  const editor = useEditor()\n  return getColorMark(editor)\n}\n\nexport function useAlignmentValue(): BlockAlignment {\n  const editor = useEditor()\n  return getAlignment(editor)\n}\n\nexport function useMouseDown(fn: Fn): (e: MouseEvent) => void {\n  return useCallback(\n    (e: MouseEvent) => {\n      e?.preventDefault()\n      fn?.()\n    },\n    [fn]\n  )\n}\n\nexport function useCanUndo(): boolean {\n  const editor = useEditor()\n  return !!editor.history?.undos?.length\n}\n\nexport function useCanRedo(): boolean {\n  const editor = useEditor()\n  return !!editor.history?.redos?.length\n}\n\nexport function useConditionActive(): boolean {\n  const editor = useEditor()\n  return isMarkActive(editor, 'ref')\n}\n\nexport function useOrphanNodes() {\n  const context = useContext(OrphanNodesContext)\n  return context\n}\n","import React, {\n  Children,\n  cloneElement,\n  FC,\n  memo,\n  PropsWithChildren,\n  ReactElement\n} from 'react'\nimport classnames from 'classnames'\nimport { useMouseDown } from '../../core/hooks'\n\ntype IconProps = PropsWithChildren<{\n  className?: string\n  onPress?: Fn\n}>\n\nconst BaseIcon: FC<IconProps> = ({ children, className, onPress }) => {\n  const handlePress = useMouseDown(onPress)\n  return (\n    <figure\n      onMouseDown={handlePress}\n      className={classnames('flex-shrink-0', className, {\n        's-16': !/\\bs-[0-9]/gi.test(className)\n      })}\n    >\n      {Children.map(children, (child: ReactElement) =>\n        cloneElement(child, {\n          className: classnames(\n            child.props.className,\n            'h-full w-full object-contain object-center m-auto pointer-events-none'\n          )\n        })\n      )}\n    </figure>\n  )\n}\n\nconst Icon = memo(BaseIcon)\n\nexport default Icon\n","import classnames from 'classnames'\nimport React, { useLayoutEffect, useState } from 'react'\n\nimport css from './style.module.css'\n\nexport type ContentDimensions = {\n  width?: number\n  height?: number\n  x?: number\n  y?: number\n}\n\ntype ContentProps = {\n  onLayoutUpdate: (dimensions: ContentDimensions) => void\n  x?: number\n  y?: number\n  hideArrow?: boolean\n  position?: string\n  alignment?: string\n  className?: string\n}\n\nconst Content: React.FC<ContentProps> = ({\n  onLayoutUpdate,\n  children,\n  x,\n  y,\n  position,\n  alignment,\n  className,\n  hideArrow\n}) => {\n  const [dimensions, setDimensions] = useState<ContentDimensions>({ x, y })\n\n  useLayoutEffect(() => {\n    const element = document.querySelector(`.${css.container}`)\n    const { width, height, x, y } = element.getBoundingClientRect()\n    const computedDimensions: ContentDimensions = { width, height, x, y }\n\n    if (JSON.stringify(computedDimensions) !== JSON.stringify(dimensions)) {\n      setDimensions(computedDimensions)\n      onLayoutUpdate(computedDimensions)\n    }\n  }, [dimensions, onLayoutUpdate])\n\n  let composedClassName = css.container\n  const arrowClassName = ` ${css.arrow} ${css[`arrow${position}`]} ${\n    css[`arrow${alignment}`]\n  }`\n\n  if (!hideArrow) composedClassName += arrowClassName\n\n  return (\n    <div\n      className={classnames(composedClassName, 'shadow-6', className)}\n      style={{ top: y, left: x }}\n    >\n      {children}\n    </div>\n  )\n}\n\nContent.defaultProps = {\n  x: 0,\n  y: 0\n}\n\nexport default Content\n","import React, {\n  MutableRefObject,\n  useCallback,\n  useEffect,\n  useState\n} from 'react'\nimport { useMouseDown } from '../../core/hooks'\n\nimport Content, { ContentDimensions } from './content'\n\nexport type AnchorRef = MutableRefObject<Element>\n\nexport type PopupPosition = 'up' | 'right' | 'down' | 'left' | 'center'\n\nexport type PopupAlignment = 'start' | 'center' | 'end'\n\ntype PopupOffset = {\n  x: number\n  y: number\n}\n\ntype PopupContentPosition = {\n  x: number\n  y: number\n}\n\ntype PopupProps = {\n  anchor?: string\n  anchorRef?: AnchorRef\n  contentClassName?: string\n  position?: PopupPosition\n  alignment?: PopupAlignment\n  transparent?: boolean\n  distance?: number\n  offsets?: PopupOffset\n  hideArrow?: boolean\n  isVisible?: boolean\n  overlayCloseOnClick?: boolean\n  onRequestClose: () => void\n}\n\nconst EDGE_PADDING = 12\n\nconst getViewportWidth = () =>\n  window.innerWidth ||\n  document.documentElement.clientWidth ||\n  document.body.clientWidth\n\nconst getViewportHeight = () =>\n  window.innerHeight ||\n  document.documentElement.clientHeight ||\n  document.body.clientHeight\n\nconst getPositioningWithoutAnchor = (\n  dimensions: ContentDimensions,\n  position: PopupPosition,\n  alignment: PopupAlignment\n) => {\n  const viewportWidth = getViewportWidth()\n  const viewportHeight = getViewportHeight()\n  const { width, height } = dimensions\n\n  let x: number, y: number\n\n  switch (position) {\n    case 'up':\n      y = 0\n      break\n    case 'down':\n      y = viewportHeight - height\n      break\n    case 'center':\n      y = (viewportHeight - height) / 2\n      break\n    default:\n      y = 0\n      break\n  }\n\n  switch (alignment) {\n    case 'start':\n      x = 0\n      break\n    case 'center':\n      x = (viewportWidth - width) / 2\n      break\n    case 'end':\n      x = viewportWidth - width\n      break\n    default:\n      x = 0\n      break\n  }\n\n  return { x, y }\n}\n\nconst getPositioningWithAnchor = (\n  dimensions: ContentDimensions,\n  anchor: string,\n  anchorRef: AnchorRef,\n  distance: number,\n  position: PopupPosition,\n  alignment: PopupAlignment\n) => {\n  const anchorElement = anchorRef.current || document.querySelector(anchor)\n  if (!anchorElement)\n    return getPositioningWithoutAnchor(dimensions, position, alignment)\n\n  const {\n    width: anchorWidth,\n    height: anchorHeight,\n    x: anchorX,\n    y: anchorY\n  } = anchorElement.getBoundingClientRect()\n  const { width, height } = dimensions\n\n  let x: number, y: number\n\n  if (position === 'up') {\n    y = anchorY - height - distance\n\n    switch (alignment) {\n      case 'start':\n        x = anchorX\n        break\n      case 'center':\n        x = anchorX + anchorWidth / 2 - width / 2\n        break\n      case 'end':\n        x = anchorX + anchorWidth - width\n        break\n      default:\n        break\n    }\n  }\n\n  if (position === 'down') {\n    y = anchorY + anchorHeight + distance\n\n    switch (alignment) {\n      case 'start':\n        x = anchorX\n        break\n      case 'center':\n        x = anchorX + anchorWidth / 2 - width / 2\n        break\n      case 'end':\n        x = anchorX + anchorWidth - width\n        break\n      default:\n        break\n    }\n  }\n\n  if (position === 'left') {\n    x = anchorX - width - distance\n\n    switch (alignment) {\n      case 'start':\n        y = anchorY\n        break\n      case 'center':\n        y = anchorY + anchorHeight / 2 - height / 2\n        break\n      case 'end':\n        y = anchorY + anchorHeight - height\n        break\n      default:\n        break\n    }\n  }\n\n  if (position === 'right') {\n    x = anchorX + anchorWidth + distance\n\n    switch (alignment) {\n      case 'start':\n        y = anchorY\n        break\n      case 'center':\n        y = anchorY + anchorHeight / 2 - height / 2\n        break\n      case 'end':\n        y = anchorY + anchorHeight - height\n        break\n      default:\n        break\n    }\n  }\n\n  return { x, y }\n}\n\nconst getValidPositioning = (\n  dimensions: ContentDimensions,\n  anchor: string,\n  anchorRef: AnchorRef,\n  distance: number,\n  position: PopupPosition,\n  alignment: PopupAlignment,\n  offsets: PopupOffset\n) => {\n  const { width, height } = dimensions\n  const viewportWidth = getViewportWidth()\n  const viewportHeight = getViewportHeight()\n  let contentPosition: PopupContentPosition\n\n  if (!!anchor || !!anchorRef) {\n    contentPosition = getPositioningWithAnchor(\n      dimensions,\n      anchor,\n      anchorRef,\n      distance,\n      position,\n      alignment\n    )\n  } else {\n    contentPosition = getPositioningWithoutAnchor(\n      dimensions,\n      position,\n      alignment\n    )\n  }\n\n  if (offsets) {\n    const xOffset = offsets.x || 0\n    const yOffset = offsets.y || 0\n\n    contentPosition.x = contentPosition.x + xOffset\n    contentPosition.y = contentPosition.y + yOffset\n  }\n\n  const leftEdge = EDGE_PADDING\n  const topEdge = EDGE_PADDING\n  const rightEdge = viewportWidth - width\n  const bottomEdge = viewportHeight - height\n\n  if (contentPosition.x <= leftEdge) contentPosition.x = leftEdge\n  if (contentPosition.y <= topEdge) contentPosition.y = topEdge\n  if (contentPosition.x >= rightEdge) contentPosition.x = rightEdge\n  if (contentPosition.y >= bottomEdge) contentPosition.y = bottomEdge\n\n  return contentPosition\n}\n\nconst Popup: React.FC<PopupProps> = ({\n  anchor,\n  anchorRef,\n  children,\n  contentClassName,\n  position,\n  alignment,\n  transparent,\n  distance,\n  offsets,\n  isVisible,\n  hideArrow,\n  overlayCloseOnClick,\n  onRequestClose\n}) => {\n  const [\n    popupContentPosition,\n    setPopupContentPosition\n  ] = useState<PopupContentPosition>({\n    x: 0,\n    y: 0\n  })\n\n  const handleClickOverlay = useMouseDown(() => {\n    if (overlayCloseOnClick) onRequestClose()\n  })\n\n  const handleKeyUp = useCallback(\n    (e: KeyboardEvent) => {\n      if (e.key === 'Escape' && isVisible) onRequestClose()\n    },\n    [isVisible, onRequestClose]\n  )\n\n  useEffect(() => {\n    document.addEventListener('keyup', handleKeyUp)\n\n    return () => {\n      document.removeEventListener('keyup', handleKeyUp)\n    }\n  }, [isVisible, handleKeyUp])\n\n  if (!isVisible) return null\n\n  return (\n    <div className='fixed top-0 left-0 w-full h-full z-2'>\n      <div\n        className={\n          transparent\n            ? 'w-full h-full absolute top-0 left-0 z-0'\n            : 'w-full h-full absolute top-0 left-0 z-0 bg-blue-800 opacity-50'\n        }\n        onMouseDown={handleClickOverlay}\n      />\n      <Content\n        className={contentClassName}\n        x={popupContentPosition.x}\n        y={popupContentPosition.y}\n        position={position}\n        alignment={alignment}\n        hideArrow={(!anchorRef && !anchor) || hideArrow}\n        onLayoutUpdate={(dimensions) =>\n          setPopupContentPosition(\n            getValidPositioning(\n              dimensions,\n              anchor,\n              anchorRef,\n              distance,\n              position,\n              alignment,\n              offsets\n            )\n          )\n        }\n      >\n        {children}\n      </Content>\n    </div>\n  )\n}\n\nPopup.defaultProps = {\n  position: 'center',\n  alignment: 'center',\n  transparent: false,\n  distance: 10,\n  overlayCloseOnClick: true,\n  hideArrow: false,\n  isVisible: false\n}\n\nexport default Popup\n","import { ImageDimensions, getImageSizeAsync, nil } from '../../../core/utils'\nimport React, {\n  ChangeEvent,\n  FC,\n  MutableRefObject,\n  useCallback,\n  useMemo,\n  useState\n} from 'react'\n\nimport { BiLink } from '@react-icons/all-files/bi/BiLink'\nimport Button from '../../button'\nimport Icon from '../../icon'\nimport Popup from '../../popup'\n\nexport type ImageProps = {\n  url?: string\n  label?: string\n  dimensions: ImageDimensions\n}\n\ntype ImagePopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  onRequestClose: Fn\n  onSubmitEditing?: (value: ImageProps) => void\n}\n\nconst ImagePopup: FC<ImagePopupProps> = ({\n  anchorRef,\n  isVisible,\n  onRequestClose,\n  onSubmitEditing\n}) => {\n  const [imageState, setImageState] = useState('')\n  const [scaleState, setScaleState] = useState('100')\n  const [imageDimensions, setImageDimensions] = useState<ImageDimensions>()\n\n  const decimalScale = useMemo(() => {\n    const value = parseFloat(scaleState)\n    const normalized = isNaN(value) || value < 1 ? 1 : value\n    return normalized / 100\n  }, [scaleState])\n\n  const handleChangeImageUrl = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      setImageState(e.target.value)\n    },\n    []\n  )\n\n  const handleChangeScale = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setScaleState(e.target.value)\n  }, [])\n\n  const handleBlurImageInput = useCallback(async () => {\n    if (!imageState?.length) {\n      setImageDimensions(null)\n      return\n    }\n\n    try {\n      const dimensions = await getImageSizeAsync(imageState)\n      setImageDimensions(dimensions)\n    } catch (error) {\n      setImageDimensions(null)\n    }\n  }, [imageState])\n\n  const handleRequestClose = useCallback(() => {\n    setImageState('')\n    setScaleState('100')\n    setImageDimensions(null)\n    onRequestClose?.()\n  }, [onRequestClose])\n\n  const handlePressSubmit = useCallback(() => {\n    onSubmitEditing?.({\n      url: imageState,\n      dimensions: {\n        width: imageDimensions.width * decimalScale,\n        height: imageDimensions.height * decimalScale\n      }\n    })\n    handleRequestClose()\n  }, [\n    decimalScale,\n    handleRequestClose,\n    imageDimensions,\n    imageState,\n    onSubmitEditing\n  ])\n\n  return (\n    <Popup\n      position='down'\n      alignment='start'\n      isVisible={isVisible}\n      onRequestClose={handleRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default p-8 w-296 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        <div className='flex items-center justify-between space-x-4 mb-8'>\n          <div className='h-32 flex-1 overflow-hidden rounded-default border border-gray-200 flex items-center justify-start'>\n            <div className='flex s-32 rounded-default rounded-r-none rounded-b-none bg-gray-200 text-gray-500 items-center justify-center font-semibold'>\n              <Icon>\n                <BiLink />\n              </Icon>\n            </div>\n            <input\n              className='border-none h-full px-6 bg-transparent font-medium flex-1 min-w-0'\n              type='text'\n              placeholder='https://www...'\n              value={imageState}\n              onChange={handleChangeImageUrl}\n              onBlur={handleBlurImageInput}\n            />\n          </div>\n          <div className='h-32 overflow-hidden rounded-default border border-gray-200 flex items-center justify-start'>\n            <input\n              maxLength={3}\n              className='border-none h-full w-40 px-6 bg-transparent font-medium m-0'\n              placeholder='0'\n              value={scaleState}\n              onChange={handleChangeScale}\n            />\n            <div className='flex s-32 bg-transparent text-gray-300 items-center justify-center font-semibold'>\n              %\n            </div>\n          </div>\n        </div>\n        <div className='flex justify-end'>\n          <Button\n            disabled={nil(imageDimensions)}\n            className='h-32'\n            onPress={handlePressSubmit}\n          >\n            Insert\n          </Button>\n        </div>\n      </div>\n    </Popup>\n  )\n}\n\nexport default ImagePopup\n","import React, {\n  FC,\n  memo,\n  MutableRefObject,\n  useCallback,\n  useState,\n  ChangeEvent\n} from 'react'\nimport Popup from '../../popup'\nimport css from './style.module.css'\nimport classnames from 'classnames'\nimport { areEqualColors, isHexColor } from '../../../core/utils'\nimport { useMouseDown } from '../../../core/hooks'\nimport { PRESET_COLORS } from '../../../core/constants'\n\ntype ColorPopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  value?: string\n  onChangeColorOption?: (value?: string, focus?: boolean) => void\n  onRequestClose: Fn\n}\n\ntype ColorBoxProps = {\n  active?: boolean\n  color: string\n  onPress?: (value: string) => void\n}\n\nconst BaseColorBox: FC<ColorBoxProps> = ({ active, color, onPress }) => {\n  const handlePress = useMouseDown(() => {\n    onPress?.(color)\n  })\n\n  return (\n    <div\n      style={{ color }}\n      onMouseDown={handlePress}\n      title={color}\n      className={classnames(\n        's-32 rounded-default bg-current cursor-pointer transition-shadow duration-250',\n        css['color-box'],\n        { [css.active]: active }\n      )}\n    />\n  )\n}\n\nconst ColorBox = memo(BaseColorBox)\n\nconst ColorPopup: FC<ColorPopupProps> = ({\n  anchorRef,\n  isVisible,\n  value,\n  onChangeColorOption,\n  onRequestClose\n}) => {\n  const [colorState, setColorState] = useState('')\n\n  const handlePressColorOption = useCallback(\n    (option: string) => {\n      if (!isHexColor(option)) {\n        return\n      }\n\n      const selectedColor = areEqualColors(value, option) ? null : option\n\n      setColorState(selectedColor?.replaceAll('#', ''))\n      onChangeColorOption?.(selectedColor)\n      onRequestClose?.()\n    },\n    [onChangeColorOption, onRequestClose, value]\n  )\n\n  const handleChangeInput = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      const inputValue = e.target.value\n      const parsedColor = inputValue?.length\n        ? `#${inputValue.replace('#', '')}`\n        : null\n\n      setColorState(e.target.value)\n\n      if (isHexColor(parsedColor)) {\n        onChangeColorOption?.(parsedColor, false)\n      }\n    },\n    [onChangeColorOption]\n  )\n\n  return (\n    <Popup\n      position='down'\n      alignment='start'\n      isVisible={isVisible}\n      onRequestClose={onRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default grid grid-cols-7 gap-6 p-8 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        {PRESET_COLORS.map((o) => (\n          <ColorBox\n            color={o}\n            key={o}\n            onPress={handlePressColorOption}\n            active={areEqualColors(value, o)}\n          />\n        ))}\n        <div className='h-32 col-span-4 overflow-hidden rounded-default border border-gray-200 flex items-center justify-start'>\n          <div className='flex s-32 rounded-default rounded-r-none rounded-b-none bg-gray-200 text-gray-500 items-center justify-center font-semibold'>\n            #\n          </div>\n          <input\n            maxLength={6}\n            className={classnames(\n              'border-none h-full px-6 bg-transparent font-medium',\n              css.input\n            )}\n            type='text'\n            placeholder={value?.replace('#', '')}\n            value={colorState}\n            onChange={handleChangeInput}\n          />\n        </div>\n      </div>\n    </Popup>\n  )\n}\n\nexport default ColorPopup\n","import React, {\n  Children,\n  cloneElement,\n  FC,\n  PropsWithChildren,\n  ReactElement\n} from 'react'\nimport classnames from 'classnames'\n\ntype FieldProps = PropsWithChildren<{\n  label?: string\n  className?: string\n}>\n\nconst Field: FC<FieldProps> = ({ className, children, label }) => {\n  return (\n    <div className={className}>\n      {!!label?.length && (\n        <label className='text-blue-500 block mb-4 text-subhead font-medium'>\n          {label}\n        </label>\n      )}\n      {Children.map(children, (child: ReactElement) =>\n        cloneElement(child, {\n          className: classnames(\n            child.props.className,\n            'w-full appearance-none border border-gray-200 rounded-default h-32 px-8 transition:colors transition:shadow duration-250 focus:border-blue-500 focus:shadow-outline'\n          )\n        })\n      )}\n    </div>\n  )\n}\n\nexport default Field\n","import React, {\n  ChangeEvent,\n  FC,\n  MutableRefObject,\n  useCallback,\n  useMemo,\n  useState\n} from 'react'\nimport { useEditor, useOrphanNodes } from '../../../core/hooks'\nimport {\n  EditableAttributes,\n  EditableElementType,\n  EditableRefAttributes,\n  getMatchingNodes\n} from '../../../core/tools'\nimport Button from '../../button'\nimport Field from '../../field'\nimport Popup from '../../popup'\n\ntype ConditionPopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  onRequestClose: Fn\n  onSubmitEditing?: (value: EditableRefAttributes) => void\n}\n\nconst ConditionPopup: FC<ConditionPopupProps> = ({\n  anchorRef,\n  isVisible,\n  onRequestClose,\n  onSubmitEditing\n}) => {\n  const editor = useEditor()\n  const [orphanNodes] = useOrphanNodes()\n  const editableNodes = getMatchingNodes(\n    editor,\n    (o) =>\n      o.type === 'editable' &&\n      !(o.valueRef as string)?.length &&\n      ['options', 'radio'].includes(o.dataType as string)\n  )\n    .concat(orphanNodes)\n    .map((o) => o as EditableElementType<EditableAttributes>)\n\n  const [parent, setParent] = useState('')\n  const [value, setValue] = useState('')\n  const options = useMemo(\n    () => editableNodes.find((o) => o.id === parent)?.options || [],\n    [editableNodes, parent]\n  )\n\n  const isValid = !!parent?.length && !!value?.length\n\n  const handleChangeParent = useCallback(\n    (e: ChangeEvent<HTMLSelectElement>) => {\n      const selected = e.target.value\n\n      if (selected === parent) {\n        return\n      }\n\n      setParent(selected)\n      setValue('')\n    },\n    [parent]\n  )\n\n  const handleChangeValue = useCallback(\n    (e: ChangeEvent<HTMLSelectElement>) => {\n      const selected = e.target.value\n\n      if (selected === value) {\n        return\n      }\n\n      setValue(selected)\n    },\n    [value]\n  )\n\n  const handleRequestClose = useCallback(() => {\n    setParent('')\n    setValue('')\n    onRequestClose?.()\n  }, [onRequestClose])\n\n  const handlePressSubmit = useCallback(() => {\n    onSubmitEditing?.({\n      parent,\n      value\n    })\n    handleRequestClose()\n  }, [handleRequestClose, onSubmitEditing, parent, value])\n\n  return (\n    <Popup\n      position='down'\n      alignment='start'\n      isVisible={isVisible}\n      onRequestClose={handleRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default p-8 space-y-8 w-320 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        <Field label='Only show when...'>\n          <select value={parent} onChange={handleChangeParent}>\n            <option hidden value=''>\n              Choose one\n            </option>\n            {editableNodes.map((o) => (\n              <option key={o.id} value={o.id}>\n                {o.defaultValue}({o.label})\n              </option>\n            ))}\n          </select>\n        </Field>\n        <Field label='equals...'>\n          <select value={value} onChange={handleChangeValue}>\n            <option hidden value=''>\n              Choose one\n            </option>\n            {options.map((o) => (\n              <option key={o.id} value={o.id}>\n                {o.label}\n              </option>\n            ))}\n          </select>\n        </Field>\n        <div className='flex justify-end'>\n          <Button\n            disabled={!isValid}\n            className='h-32'\n            onPress={handlePressSubmit}\n          >\n            Add condition\n          </Button>\n        </div>\n      </div>\n    </Popup>\n  )\n}\n\nexport default ConditionPopup\n","import React, { MouseEvent, FC, memo } from 'react'\nimport classnames from 'classnames'\n\ntype SegmentedControlProps = {\n  className?: string\n  value: number\n  options: Array<string>\n  onChangeValue: (value: number) => void\n}\n\nconst BaseSegmentedControl: FC<SegmentedControlProps> = ({\n  className,\n  value,\n  options,\n  onChangeValue\n}) => {\n  const handlePressOption = (e: MouseEvent, index: number) => {\n    e.preventDefault()\n    onChangeValue?.(index)\n  }\n\n  return (\n    <div\n      className={classnames(\n        'bg-gray-100 rounded-full p-4 w-296 h-40 flex items-center relative',\n        className\n      )}\n    >\n      <div\n        className='absolute bg-gray-500 rounded-full z-0 top-4 h-32 transition-all duration-500'\n        style={{ width: 144, left: 144 * value + 4 }}\n      />\n      {options.map((o, i) => (\n        <div\n          className={classnames(\n            'font-medium flex-1 flex items-center justify-center relative z-1 cursor-pointer transition-colors duration-500',\n            {\n              'text-gray-500 hover:text-gray-700': value !== i,\n              'text-white': value === i\n            }\n          )}\n          key={i}\n          onMouseDown={(e) => handlePressOption(e, i)}\n        >\n          {o}\n        </div>\n      ))}\n    </div>\n  )\n}\n\nconst SegmentedControl = memo(BaseSegmentedControl)\n\nexport default SegmentedControl\n","import {\n  EditableAttributes,\n  EditableElementType,\n  getEditableAttributes,\n  getEditableAttributesValidity,\n  getMatchingNodes\n} from '../../../../core/tools'\nimport React, { ChangeEvent, FC, useCallback, useMemo, useState } from 'react'\n\nimport Button from '../../../button'\nimport Field from '../../../field'\nimport { useEditor } from '../../../../core/hooks'\n\ntype EditableCopyExistingProps = {\n  onSubmit?: (attributes: EditableAttributes) => void\n}\n\nconst EditableCopyExisting: FC<EditableCopyExistingProps> = ({ onSubmit }) => {\n  const editor = useEditor()\n  const editableNodes = useMemo(\n    () =>\n      getMatchingNodes(\n        editor,\n        (o) => o.type === 'editable' && !(o.valueRef as string)?.length\n      ).map((o) => o as EditableElementType<EditableAttributes>),\n    [editor]\n  )\n\n  const [valueRef, setValueRef] = useState('')\n  const [defaultValue, setDefaultValue] = useState('')\n  const dataType = useMemo(\n    () => editableNodes?.find((o) => o.id === valueRef)?.dataType,\n    [editableNodes, valueRef]\n  )\n\n  const isValid = useMemo(\n    () =>\n      getEditableAttributesValidity(\n        { valueRef, defaultValue, dataType },\n        false,\n        true\n      ),\n    [dataType, defaultValue, valueRef]\n  )\n\n  const handleChangeValueRef = useCallback(\n    (e: ChangeEvent<HTMLSelectElement>) => {\n      const value = e.target.value\n\n      if (value === valueRef) {\n        return\n      }\n\n      setValueRef(value)\n      setDefaultValue(\n        editableNodes.find((o) => o.id === value)?.defaultValue || ''\n      )\n    },\n    [editableNodes, valueRef]\n  )\n\n  const handleChangeDefaultValue = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      setDefaultValue(e.target.value)\n    },\n    []\n  )\n\n  const handlePressSubmit = useCallback(() => {\n    const data = getEditableAttributes({ valueRef, defaultValue, dataType })\n\n    onSubmit?.(data)\n  }, [dataType, defaultValue, onSubmit, valueRef])\n\n  return (\n    <div>\n      <Field label='Copy from' className='mb-18'>\n        <select value={valueRef} onChange={handleChangeValueRef}>\n          <option hidden value=''>\n            Choose one\n          </option>\n          {editableNodes.map((o) => (\n            <option key={o.id} value={o.id}>\n              {o.defaultValue}({o.label})\n            </option>\n          ))}\n        </select>\n      </Field>\n      <Field label='Default value' className='mb-18'>\n        <input\n          value={defaultValue}\n          onChange={handleChangeDefaultValue}\n          placeholder='Default'\n        />\n      </Field>\n      <div className='flex justify-end pt-24'>\n        <Button\n          disabled={!isValid}\n          className='h-32'\n          onPress={handlePressSubmit}\n        >\n          Insert\n        </Button>\n      </div>\n    </div>\n  )\n}\n\nexport default EditableCopyExisting\n","import React, { FC, memo } from 'react'\nimport ReactSwitch from 'react-switch'\n\ntype SwitchProps = {\n  className?: string\n  value: boolean\n  onChangeValue: (value: boolean) => void\n}\n\nconst BaseSwitch: FC<SwitchProps> = ({ className, value, onChangeValue }) => {\n  return (\n    <ReactSwitch\n      checked={value}\n      className={className}\n      onChange={onChangeValue}\n      offColor='#ADC5FA'\n      onColor='#326FF3'\n      checkedIcon={false}\n      uncheckedIcon={false}\n      handleDiameter={18}\n      height={22}\n      width={44}\n      activeBoxShadow='0 0 0 4px rgba(103, 126, 138, 0.125)'\n    />\n  )\n}\n\nconst Switch = memo(BaseSwitch)\n\nexport default Switch\n","import React, {\n  ChangeEvent,\n  FC,\n  useCallback,\n  useMemo,\n  useRef,\n  useState,\n  KeyboardEvent\n} from 'react'\nimport Button from '../../../button'\nimport Field from '../../../field'\nimport Switch from '../../../switch'\nimport { FaRegTrashAlt } from '@react-icons/all-files/fa/FaRegTrashAlt'\nimport { AiFillPlusCircle } from '@react-icons/all-files/ai/AiFillPlusCircle'\nimport Icon from '../../../icon'\nimport {\n  EditableAttributes,\n  EditableDataType,\n  EditableOption,\n  getEditableAttributes,\n  getEditableAttributesValidity\n} from '../../../../core/tools'\nimport {\n  DATE_FORMATS,\n  EDITABLE_DATA_TYPES,\n  TIME_FORMATS\n} from '../../../../core/constants'\nimport { formatDate, generateUUID } from '../../../../core/utils'\n\ntype EditableCreateNewProps = {\n  onSubmit?: (attributes: EditableAttributes, isOrphan?: boolean) => void\n}\n\nconst EditableCreateNew: FC<EditableCreateNewProps> = ({ onSubmit }) => {\n  const now = useRef(new Date()).current\n  const dataTypeOptions = useRef(Object.entries(EDITABLE_DATA_TYPES)).current\n  const dateFormatOptions = useRef(DATE_FORMATS).current\n  const timeFormatOptions = useRef(TIME_FORMATS).current\n\n  const [dataType, setDataType] = useState<EditableDataType>(\n    '' as EditableDataType\n  )\n  const [defaultValue, setDefaultValue] = useState('')\n  const [dateTimeFormat, setDateTimeFormat] = useState('')\n  const [label, setLabel] = useState('')\n  const [multiline, setMultiline] = useState(false)\n  const [options, setOptions] = useState<Array<EditableOption>>([])\n  const [editingOption, setEditingOption] = useState('')\n  const [showTip, setShowTip] = useState(false)\n  const [isOrphan, setIsOrphan] = useState(false)\n  const [tip, setTip] = useState('')\n\n  const isValid = useMemo(\n    () =>\n      getEditableAttributesValidity(\n        {\n          dataType,\n          dateTimeFormat,\n          defaultValue,\n          label,\n          options,\n          tip\n        },\n        showTip\n      ),\n    [dataType, dateTimeFormat, defaultValue, label, options, showTip, tip]\n  )\n\n  const handlePressDeleteOption = useCallback(\n    (id: string) => {\n      const eventualValue = [...options]\n      const index = eventualValue.findIndex((o) => o.id === id)\n\n      if (~index) {\n        eventualValue.splice(index, 1)\n        setOptions(eventualValue)\n      }\n    },\n    [options]\n  )\n\n  const handlePressAddOption = useCallback(() => {\n    const label = editingOption?.trim()\n\n    if (!label?.length) {\n      return\n    }\n\n    const id = generateUUID()\n\n    setOptions((groundValue) => [...groundValue, { id, label }])\n    setEditingOption('')\n  }, [editingOption])\n\n  const handleEditingOptionKeydown = useCallback(\n    (e: KeyboardEvent) => {\n      if (e.key?.toLowerCase() === 'enter') {\n        e.preventDefault()\n        handlePressAddOption()\n      }\n    },\n    [handlePressAddOption]\n  )\n\n  const handlePressSubmit = useCallback(() => {\n    const data = getEditableAttributes(\n      {\n        dataType,\n        dateTimeFormat,\n        multiline,\n        defaultValue,\n        label,\n        options,\n        tip\n      },\n      showTip\n    )\n\n    onSubmit?.(data, isOrphan)\n  }, [\n    dataType,\n    dateTimeFormat,\n    defaultValue,\n    isOrphan,\n    label,\n    multiline,\n    onSubmit,\n    options,\n    showTip,\n    tip\n  ])\n\n  const handleChangeDataType = useCallback(\n    (e: ChangeEvent<HTMLSelectElement>) => {\n      const value = e.target.value as EditableDataType\n\n      if (value === dataType) {\n        return\n      }\n\n      setDataType(value)\n\n      if (value === 'date' || value === 'time') {\n        setDateTimeFormat('')\n      }\n    },\n    [dataType]\n  )\n\n  const handleChangeDateTimeFormat = useCallback(\n    (e: ChangeEvent<HTMLSelectElement>) => {\n      setDateTimeFormat(e.target.value)\n    },\n    []\n  )\n\n  const handleChangeEditingOption = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      setEditingOption(e.target.value)\n    },\n    []\n  )\n\n  const handleChangeLabel = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setLabel(e.target.value)\n  }, [])\n\n  const handleChangeDefaultValue = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      setDefaultValue(e.target.value)\n    },\n    []\n  )\n\n  const handleChangeTip = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setTip(e.target.value)\n  }, [])\n\n  return (\n    <div>\n      <div className='flex items-end space-x-12 mb-18'>\n        <Field label='Type' className='flex-1'>\n          <select value={dataType} onChange={handleChangeDataType}>\n            <option hidden value=''>\n              Choose one\n            </option>\n            {dataTypeOptions.map(([value, label]) => (\n              <option key={value} value={value}>\n                {label}\n              </option>\n            ))}\n          </select>\n        </Field>\n        {dataType === 'text' && (\n          <div className='flex flex-1 justify-start items-center space-x-8 pb-6'>\n            <div>Multiline</div>\n            <Switch value={multiline} onChangeValue={setMultiline} />\n          </div>\n        )}\n        {dataType === 'date' && (\n          <Field label='Date format'>\n            <select\n              value={dateTimeFormat}\n              onChange={handleChangeDateTimeFormat}\n            >\n              <option hidden value=''>\n                Choose a format\n              </option>\n              {dateFormatOptions.map((o) => (\n                <option key={o} value={o}>\n                  {formatDate(now, o)}\n                </option>\n              ))}\n            </select>\n          </Field>\n        )}\n        {dataType === 'time' && (\n          <Field label='Time format'>\n            <select\n              value={dateTimeFormat}\n              onChange={handleChangeDateTimeFormat}\n            >\n              <option hidden value=''>\n                Choose a format\n              </option>\n              {timeFormatOptions.map((o) => (\n                <option key={o} value={o}>\n                  {formatDate(now, o)}\n                </option>\n              ))}\n            </select>\n          </Field>\n        )}\n      </div>\n      {['radio', 'options'].includes(dataType) && (\n        <div className='mb-18'>\n          <div className='text-blue-500 block mb-4 text-subhead font-medium'>\n            Options\n          </div>\n          <div className='space-y-6'>\n            {options?.map((o) => (\n              <div\n                key={o.id}\n                onClick={() => handlePressDeleteOption(o.id)}\n                className='flex items-center justify-between px-8 h-32 w-full border border-gray-200 bg-gray-100 rounded-default'\n              >\n                <span className='text-gray-500'>{o.label}</span>\n                <Icon className='cursor-pointer text-gray-500 transition-colors duration-250'>\n                  <FaRegTrashAlt />\n                </Icon>\n              </div>\n            ))}\n            <div className='flex items-center justify-between px-8 h-32 w-full border border-gray-200 rounded-default transition:colors transition:shadow duration-250 focus-within:shadow-outline focus-within:border-blue-500'>\n              <input\n                value={editingOption}\n                className='border-none h-full w-full bg-transparent m-0'\n                placeholder='+ Add an option'\n                onChange={handleChangeEditingOption}\n                onKeyDown={handleEditingOptionKeydown}\n              />\n              <Icon\n                onPress={handlePressAddOption}\n                className='cursor-pointer text-blue-500 transition-colors duration-250 hover:text-blue-600'\n              >\n                <AiFillPlusCircle />\n              </Icon>\n            </div>\n          </div>\n        </div>\n      )}\n      <Field label='Label' className='mb-18'>\n        <input\n          value={label}\n          onChange={handleChangeLabel}\n          placeholder='Question label'\n        />\n      </Field>\n      <Field label='Default value' className='mb-18'>\n        <input\n          value={defaultValue}\n          onChange={handleChangeDefaultValue}\n          placeholder='Default'\n        />\n      </Field>\n      <div className='flex flex-1 justify-between items-center mb-18'>\n        <div>Show description</div>\n        <Switch value={showTip} onChangeValue={setShowTip} />\n      </div>\n      {showTip && (\n        <Field label='Description' className='mb-18'>\n          <input\n            value={tip}\n            onChange={handleChangeTip}\n            placeholder='Lorem ipsum...'\n          />\n        </Field>\n      )}\n      <div className='flex flex-1 justify-between items-center mb-18'>\n        <div>Save in Icebox</div>\n        <Switch value={isOrphan} onChangeValue={setIsOrphan} />\n      </div>\n      <div className='flex justify-end pt-24'>\n        <Button\n          disabled={!isValid}\n          onPress={handlePressSubmit}\n          className='h-32'\n        >\n          Insert\n        </Button>\n      </div>\n    </div>\n  )\n}\n\nexport default EditableCreateNew\n","import React, { FC, useCallback, useState } from 'react'\nimport { EditableAttributes } from '../../../core/tools'\nimport Popup from '../../popup'\nimport SegmentedControl from '../../segmented-control'\nimport EditableCopyExisting from './copy-existing'\nimport EditableCreateNew from './create-new'\n\ntype EditablePopupProps = {\n  isVisible: boolean\n  onRequestClose: Fn\n  onSubmit: (attributes: EditableAttributes, isOrphan?: boolean) => void\n}\n\nconst EditablePopupProps: FC<EditablePopupProps> = ({\n  isVisible,\n  onRequestClose,\n  onSubmit\n}) => {\n  const [segment, setSegment] = useState(0)\n\n  const handleSubmit = useCallback(\n    (attributes: EditableAttributes, isOrphan = false) => {\n      onSubmit?.(attributes, isOrphan)\n      onRequestClose?.()\n      setSegment(0)\n    },\n    [onRequestClose, onSubmit]\n  )\n\n  return (\n    <Popup\n      position='center'\n      alignment='center'\n      isVisible={isVisible}\n      onRequestClose={onRequestClose}\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default w-480 py-12 px-16 bg-white border border-gray-300 overflow-hidden'>\n        <div className='flex items-center justify-center mb-28'>\n          <SegmentedControl\n            value={segment}\n            onChangeValue={setSegment}\n            options={['Create new', 'Copy existing']}\n          />\n        </div>\n        {segment === 0 && <EditableCreateNew onSubmit={handleSubmit} />}\n        {segment === 1 && <EditableCopyExisting onSubmit={handleSubmit} />}\n      </div>\n    </Popup>\n  )\n}\n\nexport default EditablePopupProps\n","import React, { ReactNode, Ref, forwardRef } from 'react'\n\nimport Icon from '../icon'\nimport classnames from 'classnames'\nimport css from './style.module.css'\nimport { useMouseDown } from '../../core/hooks'\n\ntype IconButtonProps = {\n  active?: boolean\n  disabled?: boolean\n  className?: string\n  data?: string\n  tip?: string\n  onPress?: Fn\n  children?: ReactNode\n}\n\nconst BaseIconButton = (\n  {\n    active,\n    data,\n    disabled,\n    className,\n    children,\n    onPress,\n    tip\n  }: IconButtonProps,\n  ref: Ref<HTMLDivElement>\n) => {\n  const handlePress = useMouseDown(() => {\n    onPress?.(data)\n  })\n\n  return (\n    <div\n      ref={ref}\n      className={classnames(\n        's-32 rounded-default bg-transparent cursor-pointer flex items-center justify-center transition-colors duration-250 hover:bg-blue-100 hover:text-blue-500',\n        {\n          'text-blue-500 bg-blue-highlight': active,\n          'pointer-events-none opacity-50': disabled,\n          [css.tooltip]: !!tip?.length\n        },\n        className\n      )}\n      data-tip={tip}\n      onMouseDown={handlePress}\n    >\n      <Icon className='s-20'>{children}</Icon>\n    </div>\n  )\n}\n\nconst IconButton = forwardRef(BaseIconButton)\n\nexport default IconButton\n","import React, { FC } from 'react'\n\nconst IconGroup: FC = ({ children }) => {\n  return <div className='px-16 flex items-center space-x-4'>{children}</div>\n}\n\nexport default IconGroup\n","import { ImageDimensions, notNil, parseNumber } from '../../../core/utils'\nimport React, {\n  ChangeEvent,\n  FC,\n  MutableRefObject,\n  useCallback,\n  useState\n} from 'react'\n\nimport Button from '../../button'\nimport Field from '../../field'\nimport Icon from '../../icon'\nimport Popup from '../../popup'\nimport { TiTimes } from '@react-icons/all-files/ti/TiTimes'\n\ntype ImageSizePopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  onRequestClose: Fn\n  onSubmitEditing?: (value: ImageDimensions, label?: string) => void\n}\n\nconst ImageSizePopup: FC<ImageSizePopupProps> = ({\n  anchorRef,\n  isVisible,\n  onRequestClose,\n  onSubmitEditing\n}) => {\n  const [width, setWidth] = useState(100)\n  const [height, setHeight] = useState(100)\n  const [label, setLabel] = useState('')\n\n  const isValid =\n    notNil(width) && notNil(height) && !!label?.length && width * height > 0\n\n  const handleChangeWidth = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setWidth(parseNumber(e.target.value))\n  }, [])\n\n  const handleChangeHeight = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setHeight(parseNumber(e.target.value))\n  }, [])\n\n  const handleChangeLabel = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setLabel(e.target.value)\n  }, [])\n\n  const handleRequestClose = useCallback(() => {\n    setWidth(100)\n    setHeight(100)\n    onRequestClose?.()\n  }, [onRequestClose])\n\n  const handlePressSubmit = useCallback(() => {\n    onSubmitEditing?.(\n      {\n        width,\n        height\n      },\n      label\n    )\n    handleRequestClose()\n  }, [handleRequestClose, height, label, onSubmitEditing, width])\n\n  return (\n    <Popup\n      position='down'\n      alignment='start'\n      isVisible={isVisible}\n      onRequestClose={handleRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default p-8 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        <div>\n          <Field label='Label' className='mb-8'>\n            <input\n              value={label}\n              onChange={handleChangeLabel}\n              placeholder='Image upload label'\n            />\n          </Field>\n        </div>\n        <span className='text-blue-500 block mb-4 text-subhead font-medium'>\n          Dimensions\n        </span>\n        <div className='flex items-center justify-between space-x-4 mb-8'>\n          <div className='h-32 overflow-hidden rounded-default border border-gray-200 flex items-center justify-start'>\n            <input\n              className='border-none h-full w-40 px-6 bg-transparent font-medium m-0'\n              placeholder='0'\n              value={width}\n              onChange={handleChangeWidth}\n            />\n            <div className='flex s-32 bg-transparent text-gray-300 items-center justify-center text-subhead font-semibold'>\n              PX\n            </div>\n          </div>\n          <Icon>\n            <TiTimes />\n          </Icon>\n          <div className='h-32 overflow-hidden rounded-default border border-gray-200 flex items-center justify-start'>\n            <input\n              className='border-none h-full w-40 px-6 bg-transparent font-medium m-0'\n              placeholder='0'\n              value={height}\n              onChange={handleChangeHeight}\n            />\n            <div className='flex s-32 bg-transparent text-gray-300 items-center justify-center text-subhead font-semibold'>\n              PX\n            </div>\n          </div>\n        </div>\n        <div className='flex justify-end'>\n          <Button\n            disabled={!isValid}\n            className='h-32'\n            onPress={handlePressSubmit}\n          >\n            Insert\n          </Button>\n        </div>\n      </div>\n    </Popup>\n  )\n}\n\nexport default ImageSizePopup\n","import React, { FC, MutableRefObject, useCallback } from 'react'\nimport { FiInbox } from '@react-icons/all-files/fi/FiInbox'\nimport { useOrphanNodes } from '../../../core/hooks'\nimport Icon from '../../icon'\nimport Popup from '../../popup'\nimport { FaRegTrashAlt } from '@react-icons/all-files/fa/FaRegTrashAlt'\n\ntype OrphanNodesPopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  onRequestClose: Fn\n}\n\nconst OrphanNodesPopup: FC<OrphanNodesPopupProps> = ({\n  anchorRef,\n  isVisible,\n  onRequestClose\n}) => {\n  const [orphanNodes, setOrphanNodes] = useOrphanNodes()\n\n  const handlePressDelete = useCallback(\n    (id: string) => {\n      const eventualValue = [...orphanNodes]\n      const index = eventualValue.findIndex((o) => o.id === id)\n\n      if (!~index) {\n        return\n      }\n\n      eventualValue.splice(index, 1)\n      setOrphanNodes(eventualValue)\n    },\n    [orphanNodes, setOrphanNodes]\n  )\n\n  return (\n    <Popup\n      position='down'\n      alignment='end'\n      isVisible={isVisible}\n      onRequestClose={onRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default p-8 space-y-8 w-320 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        {!orphanNodes.length && (\n          <div className='flex flex-col items-center justify-center text-center py-20 space-y-4'>\n            <Icon className='text-blue-500 s-28'>\n              <FiInbox />\n            </Icon>\n            <div className='text-heading-2 font-medium'>Spick and span!</div>\n            <div className='text-subhead'>\n              Choose the <span className='text-blue-500'>Save to Icebox</span>{' '}\n              option to create standalone editables that do not appear in the\n              document.\n            </div>\n          </div>\n        )}\n        <div className='space-y-4'>\n          {orphanNodes.map(({ id, defaultValue }) => (\n            <div\n              key={id as any}\n              className='rounded-default bg-blue-500 text-white font-medium px-8 py-8 flex items-center'\n            >\n              <div className='flex-1'>{defaultValue}</div>\n              <Icon\n                onPress={() => handlePressDelete(id as any)}\n                className='cursor-pointer text-white opacity-50 transition-opacity duration-250 hover:opacity-100'\n              >\n                <FaRegTrashAlt />\n              </Icon>\n            </div>\n          ))}\n        </div>\n      </div>\n    </Popup>\n  )\n}\n\nexport default OrphanNodesPopup\n","import React, {\n  FC,\n  MutableRefObject,\n  PropsWithChildren,\n  useCallback\n} from 'react'\nimport Popup from '../../popup'\nimport classnames from 'classnames'\nimport { HeadingFormatType } from '../../../core/tools'\nimport { nil } from '../../../core/utils'\nimport { useMouseDown } from '../../../core/hooks'\n\ntype TextSizePopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  value: HeadingFormatType\n  onPressOption?: (value: HeadingFormatType) => void\n  onRequestClose: Fn\n}\n\ntype TextSizeOptionProps = PropsWithChildren<{\n  active?: boolean\n  onPress?: Fn\n}>\n\nconst TextSizeOption: FC<TextSizeOptionProps> = ({\n  active,\n  children,\n  onPress\n}) => {\n  const handlePress = useMouseDown(onPress)\n\n  return (\n    <div\n      className={classnames(\n        'cursor-pointer h-40 px-20 flex items-center font-medium bg-transparent transition-colors duration-250 hover:bg-blue-100 hover:text-blue-500',\n        {\n          'text-blue-500 bg-blue-highlight': active\n        }\n      )}\n      onMouseDown={handlePress}\n    >\n      {children}\n    </div>\n  )\n}\n\nconst TextSizePopup: FC<TextSizePopupProps> = ({\n  anchorRef,\n  isVisible,\n  value,\n  onPressOption,\n  onRequestClose\n}) => {\n  const handlePressOption = useCallback(\n    (option?: HeadingFormatType) => {\n      onPressOption?.(option)\n      onRequestClose?.()\n    },\n    [onPressOption, onRequestClose]\n  )\n\n  return (\n    <Popup\n      position='down'\n      alignment='start'\n      isVisible={isVisible}\n      onRequestClose={onRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default w-144 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        <TextSizeOption active={nil(value)} onPress={() => handlePressOption()}>\n          <span className='-ml-1'>Normal</span>\n        </TextSizeOption>\n        <TextSizeOption\n          active={value === 'heading-three'}\n          onPress={() => handlePressOption('heading-three')}\n        >\n          <span className='text-headline -ml-1'>Heading 3</span>\n        </TextSizeOption>\n        <TextSizeOption\n          active={value === 'heading-two'}\n          onPress={() => handlePressOption('heading-two')}\n        >\n          <span className='text-heading-3 -ml-1'>Heading 2</span>\n        </TextSizeOption>\n        <TextSizeOption\n          active={value === 'heading-one'}\n          onPress={() => handlePressOption('heading-one')}\n        >\n          <span className='text-heading-2 -ml-1'>Heading 1</span>\n        </TextSizeOption>\n      </div>\n    </Popup>\n  )\n}\n\nexport default TextSizePopup\n","import {\n  BlockAlignment,\n  EditableAttributes,\n  EditableRefAttributes,\n  HeadingFormatType,\n  LeafFormatType,\n  createEditableNode,\n  decreaseIndentation,\n  focusEditor,\n  increaseIndentation,\n  insertEditableBlock,\n  insertImageBlock,\n  isBlockActive,\n  isMarkActive,\n  setAlignment,\n  setConditionActive,\n  toggleBlockActive,\n  toggleColorMarkActive,\n  toggleMarkActive,\n  unsetConditionActive\n} from '../../core/tools'\nimport { ImageDimensions, nil, notNil } from '../../core/utils'\nimport ImagePopup, { ImageProps } from '../popups/image'\nimport React, { FC, Fragment, useCallback, useRef } from 'react'\nimport {\n  useAlignmentValue,\n  useCanRedo,\n  useCanUndo,\n  useConditionActive,\n  useEditor,\n  useLeafColorValue,\n  useMouseDown,\n  useOrphanNodes,\n  usePopupUtils,\n  useTextSizeValue\n} from '../../core/hooks'\n\nimport { ALIGNMENTS } from '../../core/constants'\nimport ColorPopup from '../popups/color'\nimport ConditionPopup from '../popups/condition'\nimport EditablePopupProps from '../popups/editable'\nimport { FiInbox } from '@react-icons/all-files/fi/FiInbox'\nimport { GrRedo } from '@react-icons/all-files/gr/GrRedo'\nimport { GrUndo } from '@react-icons/all-files/gr/GrUndo'\nimport { HistoryEditor } from 'slate-history'\nimport Icon from '../icon'\nimport IconButton from '../icon-button'\nimport IconGroup from '../icon-group'\nimport ImageSizePopup from '../popups/image-size'\nimport { MdFormatAlignCenter } from '@react-icons/all-files/md/MdFormatAlignCenter'\nimport { MdFormatAlignJustify } from '@react-icons/all-files/md/MdFormatAlignJustify'\nimport { MdFormatAlignLeft } from '@react-icons/all-files/md/MdFormatAlignLeft'\nimport { MdFormatAlignRight } from '@react-icons/all-files/md/MdFormatAlignRight'\nimport { MdFormatBold } from '@react-icons/all-files/md/MdFormatBold'\nimport { MdFormatIndentDecrease } from '@react-icons/all-files/md/MdFormatIndentDecrease'\nimport { MdFormatIndentIncrease } from '@react-icons/all-files/md/MdFormatIndentIncrease'\nimport { MdFormatItalic } from '@react-icons/all-files/md/MdFormatItalic'\nimport { MdFormatListBulleted } from '@react-icons/all-files/md/MdFormatListBulleted'\nimport { MdFormatListNumbered } from '@react-icons/all-files/md/MdFormatListNumbered'\nimport { MdFormatSize } from '@react-icons/all-files/md/MdFormatSize'\nimport { MdFormatStrikethrough } from '@react-icons/all-files/md/MdFormatStrikethrough'\nimport { MdFormatUnderlined } from '@react-icons/all-files/md/MdFormatUnderlined'\nimport { MdTextFields } from '@react-icons/all-files/md/MdTextFields'\nimport { MdTransform } from '@react-icons/all-files/md/MdTransform'\nimport OrphanNodesPopup from '../popups/orphan-nodes'\nimport { RiImage2Fill } from '@react-icons/all-files/ri/RiImage2Fill'\nimport { RiImageEditFill } from '@react-icons/all-files/ri/RiImageEditFill'\nimport TextSizePopup from '../popups/text-size'\nimport { Transforms } from 'slate'\nimport classnames from 'classnames'\n\nconst Toolbar: FC = () => {\n  const editor = useEditor()\n  const editorSelection = useRef(editor.selection)\n\n  const textSizePopupAnchorRef = useRef(null)\n  const colorPopupAnchorRef = useRef(null)\n  const imagePopupAnchorRef = useRef(null)\n  const imageSizePopupAnchorRef = useRef(null)\n  const conditionPopupAnchorRef = useRef(null)\n  const orphanNodesPopupAnchorRef = useRef(null)\n\n  const textSizePopup = usePopupUtils()\n  const colorPopup = usePopupUtils()\n  const imagePopup = usePopupUtils()\n  const imageSizePopup = usePopupUtils()\n  const editablePopup = usePopupUtils()\n  const conditionPopup = usePopupUtils()\n  const orphanNodesPopup = usePopupUtils()\n\n  const textSizeValue = useTextSizeValue()\n  const leafColorValue = useLeafColorValue()\n  const alignmentValue = useAlignmentValue()\n  const canUndo = useCanUndo()\n  const canRedo = useCanRedo()\n  const conditionActive = useConditionActive()\n\n  const [, setOrphanNodes] = useOrphanNodes()\n\n  const handleChangeTextSizeOption = useCallback(\n    (value: HeadingFormatType) => {\n      const prevValue = textSizeValue?.name\n\n      if (value === prevValue) {\n        return\n      }\n\n      if (notNil(prevValue)) {\n        toggleBlockActive(editor, prevValue)\n      }\n\n      if (notNil(value)) {\n        toggleBlockActive(editor, value)\n      }\n\n      focusEditor(editor)\n    },\n    [editor, textSizeValue]\n  )\n\n  const handleChangeColorOption = useCallback(\n    (value: string, focus = true) => {\n      const prevValue = leafColorValue\n\n      if (value === prevValue) {\n        return\n      }\n\n      if (notNil(editorSelection.current)) {\n        Transforms.select(editor, editorSelection.current)\n      }\n\n      if (notNil(prevValue)) {\n        toggleColorMarkActive(editor, prevValue)\n      }\n\n      if (notNil(value)) {\n        toggleColorMarkActive(editor, value)\n      }\n\n      editorSelection.current = editor.selection\n\n      if (focus) {\n        focusEditor(editor)\n      }\n    },\n    [editor, leafColorValue]\n  )\n\n  const handleCreateImage = useCallback(\n    (value: ImageProps) => {\n      if (notNil(editorSelection.current)) {\n        Transforms.select(editor, editorSelection.current)\n      }\n\n      insertImageBlock(editor, value)\n      focusEditor(editor)\n    },\n    [editor]\n  )\n\n  const handleCreateEditableImage = useCallback(\n    (value: ImageDimensions, label: string) => {\n      if (notNil(editorSelection.current)) {\n        Transforms.select(editor, editorSelection.current)\n      }\n\n      insertImageBlock(editor, { dimensions: value, label }, true)\n      focusEditor(editor)\n    },\n    [editor]\n  )\n\n  const handleCreateEditable = useCallback(\n    (value: EditableAttributes, isOrphan = false) => {\n      if (notNil(editorSelection.current)) {\n        Transforms.select(editor, editorSelection.current)\n      }\n\n      if (isOrphan) {\n        const editableNode = createEditableNode(value, true)\n        setOrphanNodes((o) => [editableNode, ...o])\n      } else {\n        insertEditableBlock(editor, value)\n      }\n\n      focusEditor(editor)\n    },\n    [editor, setOrphanNodes]\n  )\n\n  const handleSetConditionActive = useCallback(\n    (value: EditableRefAttributes) => {\n      if (notNil(editorSelection.current)) {\n        Transforms.select(editor, editorSelection.current)\n      }\n\n      setConditionActive(editor, value)\n      focusEditor(editor)\n    },\n    [editor]\n  )\n\n  const handlePressTextSize = useMouseDown(() => {\n    textSizePopup.open()\n  })\n\n  const handlePressColor = useMouseDown(() => {\n    editorSelection.current = editor.selection\n    colorPopup.open()\n  })\n\n  const handlePressImage = useMouseDown(() => {\n    editorSelection.current = editor.selection\n    imagePopup.open()\n  })\n\n  const handlePressEditableImage = useMouseDown(() => {\n    editorSelection.current = editor.selection\n    imageSizePopup.open()\n  })\n\n  const handlePressInsertEditable = useMouseDown(() => {\n    editorSelection.current = editor.selection\n    editablePopup.open()\n  })\n\n  const handlePressCondition = useMouseDown(() => {\n    if (conditionActive) {\n      unsetConditionActive(editor)\n      return\n    }\n\n    editorSelection.current = editor.selection\n    conditionPopup.open()\n  })\n\n  const handlePressInlineFormat = useCallback(\n    (format: LeafFormatType) => {\n      toggleMarkActive(editor, format)\n    },\n    [editor]\n  )\n\n  const handlePressAlignment = useCallback(\n    (value?: BlockAlignment) => {\n      setAlignment(editor, value)\n    },\n    [editor]\n  )\n\n  const handlePressIncreaseIndentation = useCallback(() => {\n    increaseIndentation(editor)\n  }, [editor])\n\n  const handlePressDecreaseIndentation = useCallback(() => {\n    decreaseIndentation(editor)\n  }, [editor])\n\n  const handlePressNumberedList = useCallback(() => {\n    toggleBlockActive(editor, 'numbered-list')\n  }, [editor])\n\n  const handlePressBulletedList = useCallback(() => {\n    toggleBlockActive(editor, 'bulleted-list')\n  }, [editor])\n\n  const handlePressUndo = useCallback(() => {\n    HistoryEditor.undo(editor)\n  }, [editor])\n\n  const handlePressRedo = useCallback(() => {\n    HistoryEditor.redo(editor)\n  }, [editor])\n\n  return (\n    <Fragment>\n      <div className='border-t border-b border-solid border-gray-300 py-20 px-60 bg-blue-50 flex items-center divide-x divide-gray-300 text-gray-500'>\n        <div className='font-medium flex items-center'>\n          <div\n            ref={textSizePopupAnchorRef}\n            className='flex items-center w-144 space-x-4 flex-1'\n            onMouseDown={handlePressTextSize}\n          >\n            <Icon>\n              <MdFormatSize />\n            </Icon>\n            <span className='flex-1 cursor-pointer transition-colors duration-250 hover:text-blue-500'>\n              {textSizeValue?.label || 'Normal'}\n            </span>\n          </div>\n          <div\n            ref={colorPopupAnchorRef}\n            className={classnames(\n              's-28 cursor-pointer border-2 border-solid border-white mx-16 rounded-full shadow-2 transition-colors duration-250',\n              {\n                'bg-black': nil(leafColorValue)\n              }\n            )}\n            style={{ backgroundColor: leafColorValue }}\n            onMouseDown={handlePressColor}\n          />\n        </div>\n        <IconGroup>\n          <IconButton\n            data='bold'\n            tip='Bold'\n            active={isMarkActive(editor, 'bold')}\n            onPress={handlePressInlineFormat}\n          >\n            <MdFormatBold />\n          </IconButton>\n          <IconButton\n            data='italic'\n            tip='Italic'\n            active={isMarkActive(editor, 'italic')}\n            onPress={handlePressInlineFormat}\n          >\n            <MdFormatItalic />\n          </IconButton>\n          <IconButton\n            data='underline'\n            tip='Underline'\n            active={isMarkActive(editor, 'underline')}\n            onPress={handlePressInlineFormat}\n          >\n            <MdFormatUnderlined />\n          </IconButton>\n          <IconButton\n            data='strikethrough'\n            tip='Strikethrough'\n            active={isMarkActive(editor, 'strikethrough')}\n            onPress={handlePressInlineFormat}\n          >\n            <MdFormatStrikethrough />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton\n            tip='Align left'\n            active={nil(alignmentValue) || alignmentValue === ALIGNMENTS.left}\n            onPress={handlePressAlignment}\n          >\n            <MdFormatAlignLeft />\n          </IconButton>\n          <IconButton\n            data='center'\n            tip='Align center'\n            active={alignmentValue === ALIGNMENTS.center}\n            onPress={handlePressAlignment}\n          >\n            <MdFormatAlignCenter />\n          </IconButton>\n          <IconButton\n            data='right'\n            tip='Align right'\n            active={alignmentValue === ALIGNMENTS.right}\n            onPress={handlePressAlignment}\n          >\n            <MdFormatAlignRight />\n          </IconButton>\n          <IconButton\n            data='justify'\n            tip='Justify'\n            active={alignmentValue === ALIGNMENTS.justify}\n            onPress={handlePressAlignment}\n          >\n            <MdFormatAlignJustify />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton\n            tip='Decrease indent'\n            onPress={handlePressDecreaseIndentation}\n          >\n            <MdFormatIndentDecrease />\n          </IconButton>\n          <IconButton\n            tip='Increase indent'\n            onPress={handlePressIncreaseIndentation}\n          >\n            <MdFormatIndentIncrease />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton\n            tip='Numbered list'\n            active={isBlockActive(editor, 'numbered-list')}\n            onPress={handlePressNumberedList}\n          >\n            <MdFormatListNumbered />\n          </IconButton>\n          <IconButton\n            tip='Bulleted list'\n            active={isBlockActive(editor, 'bulleted-list')}\n            onPress={handlePressBulletedList}\n          >\n            <MdFormatListBulleted />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton\n            tip='Insert an image'\n            ref={imagePopupAnchorRef}\n            active={imagePopup.visible}\n            onPress={handlePressImage}\n          >\n            <RiImage2Fill />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton\n            tip='Insert an editable image'\n            ref={imageSizePopupAnchorRef}\n            active={imageSizePopup.visible}\n            onPress={handlePressEditableImage}\n            className='border border-dotted border-gray-500'\n          >\n            <RiImageEditFill />\n          </IconButton>\n          <IconButton\n            tip='Insert editable content'\n            active={editablePopup.visible}\n            className='border border-dotted border-gray-500'\n            onPress={handlePressInsertEditable}\n          >\n            <MdTextFields />\n          </IconButton>\n          <IconButton\n            tip='Add a display condition'\n            ref={conditionPopupAnchorRef}\n            active={conditionActive || conditionPopup.visible}\n            onPress={handlePressCondition}\n            className='border border-dotted border-gray-500'\n          >\n            <MdTransform />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton tip='Undo' onPress={handlePressUndo} disabled={!canUndo}>\n            <GrUndo />\n          </IconButton>\n          <IconButton tip='Redo' onPress={handlePressRedo} disabled={!canRedo}>\n            <GrRedo />\n          </IconButton>\n        </IconGroup>\n        <div className='flex flex-1 items-center justify-end border-none'>\n          <IconButton\n            tip='Open Icebox'\n            ref={orphanNodesPopupAnchorRef}\n            active={orphanNodesPopup.visible}\n            onPress={orphanNodesPopup.open}\n          >\n            <FiInbox />\n          </IconButton>\n        </div>\n      </div>\n      <TextSizePopup\n        anchorRef={textSizePopupAnchorRef}\n        isVisible={textSizePopup.visible}\n        value={textSizeValue?.name}\n        onPressOption={handleChangeTextSizeOption}\n        onRequestClose={textSizePopup.close}\n      />\n      <ColorPopup\n        anchorRef={colorPopupAnchorRef}\n        isVisible={colorPopup.visible}\n        value={leafColorValue}\n        onChangeColorOption={handleChangeColorOption}\n        onRequestClose={colorPopup.close}\n      />\n      <ImagePopup\n        anchorRef={imagePopupAnchorRef}\n        isVisible={imagePopup.visible}\n        onRequestClose={imagePopup.close}\n        onSubmitEditing={handleCreateImage}\n      />\n      <ImageSizePopup\n        anchorRef={imageSizePopupAnchorRef}\n        isVisible={imageSizePopup.visible}\n        onRequestClose={imageSizePopup.close}\n        onSubmitEditing={handleCreateEditableImage}\n      />\n      <EditablePopupProps\n        isVisible={editablePopup.visible}\n        onRequestClose={editablePopup.close}\n        onSubmit={handleCreateEditable}\n      />\n      <ConditionPopup\n        anchorRef={conditionPopupAnchorRef}\n        isVisible={conditionPopup.visible}\n        onRequestClose={conditionPopup.close}\n        onSubmitEditing={handleSetConditionActive}\n      />\n      <OrphanNodesPopup\n        anchorRef={orphanNodesPopupAnchorRef}\n        isVisible={orphanNodesPopup.visible}\n        onRequestClose={orphanNodesPopup.close}\n      />\n    </Fragment>\n  )\n}\n\nexport default Toolbar\n","import { Editor, Element as SlateElement, Transforms } from 'slate'\n\nimport { ReactEditor } from 'slate-react'\nimport { jsx } from 'slate-hyperscript'\n\nconst ELEMENT_TAGS = {\n  A: (element: Element) => ({\n    type: 'link',\n    url: element.getAttribute('href')\n  }),\n  BLOCKQUOTE: () => ({ type: 'quote' }),\n  H1: () => ({ type: 'heading-one' }),\n  H2: () => ({ type: 'heading-two' }),\n  H3: () => ({ type: 'heading-three' }),\n  H4: () => ({ type: 'heading-four' }),\n  H5: () => ({ type: 'heading-five' }),\n  H6: () => ({ type: 'heading-six' }),\n  IMG: (element: Element) => ({\n    type: 'image',\n    url: element.getAttribute('src')\n  }),\n  LI: () => ({ type: 'list-item' }),\n  OL: () => ({ type: 'numbered-list' }),\n  P: () => ({ type: 'paragraph' }),\n  PRE: () => ({ type: 'code' }),\n  UL: () => ({ type: 'bulleted-list' })\n}\n\nconst TEXT_TAGS = {\n  CODE: () => ({ code: true }),\n  DEL: () => ({ strikethrough: true }),\n  EM: () => ({ italic: true }),\n  I: () => ({ italic: true }),\n  S: () => ({ strikethrough: true }),\n  STRONG: () => ({ bold: true }),\n  U: () => ({ underline: true })\n}\n\nexport const deserializeHTML = (el: ChildNode) => {\n  if (el.nodeType === 3) {\n    return el.textContent\n  } else if (el.nodeType !== 1) {\n    return null\n  } else if (el.nodeName === 'BR') {\n    return '\\n'\n  }\n\n  const { nodeName } = el\n  let parent = el\n\n  if (\n    nodeName === 'PRE' &&\n    el.childNodes[0] &&\n    el.childNodes[0].nodeName === 'CODE'\n  ) {\n    parent = el.childNodes[0]\n  }\n\n  const children = Array.from(parent.childNodes).map(deserializeHTML).flat()\n\n  if (el.nodeName === 'BODY') {\n    return jsx('fragment', {}, children)\n  }\n\n  if (ELEMENT_TAGS[nodeName]) {\n    const attrs = ELEMENT_TAGS[nodeName](el)\n    return jsx('element', attrs, children)\n  }\n\n  if (TEXT_TAGS[nodeName]) {\n    const attrs = TEXT_TAGS[nodeName](el)\n    return children.map((child) => jsx('text', attrs, child))\n  }\n\n  return children\n}\n\nexport const withHTML = (editor: Editor & ReactEditor) => {\n  const { insertData, isInline, isVoid } = editor\n\n  editor.isInline = (element: SlateElement) => {\n    return ['link', 'image'].includes(element.type as string)\n      ? true\n      : isInline(element)\n  }\n\n  editor.isVoid = (element) => {\n    return element.type === 'image' ? true : isVoid(element)\n  }\n\n  editor.insertData = (data) => {\n    const html = data.getData('text/html')\n    // const rtf = data.getData('text/rtf')\n    console.log(html)\n\n    if (html) {\n      const parsed = new DOMParser().parseFromString(html, 'text/html')\n      const fragment = deserializeHTML(parsed.body)\n      Transforms.insertFragment(editor, fragment)\n      return\n    }\n\n    insertData(data)\n  }\n\n  return editor\n}\n","import 'tailwindcss/tailwind.css'\n\nimport { DocmakerData, SlateEditorType, toggleMarkActive } from './core/tools'\nimport { Editable, Slate, withReact } from 'slate-react'\nimport { Node, createEditor } from 'slate'\nimport React, {\n  KeyboardEvent,\n  useCallback,\n  useMemo,\n  useRef,\n  useState\n} from 'react'\nimport { stripHTMLEntities, toDate } from './core/utils'\n\nimport { HOT_KEYS } from './core/constants'\nimport Header from './modules/header'\nimport OrphanNodesContext from './core/contexts/orphan-nodes'\nimport TemplateEditor from './modules/template-editor'\nimport TemplateElement from './modules/template-element'\nimport TemplateLeaf from './modules/template-leaf'\nimport Toolbar from './modules/toolbar'\nimport classnames from 'classnames'\nimport isHotkey from 'is-hotkey'\n// import { jsx } from 'slate-hyperscript'\n// import { withDocxDeserializer } from 'slate-docx-deserializer'\nimport { withEditable } from './core/plugins/editable'\nimport { withHTML } from './core/plugins/paste-html'\nimport { withHistory } from 'slate-history'\n\ninterface Props {\n  className?: string\n  initialValue?: DocmakerData\n  onSubmitChanges?: (data: DocmakerData) => void\n}\n\nexport const DocmakerEditor = ({\n  className,\n  initialValue,\n  onSubmitChanges\n}: Props) => {\n  const initialData = useRef(initialValue || ({} as DocmakerData)).current\n  const editor = useMemo(\n    () => withHTML(withEditable(withReact(withHistory(createEditor())))),\n    []\n  )\n  const createdAt = useRef(toDate(initialData.createdAt).toISOString()).current\n\n  const [title, setTitle] = useState(initialData.title || '')\n  const [orphanNodes, setOrphanNodes] = useState<Array<Node>>(\n    initialData.orphans || []\n  )\n  const [editorState, setEditorState] = useState<Array<Node>>(\n    initialData.nodes?.length\n      ? initialData.nodes\n      : [\n          {\n            type: 'paragraph',\n            children: [{ text: '' }]\n          }\n        ]\n  )\n\n  const renderElement = useCallback(\n    (props) => <TemplateElement {...props} />,\n    []\n  )\n\n  const renderLeaf = useCallback((props) => <TemplateLeaf {...props} />, [])\n\n  const handleEditorKeydown = useCallback(\n    (event: KeyboardEvent) => {\n      for (const hotkey in HOT_KEYS) {\n        if (isHotkey(hotkey, event as any)) {\n          event.preventDefault()\n          const mark = HOT_KEYS[hotkey]\n          toggleMarkActive(editor as SlateEditorType, mark)\n        }\n      }\n    },\n    [editor]\n  )\n\n  const handlePressSave = useCallback(() => {\n    onSubmitChanges?.({\n      title: stripHTMLEntities(title),\n      createdAt,\n      nodes: editorState as any,\n      orphans: orphanNodes as any\n    })\n  }, [onSubmitChanges, title, createdAt, editorState, orphanNodes])\n\n  return (\n    <div className={classnames('font-sans', className)}>\n      <OrphanNodesContext.Provider value={[orphanNodes, setOrphanNodes]}>\n        <Slate editor={editor} value={editorState} onChange={setEditorState}>\n          <div className='sticky top-0'>\n            <Header\n              title={title}\n              createdAt={createdAt}\n              onChangeTitle={setTitle}\n              onPressSave={handlePressSave}\n            />\n            <Toolbar />\n          </div>\n          <TemplateEditor>\n            <Editable\n              spellCheck\n              placeholder='Start typing...'\n              renderElement={renderElement}\n              renderLeaf={renderLeaf}\n              onKeyDown={handleEditorKeydown}\n            />\n          </TemplateEditor>\n        </Slate>\n      </OrphanNodesContext.Provider>\n    </div>\n  )\n}\n","import { Editor, Element as SlateElement } from 'slate'\nimport { ReactEditor } from 'slate-react'\n\nexport const withEditable = (editor: Editor & ReactEditor) => {\n  const { isInline, isVoid } = editor\n\n  editor.isInline = (element: SlateElement) => {\n    return element.type === 'editable' ? true : isInline(element)\n  }\n\n  editor.isVoid = (element: SlateElement) => {\n    return element.type === 'editable' ? true : isVoid(element)\n  }\n\n  return editor\n}\n","import React from 'react'\n\nimport { DocmakerEditor } from 'react-docmaker'\nimport 'react-docmaker/dist/index.css'\n\nconst App = () => {\n  return <DocmakerEditor onSubmitChanges={console.log} />\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}