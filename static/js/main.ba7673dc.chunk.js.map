{"version":3,"sources":["../../src/modules/button/index.tsx","../../src/core/utils/index.ts","../../src/modules/header/index.tsx","../../src/core/contexts/orphan-nodes.ts","../../src/core/constants/index.ts","../../src/core/tools/index.ts","../../src/core/hooks/index.ts","../../src/modules/icon/index.tsx","../../src/modules/icon-button/index.tsx","../../src/modules/icon-group/index.tsx","../../src/modules/popup/content/index.tsx","../../src/modules/popup/index.tsx","../../src/modules/popups/text-size/index.tsx","../../src/modules/popups/color/index.tsx","../../node_modules/babel-plugin-transform-async-to-promises/helpers.js","../../src/modules/popups/image/index.tsx","../../src/modules/popups/image-size/index.tsx","../../src/modules/segmented-control/index.tsx","../../src/modules/field/index.tsx","../../src/modules/popups/editable/copy-existing/index.tsx","../../src/modules/switch/index.tsx","../../src/modules/popups/editable/create-new/index.tsx","../../src/modules/popups/editable/index.tsx","../../src/modules/popups/condition/index.tsx","../../src/modules/popups/orphan-nodes/index.tsx","../../src/modules/toolbar/index.tsx","../../src/modules/template-editor/index.tsx","../../src/core/plugins/paste-html.ts","../../src/modules/elements/image/index.tsx","../../src/modules/elements/editable/index.tsx","../../src/modules/template-element/index.tsx","../../src/modules/template-leaf/index.tsx","../../src/index.tsx","../../src/core/plugins/editable.ts","App.tsx","index.tsx"],"names":["Button","memo","children","className","disabled","React","onClick","onPress","classnames","bg-blue-500","pointer-events-none bg-blue-300","h-40","test","nil","value","notNil","clamp","min","max","Math","parseNumber","parsed","parseFloat","isNaN","formatDate","dateTime","token","format","Date","error","isHexColor","text","areEqualColors","left","right","replace","toLowerCase","generateUUID","uuidv4","Header","title","createdAt","onChangeTitle","onPressSave","editorRef","useRef","state","ContentEditable","innerRef","placeholder","html","current","onChange","event","target","innerHTML","onBlur","formatRelative","toUpperCase","substr","length","OrphanNodesContext","createContext","n","LIST_TYPES","HOT_KEYS","mod+b","mod+i","mod+u","mod+shift+x","PRESET_COLORS","EDITABLE_DATA_TYPES","options","radio","date","time","DATE_FORMATS","TIME_FORMATS","isBlockActive","editor","Editor","nodes","match","isEditor","SlateElement","isElement","type","isMarkActive","marks","nodesInSelection","getMatchingNodesInSelection","o","isInline","editableNodes","marksResolution","editablesResolution","includes","map","every","getColorMark","marksValue","color","editablesValue","toggleMarkActive","removeMark","Transforms","unsetNodes","isVoid","setNodes","hanging","addMark","toggleColorMarkActive","existingMark","toggleBlockActive","unwrapNodes","split","isList","wrapNodes","focusEditor","ReactEditor","focus","composeWithClassName","attributes","composeWithAlignmentClassName","alignment","text-right","text-center","text-justify","composeWithStyle","style","getCurrentNode","selection","anchor","parentNode","path","getIndentation","currentNode","indentation","getIndentationPercent","composeWithEditable","editable","id","createEditableNode","isOrphan","editableNode","insertImageBlock","dimensions","imageNode","url","width","height","insertNodes","move","getEditableAttributes","showTip","dataType","dateTimeFormat","multiline","label","tip","valueRef","parsedAttributes","defaultValue","getEditableAttributesValidity","copyExisting","getMatchingNodes","node","matching","push","generator","Array","from","usePopupUtils","initialOpen","useState","visible","setVisible","handleOpen","useCallback","handleClose","handleToggle","useMemo","open","close","toggle","useEditor","useSlate","useMouseDown","fn","e","preventDefault","useOrphanNodes","useContext","Icon","handlePress","onMouseDown","s-16","Children","child","cloneElement","props","IconButton","forwardRef","ref","active","data","text-blue-500 bg-blue-highlight","pointer-events-none opacity-50","IconGroup","Content","onLayoutUpdate","x","y","position","hideArrow","setDimensions","useLayoutEffect","document","querySelector","css","container","getBoundingClientRect","computedDimensions","JSON","stringify","composedClassName","arrow","top","defaultProps","getViewportWidth","window","innerWidth","documentElement","clientWidth","body","getViewportHeight","innerHeight","clientHeight","getPositioningWithoutAnchor","viewportWidth","viewportHeight","Popup","anchorRef","contentClassName","transparent","distance","offsets","isVisible","overlayCloseOnClick","onRequestClose","popupContentPosition","setPopupContentPosition","handleClickOverlay","handleKeyUp","key","useEffect","addEventListener","removeEventListener","contentPosition","anchorElement","anchorWidth","anchorHeight","anchorX","anchorY","yOffset","rightEdge","bottomEdge","TextSizeOption","TextSizePopup","onPressOption","handlePressOption","option","ColorBox","ColorPopup","onChangeColorOption","colorState","setColorState","handlePressColorOption","selectedColor","replaceAll","handleChangeInput","inputValue","parsedColor","maxLength","Symbol","iterator","asyncIterator","ImagePopup","onSubmitEditing","imageState","setImageState","scaleState","setScaleState","imageDimensions","setImageDimensions","decimalScale","handleChangeImageUrl","handleChangeScale","handleBlurImageInput","recover","result","Promise","resolve","img","createElement","onload","naturalWidth","naturalHeight","onerror","src","then","handleRequestClose","handlePressSubmit","BiLink","ImageSizePopup","setWidth","setHeight","isValid","handleChangeWidth","handleChangeHeight","TiTimes","SegmentedControl","onChangeValue","i","text-gray-500 hover:text-gray-700","text-white","index","Field","EditableCopyExisting","onSubmit","orphanNodes","concat","setValueRef","setDefaultValue","find","handleChangeValueRef","handleChangeDefaultValue","hidden","Switch","ReactSwitch","checked","offColor","onColor","checkedIcon","uncheckedIcon","handleDiameter","activeBoxShadow","EditableCreateNew","now","dataTypeOptions","Object","entries","dateFormatOptions","timeFormatOptions","setDataType","setDateTimeFormat","setLabel","setMultiline","setOptions","editingOption","setEditingOption","setShowTip","setIsOrphan","setTip","handlePressDeleteOption","eventualValue","findIndex","splice","handlePressAddOption","trim","groundValue","handleEditingOptionKeydown","handleChangeDataType","handleChangeDateTimeFormat","handleChangeEditingOption","handleChangeLabel","handleChangeTip","FaRegTrashAlt","onKeyDown","AiFillPlusCircle","EditablePopupProps","segment","setSegment","handleSubmit","ConditionPopup","parent","setParent","setValue","handleChangeParent","selected","handleChangeValue","OrphanNodesPopup","setOrphanNodes","handlePressDelete","FiInbox","Toolbar","editorSelection","textSizePopupAnchorRef","colorPopupAnchorRef","imagePopupAnchorRef","imageSizePopupAnchorRef","conditionPopupAnchorRef","orphanNodesPopupAnchorRef","textSizePopup","colorPopup","imagePopup","imageSizePopup","editablePopup","conditionPopup","orphanNodesPopup","textSizeValue","headingOneActive","headingTwoActive","headingThreeActive","name","leafColorValue","alignmentValue","canUndo","history","_editor$history","undos","canRedo","_editor$history2","redos","conditionActive","handleChangeTextSizeOption","prevValue","handleChangeColorOption","select","handleCreateImage","handleCreateEditableImage","handleCreateEditable","handleSetConditionActive","condition","handlePressTextSize","handlePressColor","handlePressImage","handlePressEditableImage","handlePressInsertEditable","handlePressCondition","handlePressInlineFormat","handlePressAlignment","handlePressIncreaseIndentation","handlePressDecreaseIndentation","handlePressNumberedList","handlePressBulletedList","handlePressUndo","HistoryEditor","undo","handlePressRedo","redo","Fragment","MdFormatSize","bg-black","backgroundColor","MdFormatBold","MdFormatItalic","MdFormatUnderlined","MdFormatStrikethrough","MdFormatAlignLeft","MdFormatAlignCenter","MdFormatAlignRight","MdFormatAlignJustify","MdFormatIndentDecrease","MdFormatIndentIncrease","MdFormatListNumbered","MdFormatListBulleted","RiImage2Fill","RiImageEditFill","MdTextFields","MdTransform","GrUndo","GrRedo","TemplateEditor","ELEMENT_TAGS","A","element","getAttribute","BLOCKQUOTE","H1","H2","H3","H4","H5","H6","IMG","LI","OL","P","PRE","UL","TEXT_TAGS","CODE","code","DEL","strikethrough","EM","italic","I","S","STRONG","bold","U","underline","ImageElement","useSelected","focused","useFocused","shadow-outline","EditableElement","fontSize","contentEditable","TemplateElement","paddingLeft","href","TemplateLeaf","leaf","bg-green-highlight","DocmakerEditor","onSubmitChanges","initialData","initialValue","insertData","getData","fragment","deserializeHTML","el","nodeType","textContent","nodeName","childNodes","flat","jsx","attrs","DOMParser","parseFromString","insertFragment","withReact","withHistory","createEditor","toISOString","setTitle","orphans","editorState","setEditorState","renderElement","renderLeaf","handleEditorKeydown","hotkey","isHotkey","handlePressSave","Provider","Slate","Editable","spellCheck","App","console","log","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.ba7673dc.chunk.js","sourcesContent":["import React, { FC, memo, PropsWithChildren } from 'react'\nimport classnames from 'classnames'\n\ntype ButtonProps = PropsWithChildren<{\n  className?: string\n  disabled?: boolean\n  onPress?: Fn\n}>\n\nconst BaseButton: FC<ButtonProps> = ({\n  children,\n  className,\n  disabled,\n  onPress\n}) => {\n  return (\n    <button\n      onClick={onPress}\n      className={classnames(\n        'border-transparent rounded-default font-medium cursor-pointer text-white px-18 flex items-center justify-center transition-colors duration-250 hover:bg-blue-600',\n        {\n          'bg-blue-500': !disabled,\n          'pointer-events-none bg-blue-300': disabled,\n          'h-40': !/\\bh-[0-9]/gi.test(className)\n        },\n        className\n      )}\n    >\n      {children}\n    </button>\n  )\n}\n\nconst Button = memo(BaseButton)\n\nexport default Button\n","import format from 'date-fns/format'\nimport formatRelative from 'date-fns/formatRelative'\nimport { v4 as uuidv4 } from 'uuid'\n\nexport type ValidDate = Date | string | number\n\nexport type ImageDimensions = {\n  width: number\n  height: number\n}\n\n// ----------------------------------------------------------------\n// UTILITY\n// ----------------------------------------------------------------\n\nexport function nil<T>(value: T): boolean {\n  return typeof value === 'undefined' || value === null\n}\n\nexport function notNil<T>(value: T): boolean {\n  return !nil(value)\n}\n\nexport function getImageSizeAsync(url: string): Promise<ImageDimensions> {\n  if (!url) {\n    return null\n  }\n\n  return new Promise((resolve) => {\n    const img = document.createElement('img')\n\n    img.onload = () => {\n      resolve({ width: img.naturalWidth, height: img.naturalHeight })\n    }\n\n    img.onerror = () => {\n      resolve(null)\n    }\n\n    img.src = url\n  })\n}\n\n// ----------------------------------------------------------------\n// NUMBER\n// ----------------------------------------------------------------\nexport function clamp(value: number, min: number, max: number) {\n  return Math.min(Math.max(value, min), max)\n}\n\nexport function parseNumber(value: string): number {\n  if (nil(value)) {\n    return null\n  }\n\n  const parsed = parseFloat(value)\n  return isNaN(parsed) ? 0 : parsed\n}\n\n// ----------------------------------------------------------------\n// DATETIME\n// ----------------------------------------------------------------\n\nexport function fromNow(dateTime: ValidDate): string {\n  return formatRelative(new Date(dateTime), new Date())\n}\n\nexport function formatDate(dateTime: ValidDate, token = 'yyyy-MM-dd'): string {\n  if (nil(dateTime)) return undefined\n\n  try {\n    return format(\n      dateTime instanceof Date ? dateTime : new Date(dateTime),\n      token\n    )\n  } catch (error) {\n    return undefined\n  }\n}\n\nexport function toDate(dateTime: ValidDate): Date {\n  if (!dateTime) {\n    return new Date()\n  }\n\n  return dateTime instanceof Date ? dateTime : new Date(dateTime)\n}\n\n// ----------------------------------------------------------------\n// STRING\n// ----------------------------------------------------------------\n\nexport function toTitleCase(text: string) {\n  if (nil(text)) {\n    return text\n  }\n  return `${text[0]?.toUpperCase()}${text?.substr(1).toLowerCase()}`\n}\n\nexport function toCapitalizedFirst(text: string) {\n  if (nil(text)) {\n    return text\n  }\n  return `${text[0]?.toUpperCase()}${text?.substr(1)}`\n}\n\nexport function stripHTMLEntities(text: string) {\n  return text\n    ?.replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/\"/g, '&nbsp;')\n}\n\nexport function isHexColor(text: string) {\n  return /^#([0-9A-F]{3}){1,2}$/i.test(text)\n}\n\nexport function areEqualColors(left: string, right: string) {\n  left = left?.replace(/^#/gi, '')?.toLowerCase()\n  right = right?.replace(/^#/gi, '')?.toLowerCase()\n\n  return left === right\n}\n\nexport function getPlaceholderImage(width: number, height?: number) {\n  return `https://dummyimage.com/${width}x${height || width}/326FF3/FFFFFF`\n}\n\nexport function generateUUID() {\n  return uuidv4()\n}\n","import React, { FC, useRef } from 'react'\nimport ContentEditable, { ContentEditableEvent } from 'react-contenteditable'\nimport Button from '../button'\nimport classnames from 'classnames'\nimport css from './style.module.css'\nimport { fromNow, toCapitalizedFirst } from '../../core/utils'\n\ntype HeaderProps = {\n  title?: string\n  createdAt?: string\n  onChangeTitle?: (value: string) => void\n  onPressSave?: Fn\n}\n\nconst Header: FC<HeaderProps> = ({\n  title,\n  createdAt,\n  onChangeTitle,\n  onPressSave\n}) => {\n  const editorRef = useRef(null)\n  const state = useRef(title)\n\n  const handleBlur = () => {\n    onChangeTitle?.(state.current)\n  }\n\n  const handleChange = (event: ContentEditableEvent) => {\n    const value = event.target.value\n    state.current = value\n\n    if (value === '<br>') {\n      editorRef.current.innerHTML = ''\n    }\n  }\n\n  return (\n    <div className='bg-white py-18 px-60 flex items-center justify-between'>\n      <div>\n        <ContentEditable\n          innerRef={editorRef}\n          className={classnames(\n            css.container,\n            'text-heading-2 font-medium mb-4'\n          )}\n          placeholder='Untitled document'\n          html={state.current}\n          onChange={handleChange}\n          onBlur={handleBlur}\n        />\n        {createdAt && (\n          <div className='font-medium text-gray-400 text-subhead'>\n            {toCapitalizedFirst(fromNow(createdAt))}\n          </div>\n        )}\n      </div>\n      <Button disabled={!state.current?.length} onPress={onPressSave}>\n        Save changes\n      </Button>\n    </div>\n  )\n}\n\nexport default Header\n","import { createContext, Dispatch, SetStateAction } from 'react'\nimport { Node } from 'slate'\n\nconst OrphanNodesContext = createContext<\n  [Array<Node>, Dispatch<SetStateAction<Array<Node>>>]\n>(null)\n\nexport default OrphanNodesContext\n","export const LIST_TYPES = ['numbered-list', 'bulleted-list']\n\nexport const HOT_KEYS = {\n  'mod+b': 'bold',\n  'mod+i': 'italic',\n  'mod+u': 'underline',\n  'mod+shift+x': 'strikethrough'\n}\n\nexport const PRESET_COLORS = [\n  '#FF6900',\n  '#FCB900',\n  '#7BDCB5',\n  '#00D084',\n  '#8ED1FC',\n  '#326FF3',\n  '#ABB8C3',\n  '#EB144C',\n  '#F78DA7',\n  '#9900EF'\n]\n\nexport const ALIGNMENTS = {\n  left: 'left',\n  right: 'right',\n  center: 'center',\n  justify: 'justify'\n}\n\nexport const INDENTATION_FACTOR = 3\n\nexport const EDITABLE_DATA_TYPES = {\n  text: 'Text',\n  options: 'Dropdown',\n  radio: 'Radio',\n  date: 'Date',\n  time: 'Time'\n}\n\nexport const DATE_FORMATS = [\n  'do MMMM, yyyy',\n  'dd MMMM, yyyy',\n  'MMMM dd, yyyy',\n  'dd/MM/yyyy',\n  'MM/dd/yyyy',\n  'MMM d, yyyy',\n  'dd MMM, yy',\n  'dd-MM-yyyy',\n  'dd-MM-yy'\n]\n\nexport const TIME_FORMATS = ['hh:mm a', 'hh:mm aaaa', 'HH:mm']\n","import { Editor, Element as SlateElement, Node, Transforms } from 'slate'\nimport { ReactEditor } from 'slate-react'\nimport classnames from 'classnames'\nimport { CSSProperties } from 'react'\nimport { areEqualColors, clamp, generateUUID, nil, notNil } from '../utils'\nimport { INDENTATION_FACTOR, LIST_TYPES } from '../constants'\nimport { HistoryEditor } from 'slate-history'\nimport { ImageProps } from '../../modules/popups/image'\nimport { ImageElementType } from '../../modules/elements/image'\n\nexport type BlockAlignment = 'left' | 'center' | 'right' | 'justify'\n\nexport type LeafFormatType =\n  | 'bold'\n  | 'code'\n  | 'italic'\n  | 'underline'\n  | 'strikethrough'\n  | 'color'\n  | 'ref'\n\nexport type HeadingFormatType = 'heading-one' | 'heading-two' | 'heading-three'\n\nexport type ListFormatType = 'numbered-list' | 'bulleted-list'\n\nexport type QuoteFormatType = 'block-quote'\n\nexport type ElementFormatType =\n  | HeadingFormatType\n  | ListFormatType\n  | QuoteFormatType\n\nexport type SlateEditorType = Editor & ReactEditor & HistoryEditor\n\nexport type EditableElementType<T> = {\n  id?: string\n  editable?: true\n} & T\n\nexport type EditableDataType = 'text' | 'options' | 'radio' | 'time' | 'date'\n\nexport type EditableOption = {\n  id: string\n  label: string\n}\n\nexport type EditableRefAttributes = {\n  parent: string\n  value: string\n}\n\nexport type EditableAttributes = Partial<{\n  dataType: EditableDataType\n  dateTimeFormat: string\n  defaultValue: string\n  label: string\n  multiline: boolean\n  options: Array<EditableOption>\n  tip: string\n  valueRef: string\n  ref: EditableRefAttributes\n  isOrphan: boolean\n  children: Array<EditableAttributes & { text: string }>\n}>\n\nexport type DocmakerNode = EditableElementType<\n  EditableAttributes & { text: string }\n>\n\nexport type DocmakerData = Partial<{\n  title: string\n  createdAt: string\n  nodes: Array<DocmakerNode>\n  orphans: Array<DocmakerNode>\n}>\n\nexport function isBlockActive(\n  editor: SlateEditorType,\n  format: ElementFormatType\n) {\n  const [match] = Editor.nodes(editor, {\n    match: (n) =>\n      !Editor.isEditor(n) && SlateElement.isElement(n) && n.type === format\n  }) as any\n\n  return !!match\n}\n\nexport function isMarkActiveLegacy(\n  editor: SlateEditorType,\n  format: LeafFormatType\n) {\n  if (!editor) {\n    return null\n  }\n\n  const marks = Editor.marks(editor)\n\n  if (notNil(marks)) {\n    const value = marks[format]\n    return format === 'ref' ? notNil(value) : value === true\n  }\n\n  return false\n}\n\nexport function isMarkActive(editor: SlateEditorType, format: LeafFormatType) {\n  if (!editor) {\n    return null\n  }\n\n  const marks = Editor.marks(editor)\n  const nodesInSelection = getMatchingNodesInSelection(editor, (o) =>\n    Editor.isInline(editor, o)\n  )\n  const editableNodes = getMatchingNodesInSelection(\n    editor,\n    (o) => o.type === 'editable'\n  )\n\n  let marksResolution = false\n  let editablesResolution = false\n\n  if (notNil(marks)) {\n    const value = marks[format]\n    marksResolution = ['color', 'ref'].includes(format)\n      ? notNil(value)\n      : value === true\n  }\n\n  if (editableNodes?.length) {\n    editablesResolution = editableNodes\n      .map((o) =>\n        ['color', 'ref'].includes(format)\n          ? notNil(o[format])\n          : o[format] === true\n      )\n      .every((o) => o)\n  }\n\n  if (\n    nodesInSelection?.length &&\n    nodesInSelection.every((o) => editableNodes.includes(o))\n  ) {\n    return editablesResolution\n  }\n\n  return editableNodes?.length\n    ? editablesResolution && marksResolution\n    : marksResolution\n}\n\nexport function isColorMarkActive(editor: SlateEditorType) {\n  if (!editor) {\n    return null\n  }\n\n  const marks = Editor.marks(editor)\n  return marks ? notNil(marks.color) : false\n}\n\nexport function getColorMark(editor: SlateEditorType) {\n  if (!editor) {\n    return null\n  }\n\n  const marks = Editor.marks(editor)\n  const nodesInSelection = getMatchingNodesInSelection(editor, (o) =>\n    Editor.isInline(editor, o)\n  )\n  const editableNodes = getMatchingNodesInSelection(\n    editor,\n    (o) => o.type === 'editable'\n  )\n\n  const marksValue = marks?.color\n  let editablesValue = null\n\n  if (editableNodes?.length) {\n    editablesValue = editableNodes[0].color\n  }\n\n  if (\n    nodesInSelection?.length &&\n    nodesInSelection.every((o) => editableNodes.includes(o))\n  ) {\n    return editablesValue\n  }\n\n  return editableNodes?.length ? editablesValue : marksValue\n}\n\nexport function toggleMarkActiveLegacy(\n  editor: SlateEditorType,\n  format: LeafFormatType\n) {\n  const isActive = isMarkActive(editor, format)\n\n  if (isActive) {\n    Editor.removeMark(editor, format)\n  } else {\n    Editor.addMark(editor, format, true)\n  }\n}\n\nexport function toggleMarkActive(\n  editor: SlateEditorType,\n  format: LeafFormatType\n) {\n  const isActive = isMarkActive(editor, format)\n\n  if (isActive) {\n    Editor.removeMark(editor, format)\n    Transforms.unsetNodes(editor, format, {\n      match: (o) => Editor.isVoid(editor, o) && o.type === 'editable'\n    })\n  } else {\n    Transforms.setNodes(\n      editor,\n      { [format]: true },\n      {\n        match: (o) => Editor.isVoid(editor, o) && o.type === 'editable',\n        hanging: true\n      }\n    )\n    Editor.addMark(editor, format, true)\n  }\n}\n\nexport function toggleColorMarkActive(editor: SlateEditorType, value?: string) {\n  const existingMark = getColorMark(editor)\n\n  if (notNil(existingMark) && areEqualColors(existingMark, value)) {\n    Editor.removeMark(editor, 'color')\n    Transforms.unsetNodes(editor, 'color', {\n      match: (o) => Editor.isVoid(editor, o) && o.type === 'editable'\n    })\n  } else {\n    Transforms.setNodes(\n      editor,\n      { color: value },\n      {\n        match: (o) => Editor.isVoid(editor, o) && o.type === 'editable',\n        hanging: true\n      }\n    )\n    Editor.addMark(editor, 'color', value)\n  }\n}\n\nexport function toggleBlockActive(\n  editor: SlateEditorType,\n  format: ElementFormatType\n) {\n  const isActive = isBlockActive(editor, format)\n\n  if (isActive) {\n    setBlockInactive(editor)\n    return\n  }\n\n  setBlockActive(editor, format)\n}\n\nexport function setBlockActive(\n  editor: SlateEditorType,\n  format: ElementFormatType\n) {\n  const isList = LIST_TYPES.includes(format)\n\n  Transforms.unwrapNodes(editor, {\n    match: (n) =>\n      LIST_TYPES.includes(\n        !Editor.isEditor(n) && SlateElement.isElement(n) && (n.type as any)\n      ),\n    split: true\n  })\n\n  const newProperties: Partial<SlateElement> = {\n    type: isList ? 'list-item' : format\n  }\n\n  Transforms.setNodes(editor, newProperties)\n\n  if (isList) {\n    const block = { type: format, children: [] }\n    Transforms.wrapNodes(editor, block)\n  }\n}\n\nexport function setBlockInactive(editor: SlateEditorType) {\n  Transforms.unwrapNodes(editor, {\n    match: (n) =>\n      LIST_TYPES.includes(\n        !Editor.isEditor(n) && SlateElement.isElement(n) && (n.type as any)\n      ),\n    split: true\n  })\n\n  const newProperties: Partial<SlateElement> = {\n    type: 'paragraph'\n  }\n\n  Transforms.setNodes(editor, newProperties)\n}\n\nexport function focusEditor(editor: SlateEditorType) {\n  ReactEditor.focus(editor as ReactEditor)\n}\n\nexport function composeWithClassName(attributes: any, className?: string) {\n  return {\n    ...attributes,\n    className: classnames(attributes?.className, className)\n  }\n}\n\nexport function composeWithAlignmentClassName(\n  attributes: any,\n  alignment?: BlockAlignment,\n  className?: string\n) {\n  return {\n    ...attributes,\n    className: classnames(attributes?.className, className, {\n      'text-right': alignment === 'right',\n      'text-center': alignment === 'center',\n      'text-justify': alignment === 'justify'\n    })\n  }\n}\n\nexport function composeWithStyle(attributes: any, style: CSSProperties = {}) {\n  return {\n    ...attributes,\n    style: { ...(attributes?.style || {}), ...style }\n  }\n}\n\nexport function getCurrentNode(editor: SlateEditorType) {\n  const selection = editor?.selection\n\n  if (selection !== null && selection.anchor !== null) {\n    const parentNode = editor.children[selection.anchor.path[0]]\n\n    if (LIST_TYPES.includes(parentNode?.type as BlockAlignment)) {\n      return parentNode.children[selection.anchor.path[1]]\n    }\n\n    return parentNode\n  } else {\n    return null\n  }\n}\n\nexport function getAlignment(editor: SlateEditorType): BlockAlignment {\n  const currentNode = getCurrentNode(editor) as any\n  return currentNode?.alignment\n}\n\nexport function setAlignment(editor: SlateEditorType, value?: BlockAlignment) {\n  const alignment = value === 'left' ? null : value\n  const newProperties: Partial<SlateElement> = {\n    alignment\n  }\n\n  Transforms.setNodes(editor, newProperties)\n}\n\nexport function getIndentation(editor: SlateEditorType): number {\n  const currentNode = getCurrentNode(editor) as any\n  return currentNode?.indentation\n}\n\nexport function getIndentationPercent(value: number): string {\n  if (!value) {\n    return null\n  }\n\n  return `${value}%`\n}\n\nexport function increaseIndentation(editor: SlateEditorType) {\n  const currentIndentation = getIndentation(editor) || 0\n  const indentation = clamp(currentIndentation + INDENTATION_FACTOR, 0, 99)\n  const newProperties: Partial<SlateElement> = {\n    indentation\n  }\n\n  Transforms.setNodes(editor, newProperties)\n}\n\nexport function decreaseIndentation(editor: SlateEditorType) {\n  const currentIndentation = getIndentation(editor) || 0\n  const indentation = clamp(currentIndentation - INDENTATION_FACTOR, 0, 99)\n  const newProperties: Partial<SlateElement> = {\n    indentation: indentation === 0 ? null : indentation\n  }\n\n  Transforms.setNodes(editor, newProperties)\n}\n\nexport function composeWithEditable<T extends object>(\n  attributes: T\n): EditableElementType<T> {\n  if (nil(attributes)) {\n    return null\n  }\n\n  return {\n    ...attributes,\n    editable: true,\n    id: generateUUID()\n  }\n}\n\nexport function createEditableNode(\n  attributes: EditableAttributes,\n  isOrphan = false\n) {\n  let editableNode: SlateElement & EditableAttributes = {\n    type: 'editable',\n    ...attributes,\n    children: [{ text: '' }]\n  }\n\n  if (isOrphan) {\n    editableNode.isOrphan = isOrphan\n  }\n\n  editableNode = composeWithEditable(editableNode)\n\n  return editableNode\n}\n\nexport function insertImageBlock(\n  editor: SlateEditorType,\n  attributes: ImageProps,\n  editable?: boolean\n) {\n  const {\n    url,\n    dimensions: { width, height }\n  } = attributes\n\n  let imageNode: SlateElement & ImageElementType = {\n    type: 'image',\n    url,\n    width,\n    height,\n    children: [{ text: '' }]\n  }\n\n  if (editable) {\n    imageNode = composeWithEditable(imageNode)\n  }\n\n  Transforms.insertNodes(editor, imageNode)\n  Transforms.move(editor)\n}\n\nexport function insertEditableBlock(\n  editor: SlateEditorType,\n  attributes: EditableAttributes\n) {\n  const editableNode = createEditableNode(attributes)\n\n  Transforms.insertNodes(editor, editableNode)\n  Transforms.move(editor)\n}\n\nexport function getEditableAttributes(\n  attributes: EditableAttributes,\n  showTip = false\n) {\n  const {\n    dataType,\n    dateTimeFormat,\n    multiline,\n    defaultValue,\n    label,\n    options,\n    tip,\n    valueRef\n  } = attributes\n\n  const parsedAttributes = {\n    dataType,\n    defaultValue\n  } as EditableAttributes\n\n  if (valueRef?.length) {\n    parsedAttributes.valueRef = valueRef\n    return parsedAttributes\n  }\n\n  if (showTip) {\n    parsedAttributes.tip = tip\n  }\n\n  if (dataType === 'text' && multiline) {\n    parsedAttributes.multiline = multiline\n  }\n\n  if (['options', 'radio'].includes(dataType)) {\n    parsedAttributes.options = options\n  }\n\n  if (['date', 'time'].includes(dataType)) {\n    parsedAttributes.dateTimeFormat = dateTimeFormat\n  }\n\n  parsedAttributes.label = label\n\n  return parsedAttributes\n}\n\nexport function getEditableAttributesValidity(\n  attributes: EditableAttributes,\n  showTip = false,\n  copyExisting = false\n): boolean {\n  const {\n    dataType,\n    dateTimeFormat,\n    defaultValue,\n    label,\n    options,\n    tip,\n    valueRef\n  } = attributes\n\n  if (copyExisting) {\n    return !!valueRef?.length && !!defaultValue?.length\n  }\n\n  if (\n    !dataType?.length ||\n    !defaultValue?.length ||\n    !label?.length ||\n    (showTip && !tip.length)\n  ) {\n    return false\n  }\n\n  if (['options', 'radio'].includes(dataType)) {\n    return !!options?.length\n  }\n\n  if (['date', 'time'].includes(dataType)) {\n    return !!dateTimeFormat?.length\n  }\n\n  return true\n}\n\nexport function getMatchingNodes(\n  node: Node,\n  match: (node: Node) => boolean = () => true,\n  matching: Array<Node> = []\n) {\n  if (match(node)) {\n    matching.push(node)\n  }\n\n  const children = node.children as Array<Node>\n\n  if (children?.length) {\n    for (const child of children) {\n      getMatchingNodes(child, match, matching)\n    }\n  }\n\n  return matching\n}\n\nexport function getMatchingNodesInSelection(\n  node: SlateEditorType,\n  match: (node: Node) => boolean = () => true\n) {\n  const generator = Editor.nodes(node, {\n    match\n  })\n\n  return Array.from(generator).map((o) => o[0])\n}\n\nexport function setConditionActive(\n  editor: SlateEditorType,\n  condition: EditableRefAttributes\n) {\n  Editor.addMark(editor, 'ref', condition)\n  Transforms.setNodes(\n    editor,\n    { ref: condition },\n    {\n      match: (o) => Editor.isVoid(editor, o) && o.type === 'editable'\n    }\n  )\n}\n\nexport function unsetConditionActive(editor: SlateEditorType) {\n  Editor.removeMark(editor, 'ref')\n  Transforms.unsetNodes(editor, 'ref', {\n    match: (o) => Editor.isVoid(editor, o) && o.type === 'editable'\n  })\n}\n","import { useState, useCallback, useMemo, MouseEvent, useContext } from 'react'\nimport { useSlate } from 'slate-react'\nimport OrphanNodesContext from '../contexts/orphan-nodes'\nimport {\n  BlockAlignment,\n  getAlignment,\n  getColorMark,\n  HeadingFormatType,\n  isBlockActive,\n  isMarkActive,\n  SlateEditorType\n} from '../tools'\n\ntype PopupActions = {\n  visible: boolean\n  open: Fn\n  close: Fn\n  toggle: Fn\n}\n\nexport type TextSizeValue = {\n  name: HeadingFormatType\n  label: string\n  value: boolean\n}\n\nexport function usePopupUtils(initialOpen: boolean = false): PopupActions {\n  const [visible, setVisible] = useState(initialOpen)\n\n  const handleOpen = useCallback(() => {\n    setVisible(true)\n  }, [])\n\n  const handleClose = useCallback(() => {\n    setVisible(false)\n  }, [])\n\n  const handleToggle = useCallback(() => {\n    setVisible((o) => !o)\n  }, [])\n\n  const popupActions: PopupActions = useMemo(\n    () => ({\n      visible,\n      open: handleOpen,\n      close: handleClose,\n      toggle: handleToggle\n    }),\n    [handleClose, handleOpen, handleToggle, visible]\n  )\n\n  return popupActions\n}\n\nexport function useEditor(): SlateEditorType {\n  return useSlate() as SlateEditorType\n}\n\nexport function useTextSizeValue(): TextSizeValue {\n  const editor = useEditor()\n\n  const headingOneActive = isBlockActive(editor, 'heading-one')\n  const headingTwoActive = isBlockActive(editor, 'heading-two')\n  const headingThreeActive = isBlockActive(editor, 'heading-three')\n\n  const results = useMemo(\n    () =>\n      [\n        { name: 'heading-one', label: 'Heading 1', value: headingOneActive },\n        { name: 'heading-two', label: 'Heading 2', value: headingTwoActive },\n        { name: 'heading-three', label: 'Heading 3', value: headingThreeActive }\n      ] as Array<TextSizeValue>,\n    [headingOneActive, headingThreeActive, headingTwoActive]\n  )\n\n  return results.find((o) => o.value)\n}\n\nexport function useLeafColorValue(): string {\n  const editor = useEditor()\n  return getColorMark(editor)\n}\n\nexport function useAlignmentValue(): BlockAlignment {\n  const editor = useEditor()\n  return getAlignment(editor)\n}\n\nexport function useMouseDown(fn: Fn): (e: MouseEvent) => void {\n  return useCallback(\n    (e: MouseEvent) => {\n      e?.preventDefault()\n      fn?.()\n    },\n    [fn]\n  )\n}\n\nexport function useCanUndo(): boolean {\n  const editor = useEditor()\n  return !!editor.history?.undos?.length\n}\n\nexport function useCanRedo(): boolean {\n  const editor = useEditor()\n  return !!editor.history?.redos?.length\n}\n\nexport function useConditionActive(): boolean {\n  const editor = useEditor()\n  return isMarkActive(editor, 'ref')\n}\n\nexport function useOrphanNodes() {\n  const context = useContext(OrphanNodesContext)\n  return context\n}\n","import React, {\n  Children,\n  cloneElement,\n  FC,\n  memo,\n  PropsWithChildren,\n  ReactElement\n} from 'react'\nimport classnames from 'classnames'\nimport { useMouseDown } from '../../core/hooks'\n\ntype IconProps = PropsWithChildren<{\n  className?: string\n  onPress?: Fn\n}>\n\nconst BaseIcon: FC<IconProps> = ({ children, className, onPress }) => {\n  const handlePress = useMouseDown(onPress)\n  return (\n    <figure\n      onMouseDown={handlePress}\n      className={classnames('flex-shrink-0', className, {\n        's-16': !/\\bs-[0-9]/gi.test(className)\n      })}\n    >\n      {Children.map(children, (child: ReactElement) =>\n        cloneElement(child, {\n          className: classnames(\n            child.props.className,\n            'h-full w-full object-contain object-center m-auto pointer-events-none'\n          )\n        })\n      )}\n    </figure>\n  )\n}\n\nconst Icon = memo(BaseIcon)\n\nexport default Icon\n","import React, { forwardRef, ReactNode, Ref } from 'react'\nimport Icon from '../icon'\nimport classnames from 'classnames'\nimport { useMouseDown } from '../../core/hooks'\n\ntype IconButtonProps = {\n  active?: boolean\n  disabled?: boolean\n  className?: string\n  data?: string\n  onPress?: Fn\n  children?: ReactNode\n}\n\nconst BaseIconButton = (\n  { active, data, disabled, className, children, onPress }: IconButtonProps,\n  ref: Ref<HTMLDivElement>\n) => {\n  const handlePress = useMouseDown(() => {\n    onPress?.(data)\n  })\n\n  return (\n    <div\n      ref={ref}\n      className={classnames(\n        's-32 rounded-default bg-transparent cursor-pointer flex items-center justify-center transition-colors duration-250 hover:bg-blue-100 hover:text-blue-500',\n        {\n          'text-blue-500 bg-blue-highlight': active,\n          'pointer-events-none opacity-50': disabled\n        },\n        className\n      )}\n      onMouseDown={handlePress}\n    >\n      <Icon className='s-20'>{children}</Icon>\n    </div>\n  )\n}\n\nconst IconButton = forwardRef(BaseIconButton)\n\nexport default IconButton\n","import React, { FC } from 'react'\n\nconst IconGroup: FC = ({ children }) => {\n  return <div className='px-16 flex items-center space-x-4'>{children}</div>\n}\n\nexport default IconGroup\n","import classnames from 'classnames'\nimport React, { useLayoutEffect, useState } from 'react'\n\nimport css from './style.module.css'\n\nexport type ContentDimensions = {\n  width?: number\n  height?: number\n  x?: number\n  y?: number\n}\n\ntype ContentProps = {\n  onLayoutUpdate: (dimensions: ContentDimensions) => void\n  x?: number\n  y?: number\n  hideArrow?: boolean\n  position?: string\n  alignment?: string\n  className?: string\n}\n\nconst Content: React.FC<ContentProps> = ({\n  onLayoutUpdate,\n  children,\n  x,\n  y,\n  position,\n  alignment,\n  className,\n  hideArrow\n}) => {\n  const [dimensions, setDimensions] = useState<ContentDimensions>({ x, y })\n\n  useLayoutEffect(() => {\n    const element = document.querySelector(`.${css.container}`)\n    const { width, height, x, y } = element.getBoundingClientRect()\n    const computedDimensions: ContentDimensions = { width, height, x, y }\n\n    if (JSON.stringify(computedDimensions) !== JSON.stringify(dimensions)) {\n      setDimensions(computedDimensions)\n      onLayoutUpdate(computedDimensions)\n    }\n  }, [dimensions, onLayoutUpdate])\n\n  let composedClassName = css.container\n  const arrowClassName = ` ${css.arrow} ${css[`arrow${position}`]} ${\n    css[`arrow${alignment}`]\n  }`\n\n  if (!hideArrow) composedClassName += arrowClassName\n\n  return (\n    <div\n      className={classnames(composedClassName, 'shadow-6', className)}\n      style={{ top: y, left: x }}\n    >\n      {children}\n    </div>\n  )\n}\n\nContent.defaultProps = {\n  x: 0,\n  y: 0\n}\n\nexport default Content\n","import React, {\n  MutableRefObject,\n  useCallback,\n  useEffect,\n  useState\n} from 'react'\nimport { useMouseDown } from '../../core/hooks'\n\nimport Content, { ContentDimensions } from './content'\n\nexport type AnchorRef = MutableRefObject<Element>\n\nexport type PopupPosition = 'up' | 'right' | 'down' | 'left' | 'center'\n\nexport type PopupAlignment = 'start' | 'center' | 'end'\n\ntype PopupOffset = {\n  x: number\n  y: number\n}\n\ntype PopupContentPosition = {\n  x: number\n  y: number\n}\n\ntype PopupProps = {\n  anchor?: string\n  anchorRef?: AnchorRef\n  contentClassName?: string\n  position?: PopupPosition\n  alignment?: PopupAlignment\n  transparent?: boolean\n  distance?: number\n  offsets?: PopupOffset\n  hideArrow?: boolean\n  isVisible?: boolean\n  overlayCloseOnClick?: boolean\n  onRequestClose: () => void\n}\n\nconst EDGE_PADDING = 12\n\nconst getViewportWidth = () =>\n  window.innerWidth ||\n  document.documentElement.clientWidth ||\n  document.body.clientWidth\n\nconst getViewportHeight = () =>\n  window.innerHeight ||\n  document.documentElement.clientHeight ||\n  document.body.clientHeight\n\nconst getPositioningWithoutAnchor = (\n  dimensions: ContentDimensions,\n  position: PopupPosition,\n  alignment: PopupAlignment\n) => {\n  const viewportWidth = getViewportWidth()\n  const viewportHeight = getViewportHeight()\n  const { width, height } = dimensions\n\n  let x: number, y: number\n\n  switch (position) {\n    case 'up':\n      y = 0\n      break\n    case 'down':\n      y = viewportHeight - height\n      break\n    case 'center':\n      y = (viewportHeight - height) / 2\n      break\n    default:\n      y = 0\n      break\n  }\n\n  switch (alignment) {\n    case 'start':\n      x = 0\n      break\n    case 'center':\n      x = (viewportWidth - width) / 2\n      break\n    case 'end':\n      x = viewportWidth - width\n      break\n    default:\n      x = 0\n      break\n  }\n\n  return { x, y }\n}\n\nconst getPositioningWithAnchor = (\n  dimensions: ContentDimensions,\n  anchor: string,\n  anchorRef: AnchorRef,\n  distance: number,\n  position: PopupPosition,\n  alignment: PopupAlignment\n) => {\n  const anchorElement = anchorRef.current || document.querySelector(anchor)\n  if (!anchorElement)\n    return getPositioningWithoutAnchor(dimensions, position, alignment)\n\n  const {\n    width: anchorWidth,\n    height: anchorHeight,\n    x: anchorX,\n    y: anchorY\n  } = anchorElement.getBoundingClientRect()\n  const { width, height } = dimensions\n\n  let x: number, y: number\n\n  if (position === 'up') {\n    y = anchorY - height - distance\n\n    switch (alignment) {\n      case 'start':\n        x = anchorX\n        break\n      case 'center':\n        x = anchorX + anchorWidth / 2 - width / 2\n        break\n      case 'end':\n        x = anchorX + anchorWidth - width\n        break\n      default:\n        break\n    }\n  }\n\n  if (position === 'down') {\n    y = anchorY + anchorHeight + distance\n\n    switch (alignment) {\n      case 'start':\n        x = anchorX\n        break\n      case 'center':\n        x = anchorX + anchorWidth / 2 - width / 2\n        break\n      case 'end':\n        x = anchorX + anchorWidth - width\n        break\n      default:\n        break\n    }\n  }\n\n  if (position === 'left') {\n    x = anchorX - width - distance\n\n    switch (alignment) {\n      case 'start':\n        y = anchorY\n        break\n      case 'center':\n        y = anchorY + anchorHeight / 2 - height / 2\n        break\n      case 'end':\n        y = anchorY + anchorHeight - height\n        break\n      default:\n        break\n    }\n  }\n\n  if (position === 'right') {\n    x = anchorX + anchorWidth + distance\n\n    switch (alignment) {\n      case 'start':\n        y = anchorY\n        break\n      case 'center':\n        y = anchorY + anchorHeight / 2 - height / 2\n        break\n      case 'end':\n        y = anchorY + anchorHeight - height\n        break\n      default:\n        break\n    }\n  }\n\n  return { x, y }\n}\n\nconst getValidPositioning = (\n  dimensions: ContentDimensions,\n  anchor: string,\n  anchorRef: AnchorRef,\n  distance: number,\n  position: PopupPosition,\n  alignment: PopupAlignment,\n  offsets: PopupOffset\n) => {\n  const { width, height } = dimensions\n  const viewportWidth = getViewportWidth()\n  const viewportHeight = getViewportHeight()\n  let contentPosition: PopupContentPosition\n\n  if (!!anchor || !!anchorRef) {\n    contentPosition = getPositioningWithAnchor(\n      dimensions,\n      anchor,\n      anchorRef,\n      distance,\n      position,\n      alignment\n    )\n  } else {\n    contentPosition = getPositioningWithoutAnchor(\n      dimensions,\n      position,\n      alignment\n    )\n  }\n\n  if (offsets) {\n    const xOffset = offsets.x || 0\n    const yOffset = offsets.y || 0\n\n    contentPosition.x = contentPosition.x + xOffset\n    contentPosition.y = contentPosition.y + yOffset\n  }\n\n  const leftEdge = EDGE_PADDING\n  const topEdge = EDGE_PADDING\n  const rightEdge = viewportWidth - width\n  const bottomEdge = viewportHeight - height\n\n  if (contentPosition.x <= leftEdge) contentPosition.x = leftEdge\n  if (contentPosition.y <= topEdge) contentPosition.y = topEdge\n  if (contentPosition.x >= rightEdge) contentPosition.x = rightEdge\n  if (contentPosition.y >= bottomEdge) contentPosition.y = bottomEdge\n\n  return contentPosition\n}\n\nconst Popup: React.FC<PopupProps> = ({\n  anchor,\n  anchorRef,\n  children,\n  contentClassName,\n  position,\n  alignment,\n  transparent,\n  distance,\n  offsets,\n  isVisible,\n  hideArrow,\n  overlayCloseOnClick,\n  onRequestClose\n}) => {\n  const [\n    popupContentPosition,\n    setPopupContentPosition\n  ] = useState<PopupContentPosition>({\n    x: 0,\n    y: 0\n  })\n\n  const handleClickOverlay = useMouseDown(() => {\n    if (overlayCloseOnClick) onRequestClose()\n  })\n\n  const handleKeyUp = useCallback(\n    (e: KeyboardEvent) => {\n      if (e.key === 'Escape' && isVisible) onRequestClose()\n    },\n    [isVisible, onRequestClose]\n  )\n\n  useEffect(() => {\n    document.addEventListener('keyup', handleKeyUp)\n\n    return () => {\n      document.removeEventListener('keyup', handleKeyUp)\n    }\n  }, [isVisible, handleKeyUp])\n\n  if (!isVisible) return null\n\n  return (\n    <div className='fixed top-0 left-0 w-full h-full z-2'>\n      <div\n        className={\n          transparent\n            ? 'w-full h-full absolute top-0 left-0 z-0'\n            : 'w-full h-full absolute top-0 left-0 z-0 bg-blue-800 opacity-50'\n        }\n        onMouseDown={handleClickOverlay}\n      />\n      <Content\n        className={contentClassName}\n        x={popupContentPosition.x}\n        y={popupContentPosition.y}\n        position={position}\n        alignment={alignment}\n        hideArrow={(!anchorRef && !anchor) || hideArrow}\n        onLayoutUpdate={(dimensions) =>\n          setPopupContentPosition(\n            getValidPositioning(\n              dimensions,\n              anchor,\n              anchorRef,\n              distance,\n              position,\n              alignment,\n              offsets\n            )\n          )\n        }\n      >\n        {children}\n      </Content>\n    </div>\n  )\n}\n\nPopup.defaultProps = {\n  position: 'center',\n  alignment: 'center',\n  transparent: false,\n  distance: 10,\n  overlayCloseOnClick: true,\n  hideArrow: false,\n  isVisible: false\n}\n\nexport default Popup\n","import React, {\n  FC,\n  MutableRefObject,\n  PropsWithChildren,\n  useCallback\n} from 'react'\nimport Popup from '../../popup'\nimport classnames from 'classnames'\nimport { HeadingFormatType } from '../../../core/tools'\nimport { nil } from '../../../core/utils'\nimport { useMouseDown } from '../../../core/hooks'\n\ntype TextSizePopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  value: HeadingFormatType\n  onPressOption?: (value: HeadingFormatType) => void\n  onRequestClose: Fn\n}\n\ntype TextSizeOptionProps = PropsWithChildren<{\n  active?: boolean\n  onPress?: Fn\n}>\n\nconst TextSizeOption: FC<TextSizeOptionProps> = ({\n  active,\n  children,\n  onPress\n}) => {\n  const handlePress = useMouseDown(onPress)\n\n  return (\n    <div\n      className={classnames(\n        'cursor-pointer h-40 px-20 flex items-center font-medium bg-transparent transition-colors duration-250 hover:bg-blue-100 hover:text-blue-500',\n        {\n          'text-blue-500 bg-blue-highlight': active\n        }\n      )}\n      onMouseDown={handlePress}\n    >\n      {children}\n    </div>\n  )\n}\n\nconst TextSizePopup: FC<TextSizePopupProps> = ({\n  anchorRef,\n  isVisible,\n  value,\n  onPressOption,\n  onRequestClose\n}) => {\n  const handlePressOption = useCallback(\n    (option?: HeadingFormatType) => {\n      onPressOption?.(option)\n      onRequestClose?.()\n    },\n    [onPressOption, onRequestClose]\n  )\n\n  return (\n    <Popup\n      position='down'\n      alignment='start'\n      isVisible={isVisible}\n      onRequestClose={onRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default w-144 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        <TextSizeOption active={nil(value)} onPress={() => handlePressOption()}>\n          <span className='-ml-1'>Normal</span>\n        </TextSizeOption>\n        <TextSizeOption\n          active={value === 'heading-three'}\n          onPress={() => handlePressOption('heading-three')}\n        >\n          <span className='text-headline -ml-1'>Heading 3</span>\n        </TextSizeOption>\n        <TextSizeOption\n          active={value === 'heading-two'}\n          onPress={() => handlePressOption('heading-two')}\n        >\n          <span className='text-heading-3 -ml-1'>Heading 2</span>\n        </TextSizeOption>\n        <TextSizeOption\n          active={value === 'heading-one'}\n          onPress={() => handlePressOption('heading-one')}\n        >\n          <span className='text-heading-2 -ml-1'>Heading 1</span>\n        </TextSizeOption>\n      </div>\n    </Popup>\n  )\n}\n\nexport default TextSizePopup\n","import React, {\n  FC,\n  memo,\n  MutableRefObject,\n  useCallback,\n  useState,\n  ChangeEvent\n} from 'react'\nimport Popup from '../../popup'\nimport css from './style.module.css'\nimport classnames from 'classnames'\nimport { areEqualColors, isHexColor } from '../../../core/utils'\nimport { useMouseDown } from '../../../core/hooks'\nimport { PRESET_COLORS } from '../../../core/constants'\n\ntype ColorPopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  value?: string\n  onChangeColorOption?: (value?: string, focus?: boolean) => void\n  onRequestClose: Fn\n}\n\ntype ColorBoxProps = {\n  active?: boolean\n  color: string\n  onPress?: (value: string) => void\n}\n\nconst BaseColorBox: FC<ColorBoxProps> = ({ active, color, onPress }) => {\n  const handlePress = useMouseDown(() => {\n    onPress?.(color)\n  })\n\n  return (\n    <div\n      style={{ color }}\n      onMouseDown={handlePress}\n      title={color}\n      className={classnames(\n        's-32 rounded-default bg-current cursor-pointer transition-shadow duration-250',\n        css['color-box'],\n        { [css.active]: active }\n      )}\n    />\n  )\n}\n\nconst ColorBox = memo(BaseColorBox)\n\nconst ColorPopup: FC<ColorPopupProps> = ({\n  anchorRef,\n  isVisible,\n  value,\n  onChangeColorOption,\n  onRequestClose\n}) => {\n  const [colorState, setColorState] = useState('')\n\n  const handlePressColorOption = useCallback(\n    (option: string) => {\n      if (!isHexColor(option)) {\n        return\n      }\n\n      const selectedColor = areEqualColors(value, option) ? null : option\n\n      setColorState(selectedColor?.replaceAll('#', ''))\n      onChangeColorOption?.(selectedColor)\n      onRequestClose?.()\n    },\n    [onChangeColorOption, onRequestClose, value]\n  )\n\n  const handleChangeInput = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      const inputValue = e.target.value\n      const parsedColor = inputValue?.length\n        ? `#${inputValue.replace('#', '')}`\n        : null\n\n      setColorState(e.target.value)\n\n      if (isHexColor(parsedColor)) {\n        onChangeColorOption?.(parsedColor, false)\n      }\n    },\n    [onChangeColorOption]\n  )\n\n  return (\n    <Popup\n      position='down'\n      alignment='start'\n      isVisible={isVisible}\n      onRequestClose={onRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default grid grid-cols-7 gap-6 p-8 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        {PRESET_COLORS.map((o) => (\n          <ColorBox\n            color={o}\n            key={o}\n            onPress={handlePressColorOption}\n            active={areEqualColors(value, o)}\n          />\n        ))}\n        <div className='h-32 col-span-4 overflow-hidden rounded-default border border-gray-200 flex items-center justify-start'>\n          <div className='flex s-32 rounded-default rounded-r-none rounded-b-none bg-gray-200 text-gray-500 items-center justify-center font-semibold'>\n            #\n          </div>\n          <input\n            maxLength={6}\n            className={classnames(\n              'border-none h-full px-6 bg-transparent font-medium',\n              css.input\n            )}\n            type='text'\n            placeholder={value?.replace('#', '')}\n            value={colorState}\n            onChange={handleChangeInput}\n          />\n        </div>\n      </div>\n    </Popup>\n  )\n}\n\nexport default ColorPopup\n","// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","import React, {\n  ChangeEvent,\n  FC,\n  MutableRefObject,\n  useCallback,\n  useMemo,\n  useState\n} from 'react'\nimport Popup from '../../popup'\nimport { BiLink } from '@react-icons/all-files/bi/BiLink'\nimport Icon from '../../icon'\nimport Button from '../../button'\nimport { getImageSizeAsync, ImageDimensions, nil } from '../../../core/utils'\n\nexport type ImageProps = {\n  url?: string\n  dimensions: ImageDimensions\n}\n\ntype ImagePopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  onRequestClose: Fn\n  onSubmitEditing?: (value: ImageProps) => void\n}\n\nconst ImagePopup: FC<ImagePopupProps> = ({\n  anchorRef,\n  isVisible,\n  onRequestClose,\n  onSubmitEditing\n}) => {\n  const [imageState, setImageState] = useState('')\n  const [scaleState, setScaleState] = useState('100')\n  const [imageDimensions, setImageDimensions] = useState<ImageDimensions>()\n\n  const decimalScale = useMemo(() => {\n    const value = parseFloat(scaleState)\n    const normalized = isNaN(value) || value < 1 ? 1 : value\n    return normalized / 100\n  }, [scaleState])\n\n  const handleChangeImageUrl = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      setImageState(e.target.value)\n    },\n    []\n  )\n\n  const handleChangeScale = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setScaleState(e.target.value)\n  }, [])\n\n  const handleBlurImageInput = useCallback(async () => {\n    if (!imageState?.length) {\n      setImageDimensions(null)\n      return\n    }\n\n    try {\n      const dimensions = await getImageSizeAsync(imageState)\n      setImageDimensions(dimensions)\n    } catch (error) {\n      setImageDimensions(null)\n    }\n  }, [imageState])\n\n  const handleRequestClose = useCallback(() => {\n    setImageState('')\n    setScaleState('100')\n    setImageDimensions(null)\n    onRequestClose?.()\n  }, [onRequestClose])\n\n  const handlePressSubmit = useCallback(() => {\n    onSubmitEditing?.({\n      url: imageState,\n      dimensions: {\n        width: imageDimensions.width * decimalScale,\n        height: imageDimensions.height * decimalScale\n      }\n    })\n    handleRequestClose()\n  }, [\n    decimalScale,\n    handleRequestClose,\n    imageDimensions,\n    imageState,\n    onSubmitEditing\n  ])\n\n  return (\n    <Popup\n      position='down'\n      alignment='start'\n      isVisible={isVisible}\n      onRequestClose={handleRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default p-8 w-296 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        <div className='flex items-center justify-between space-x-4 mb-8'>\n          <div className='h-32 flex-1 overflow-hidden rounded-default border border-gray-200 flex items-center justify-start'>\n            <div className='flex s-32 rounded-default rounded-r-none rounded-b-none bg-gray-200 text-gray-500 items-center justify-center font-semibold'>\n              <Icon>\n                <BiLink />\n              </Icon>\n            </div>\n            <input\n              className='border-none h-full px-6 bg-transparent font-medium flex-1 min-w-0'\n              type='text'\n              placeholder='https://www...'\n              value={imageState}\n              onChange={handleChangeImageUrl}\n              onBlur={handleBlurImageInput}\n            />\n          </div>\n          <div className='h-32 overflow-hidden rounded-default border border-gray-200 flex items-center justify-start'>\n            <input\n              maxLength={3}\n              className='border-none h-full w-40 px-6 bg-transparent font-medium m-0'\n              placeholder='0'\n              value={scaleState}\n              onChange={handleChangeScale}\n            />\n            <div className='flex s-32 bg-transparent text-gray-300 items-center justify-center font-semibold'>\n              %\n            </div>\n          </div>\n        </div>\n        <div className='flex justify-end'>\n          <Button\n            disabled={nil(imageDimensions)}\n            className='h-32'\n            onPress={handlePressSubmit}\n          >\n            Insert\n          </Button>\n        </div>\n      </div>\n    </Popup>\n  )\n}\n\nexport default ImagePopup\n","import React, {\n  ChangeEvent,\n  FC,\n  MutableRefObject,\n  useCallback,\n  useState\n} from 'react'\nimport { ImageDimensions, notNil, parseNumber } from '../../../core/utils'\nimport Button from '../../button'\nimport Popup from '../../popup'\nimport { TiTimes } from '@react-icons/all-files/ti/TiTimes'\nimport Icon from '../../icon'\n\ntype ImageSizePopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  onRequestClose: Fn\n  onSubmitEditing?: (value: ImageDimensions) => void\n}\n\nconst ImageSizePopup: FC<ImageSizePopupProps> = ({\n  anchorRef,\n  isVisible,\n  onRequestClose,\n  onSubmitEditing\n}) => {\n  const [width, setWidth] = useState(100)\n  const [height, setHeight] = useState(100)\n\n  const isValid = notNil(width) && notNil(height) && width * height > 0\n\n  const handleChangeWidth = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setWidth(parseNumber(e.target.value))\n  }, [])\n\n  const handleChangeHeight = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setWidth(parseNumber(e.target.value))\n  }, [])\n\n  const handleRequestClose = useCallback(() => {\n    setWidth(100)\n    setHeight(100)\n    onRequestClose?.()\n  }, [onRequestClose])\n\n  const handlePressSubmit = useCallback(() => {\n    onSubmitEditing?.({\n      width,\n      height\n    })\n    handleRequestClose()\n  }, [handleRequestClose, height, onSubmitEditing, width])\n\n  return (\n    <Popup\n      position='down'\n      alignment='start'\n      isVisible={isVisible}\n      onRequestClose={handleRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default p-8 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        <div className='flex items-center justify-between space-x-4 mb-8'>\n          <div className='h-32 overflow-hidden rounded-default border border-gray-200 flex items-center justify-start'>\n            <input\n              className='border-none h-full w-40 px-6 bg-transparent font-medium m-0'\n              placeholder='0'\n              value={width}\n              onChange={handleChangeWidth}\n            />\n            <div className='flex s-32 bg-transparent text-gray-300 items-center justify-center text-subhead font-semibold'>\n              PX\n            </div>\n          </div>\n          <Icon>\n            <TiTimes />\n          </Icon>\n          <div className='h-32 overflow-hidden rounded-default border border-gray-200 flex items-center justify-start'>\n            <input\n              className='border-none h-full w-40 px-6 bg-transparent font-medium m-0'\n              placeholder='0'\n              value={height}\n              onChange={handleChangeHeight}\n            />\n            <div className='flex s-32 bg-transparent text-gray-300 items-center justify-center text-subhead font-semibold'>\n              PX\n            </div>\n          </div>\n        </div>\n        <div className='flex justify-end'>\n          <Button\n            disabled={!isValid}\n            className='h-32'\n            onPress={handlePressSubmit}\n          >\n            Insert\n          </Button>\n        </div>\n      </div>\n    </Popup>\n  )\n}\n\nexport default ImageSizePopup\n","import React, { MouseEvent, FC, memo } from 'react'\nimport classnames from 'classnames'\n\ntype SegmentedControlProps = {\n  className?: string\n  value: number\n  options: Array<string>\n  onChangeValue: (value: number) => void\n}\n\nconst BaseSegmentedControl: FC<SegmentedControlProps> = ({\n  className,\n  value,\n  options,\n  onChangeValue\n}) => {\n  const handlePressOption = (e: MouseEvent, index: number) => {\n    e.preventDefault()\n    onChangeValue?.(index)\n  }\n\n  return (\n    <div\n      className={classnames(\n        'bg-gray-100 rounded-full p-4 w-296 h-40 flex items-center relative',\n        className\n      )}\n    >\n      <div\n        className='absolute bg-gray-500 rounded-full z-0 top-4 h-32 transition-all duration-500'\n        style={{ width: 144, left: 144 * value + 4 }}\n      />\n      {options.map((o, i) => (\n        <div\n          className={classnames(\n            'font-medium flex-1 flex items-center justify-center relative z-1 cursor-pointer transition-colors duration-500',\n            {\n              'text-gray-500 hover:text-gray-700': value !== i,\n              'text-white': value === i\n            }\n          )}\n          key={i}\n          onMouseDown={(e) => handlePressOption(e, i)}\n        >\n          {o}\n        </div>\n      ))}\n    </div>\n  )\n}\n\nconst SegmentedControl = memo(BaseSegmentedControl)\n\nexport default SegmentedControl\n","import React, {\n  Children,\n  cloneElement,\n  FC,\n  PropsWithChildren,\n  ReactElement\n} from 'react'\nimport classnames from 'classnames'\n\ntype FieldProps = PropsWithChildren<{\n  label?: string\n  className?: string\n}>\n\nconst Field: FC<FieldProps> = ({ className, children, label }) => {\n  return (\n    <div className={className}>\n      {!!label?.length && (\n        <label className='text-blue-500 block mb-4 text-subhead font-medium'>\n          {label}\n        </label>\n      )}\n      {Children.map(children, (child: ReactElement) =>\n        cloneElement(child, {\n          className: classnames(\n            child.props.className,\n            'w-full appearance-none border border-gray-200 rounded-default h-32 px-8 transition:colors transition:shadow duration-250 focus:border-blue-500 focus:shadow-outline'\n          )\n        })\n      )}\n    </div>\n  )\n}\n\nexport default Field\n","import React, { ChangeEvent, FC, useCallback, useMemo, useState } from 'react'\nimport { useEditor, useOrphanNodes } from '../../../../core/hooks'\nimport {\n  EditableAttributes,\n  EditableElementType,\n  getEditableAttributes,\n  getEditableAttributesValidity,\n  getMatchingNodes\n} from '../../../../core/tools'\nimport Button from '../../../button'\nimport Field from '../../../field'\n\ntype EditableCopyExistingProps = {\n  onSubmit?: (attributes: EditableAttributes) => void\n}\n\nconst EditableCopyExisting: FC<EditableCopyExistingProps> = ({ onSubmit }) => {\n  const editor = useEditor()\n  const [orphanNodes] = useOrphanNodes()\n  const editableNodes = useMemo(\n    () =>\n      getMatchingNodes(\n        editor,\n        (o) => o.type === 'editable' && !(o.valueRef as string)?.length\n      )\n        .concat(orphanNodes)\n        .map((o) => o as EditableElementType<EditableAttributes>),\n    [editor, orphanNodes]\n  )\n\n  const [valueRef, setValueRef] = useState('')\n  const [defaultValue, setDefaultValue] = useState('')\n  const dataType = useMemo(\n    () => editableNodes?.find((o) => o.id === valueRef)?.dataType,\n    [editableNodes, valueRef]\n  )\n\n  const isValid = useMemo(\n    () =>\n      getEditableAttributesValidity(\n        { valueRef, defaultValue, dataType },\n        false,\n        true\n      ),\n    [dataType, defaultValue, valueRef]\n  )\n\n  const handleChangeValueRef = useCallback(\n    (e: ChangeEvent<HTMLSelectElement>) => {\n      const value = e.target.value\n\n      if (value === valueRef) {\n        return\n      }\n\n      setValueRef(value)\n      setDefaultValue(\n        editableNodes.find((o) => o.id === value)?.defaultValue || ''\n      )\n    },\n    [editableNodes, valueRef]\n  )\n\n  const handleChangeDefaultValue = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      setDefaultValue(e.target.value)\n    },\n    []\n  )\n\n  const handlePressSubmit = useCallback(() => {\n    const data = getEditableAttributes({ valueRef, defaultValue, dataType })\n\n    onSubmit?.(data)\n  }, [dataType, defaultValue, onSubmit, valueRef])\n\n  return (\n    <div>\n      <Field label='Copy from' className='mb-18'>\n        <select value={valueRef} onChange={handleChangeValueRef}>\n          <option hidden value=''>\n            Choose one\n          </option>\n          {editableNodes.map((o) => (\n            <option key={o.id} value={o.id}>\n              {o.defaultValue}({o.label})\n            </option>\n          ))}\n        </select>\n      </Field>\n      <Field label='Default value' className='mb-18'>\n        <input\n          value={defaultValue}\n          onChange={handleChangeDefaultValue}\n          placeholder='Default'\n        />\n      </Field>\n      <div className='flex justify-end pt-24'>\n        <Button\n          disabled={!isValid}\n          className='h-32'\n          onPress={handlePressSubmit}\n        >\n          Insert\n        </Button>\n      </div>\n    </div>\n  )\n}\n\nexport default EditableCopyExisting\n","import React, { FC, memo } from 'react'\nimport ReactSwitch from 'react-switch'\n\ntype SwitchProps = {\n  className?: string\n  value: boolean\n  onChangeValue: (value: boolean) => void\n}\n\nconst BaseSwitch: FC<SwitchProps> = ({ className, value, onChangeValue }) => {\n  return (\n    <ReactSwitch\n      checked={value}\n      className={className}\n      onChange={onChangeValue}\n      offColor='#ADC5FA'\n      onColor='#326FF3'\n      checkedIcon={false}\n      uncheckedIcon={false}\n      handleDiameter={18}\n      height={22}\n      width={44}\n      activeBoxShadow='0 0 0 4px rgba(103, 126, 138, 0.125)'\n    />\n  )\n}\n\nconst Switch = memo(BaseSwitch)\n\nexport default Switch\n","import React, {\n  ChangeEvent,\n  FC,\n  useCallback,\n  useMemo,\n  useRef,\n  useState,\n  KeyboardEvent\n} from 'react'\nimport Button from '../../../button'\nimport Field from '../../../field'\nimport Switch from '../../../switch'\nimport { FaRegTrashAlt } from '@react-icons/all-files/fa/FaRegTrashAlt'\nimport { AiFillPlusCircle } from '@react-icons/all-files/ai/AiFillPlusCircle'\nimport Icon from '../../../icon'\nimport {\n  EditableAttributes,\n  EditableDataType,\n  EditableOption,\n  getEditableAttributes,\n  getEditableAttributesValidity\n} from '../../../../core/tools'\nimport {\n  DATE_FORMATS,\n  EDITABLE_DATA_TYPES,\n  TIME_FORMATS\n} from '../../../../core/constants'\nimport { formatDate, generateUUID } from '../../../../core/utils'\n\ntype EditableCreateNewProps = {\n  onSubmit?: (attributes: EditableAttributes, isOrphan?: boolean) => void\n}\n\nconst EditableCreateNew: FC<EditableCreateNewProps> = ({ onSubmit }) => {\n  const now = useRef(new Date()).current\n  const dataTypeOptions = useRef(Object.entries(EDITABLE_DATA_TYPES)).current\n  const dateFormatOptions = useRef(DATE_FORMATS.map((o) => formatDate(now, o)))\n    .current\n  const timeFormatOptions = useRef(TIME_FORMATS.map((o) => formatDate(now, o)))\n    .current\n\n  const [dataType, setDataType] = useState<EditableDataType>(\n    '' as EditableDataType\n  )\n  const [defaultValue, setDefaultValue] = useState('')\n  const [dateTimeFormat, setDateTimeFormat] = useState('')\n  const [label, setLabel] = useState('')\n  const [multiline, setMultiline] = useState(false)\n  const [options, setOptions] = useState<Array<EditableOption>>([])\n  const [editingOption, setEditingOption] = useState('')\n  const [showTip, setShowTip] = useState(false)\n  const [isOrphan, setIsOrphan] = useState(false)\n  const [tip, setTip] = useState('')\n\n  const isValid = useMemo(\n    () =>\n      getEditableAttributesValidity(\n        {\n          dataType,\n          dateTimeFormat,\n          defaultValue,\n          label,\n          options,\n          tip\n        },\n        showTip\n      ),\n    [dataType, dateTimeFormat, defaultValue, label, options, showTip, tip]\n  )\n\n  const handlePressDeleteOption = useCallback(\n    (id: string) => {\n      const eventualValue = [...options]\n      const index = eventualValue.findIndex((o) => o.id === id)\n\n      if (~index) {\n        eventualValue.splice(index, 1)\n        setOptions(eventualValue)\n      }\n    },\n    [options]\n  )\n\n  const handlePressAddOption = useCallback(() => {\n    const label = editingOption?.trim()\n\n    if (!label?.length) {\n      return\n    }\n\n    const id = generateUUID()\n\n    setOptions((groundValue) => [...groundValue, { id, label }])\n    setEditingOption('')\n  }, [editingOption])\n\n  const handleEditingOptionKeydown = useCallback(\n    (e: KeyboardEvent) => {\n      if (e.key?.toLowerCase() === 'enter') {\n        e.preventDefault()\n        handlePressAddOption()\n      }\n    },\n    [handlePressAddOption]\n  )\n\n  const handlePressSubmit = useCallback(() => {\n    const data = getEditableAttributes(\n      {\n        dataType,\n        dateTimeFormat,\n        multiline,\n        defaultValue,\n        label,\n        options,\n        tip\n      },\n      showTip\n    )\n\n    onSubmit?.(data, isOrphan)\n  }, [\n    dataType,\n    dateTimeFormat,\n    defaultValue,\n    isOrphan,\n    label,\n    multiline,\n    onSubmit,\n    options,\n    showTip,\n    tip\n  ])\n\n  const handleChangeDataType = useCallback(\n    (e: ChangeEvent<HTMLSelectElement>) => {\n      const value = e.target.value as EditableDataType\n\n      if (value === dataType) {\n        return\n      }\n\n      setDataType(value)\n\n      if (value === 'date' || value === 'time') {\n        setDateTimeFormat('')\n      }\n    },\n    [dataType]\n  )\n\n  const handleChangeDateTimeFormat = useCallback(\n    (e: ChangeEvent<HTMLSelectElement>) => {\n      setDateTimeFormat(e.target.value)\n    },\n    []\n  )\n\n  const handleChangeEditingOption = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      setEditingOption(e.target.value)\n    },\n    []\n  )\n\n  const handleChangeLabel = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setLabel(e.target.value)\n  }, [])\n\n  const handleChangeDefaultValue = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      setDefaultValue(e.target.value)\n    },\n    []\n  )\n\n  const handleChangeTip = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setTip(e.target.value)\n  }, [])\n\n  return (\n    <div>\n      <div className='flex items-end space-x-12 mb-18'>\n        <Field label='Type' className='flex-1'>\n          <select value={dataType} onChange={handleChangeDataType}>\n            <option hidden value=''>\n              Choose one\n            </option>\n            {dataTypeOptions.map(([value, label]) => (\n              <option key={value} value={value}>\n                {label}\n              </option>\n            ))}\n          </select>\n        </Field>\n        {dataType === 'text' && (\n          <div className='flex flex-1 justify-start items-center space-x-8 pb-6'>\n            <div>Multiline</div>\n            <Switch value={multiline} onChangeValue={setMultiline} />\n          </div>\n        )}\n        {dataType === 'date' && (\n          <Field label='Date format'>\n            <select\n              value={dateTimeFormat}\n              onChange={handleChangeDateTimeFormat}\n            >\n              <option hidden value=''>\n                Choose a format\n              </option>\n              {dateFormatOptions.map((o) => (\n                <option key={o} value={o}>\n                  {o}\n                </option>\n              ))}\n            </select>\n          </Field>\n        )}\n        {dataType === 'time' && (\n          <Field label='Time format'>\n            <select\n              value={dateTimeFormat}\n              onChange={handleChangeDateTimeFormat}\n            >\n              <option hidden value=''>\n                Choose a format\n              </option>\n              {timeFormatOptions.map((o) => (\n                <option key={o} value={o}>\n                  {o}\n                </option>\n              ))}\n            </select>\n          </Field>\n        )}\n      </div>\n      {['radio', 'options'].includes(dataType) && (\n        <div className='mb-18'>\n          <div className='text-blue-500 block mb-4 text-subhead font-medium'>\n            Options\n          </div>\n          <div className='space-y-6'>\n            {options?.map((o) => (\n              <div\n                key={o.id}\n                onClick={() => handlePressDeleteOption(o.id)}\n                className='flex items-center justify-between px-8 h-32 w-full border border-gray-200 bg-gray-100 rounded-default'\n              >\n                <span className='text-gray-500'>{o.label}</span>\n                <Icon className='cursor-pointer text-gray-500 transition-colors duration-250'>\n                  <FaRegTrashAlt />\n                </Icon>\n              </div>\n            ))}\n            <div className='flex items-center justify-between px-8 h-32 w-full border border-gray-200 rounded-default transition:colors transition:shadow duration-250 focus-within:shadow-outline focus-within:border-blue-500'>\n              <input\n                value={editingOption}\n                className='border-none h-full w-full bg-transparent m-0'\n                placeholder='+ Add an option'\n                onChange={handleChangeEditingOption}\n                onKeyDown={handleEditingOptionKeydown}\n              />\n              <Icon\n                onPress={handlePressAddOption}\n                className='cursor-pointer text-blue-500 transition-colors duration-250 hover:text-blue-600'\n              >\n                <AiFillPlusCircle />\n              </Icon>\n            </div>\n          </div>\n        </div>\n      )}\n      <Field label='Label' className='mb-18'>\n        <input\n          value={label}\n          onChange={handleChangeLabel}\n          placeholder='Question label'\n        />\n      </Field>\n      <Field label='Default value' className='mb-18'>\n        <input\n          value={defaultValue}\n          onChange={handleChangeDefaultValue}\n          placeholder='Default'\n        />\n      </Field>\n      <div className='flex flex-1 justify-between items-center mb-18'>\n        <div>Show description</div>\n        <Switch value={showTip} onChangeValue={setShowTip} />\n      </div>\n      {showTip && (\n        <Field label='Description' className='mb-18'>\n          <input\n            value={tip}\n            onChange={handleChangeTip}\n            placeholder='Lorem ipsum...'\n          />\n        </Field>\n      )}\n      <div className='flex flex-1 justify-between items-center mb-18'>\n        <div>Save in Icebox</div>\n        <Switch value={isOrphan} onChangeValue={setIsOrphan} />\n      </div>\n      <div className='flex justify-end pt-24'>\n        <Button\n          disabled={!isValid}\n          onPress={handlePressSubmit}\n          className='h-32'\n        >\n          Insert\n        </Button>\n      </div>\n    </div>\n  )\n}\n\nexport default EditableCreateNew\n","import React, { FC, useCallback, useState } from 'react'\nimport { EditableAttributes } from '../../../core/tools'\nimport Popup from '../../popup'\nimport SegmentedControl from '../../segmented-control'\nimport EditableCopyExisting from './copy-existing'\nimport EditableCreateNew from './create-new'\n\ntype EditablePopupProps = {\n  isVisible: boolean\n  onRequestClose: Fn\n  onSubmit: (attributes: EditableAttributes, isOrphan?: boolean) => void\n}\n\nconst EditablePopupProps: FC<EditablePopupProps> = ({\n  isVisible,\n  onRequestClose,\n  onSubmit\n}) => {\n  const [segment, setSegment] = useState(0)\n\n  const handleSubmit = useCallback(\n    (attributes: EditableAttributes, isOrphan = false) => {\n      onSubmit?.(attributes, isOrphan)\n      onRequestClose?.()\n      setSegment(0)\n    },\n    [onRequestClose, onSubmit]\n  )\n\n  return (\n    <Popup\n      position='center'\n      alignment='center'\n      isVisible={isVisible}\n      onRequestClose={onRequestClose}\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default w-480 py-12 px-16 bg-white border border-gray-300 overflow-hidden'>\n        <div className='flex items-center justify-center mb-28'>\n          <SegmentedControl\n            value={segment}\n            onChangeValue={setSegment}\n            options={['Create new', 'Copy existing']}\n          />\n        </div>\n        {segment === 0 && <EditableCreateNew onSubmit={handleSubmit} />}\n        {segment === 1 && <EditableCopyExisting onSubmit={handleSubmit} />}\n      </div>\n    </Popup>\n  )\n}\n\nexport default EditablePopupProps\n","import React, {\n  ChangeEvent,\n  FC,\n  MutableRefObject,\n  useCallback,\n  useMemo,\n  useState\n} from 'react'\nimport { useEditor, useOrphanNodes } from '../../../core/hooks'\nimport {\n  EditableAttributes,\n  EditableElementType,\n  EditableRefAttributes,\n  getMatchingNodes\n} from '../../../core/tools'\nimport Button from '../../button'\nimport Field from '../../field'\nimport Popup from '../../popup'\n\ntype ConditionPopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  onRequestClose: Fn\n  onSubmitEditing?: (value: EditableRefAttributes) => void\n}\n\nconst ConditionPopup: FC<ConditionPopupProps> = ({\n  anchorRef,\n  isVisible,\n  onRequestClose,\n  onSubmitEditing\n}) => {\n  const editor = useEditor()\n  const [orphanNodes] = useOrphanNodes()\n  const editableNodes = getMatchingNodes(\n    editor,\n    (o) =>\n      o.type === 'editable' &&\n      !(o.valueRef as string)?.length &&\n      ['options', 'radio'].includes(o.dataType as string)\n  )\n    .concat(orphanNodes)\n    .map((o) => o as EditableElementType<EditableAttributes>)\n\n  const [parent, setParent] = useState('')\n  const [value, setValue] = useState('')\n  const options = useMemo(\n    () => editableNodes.find((o) => o.id === parent)?.options || [],\n    [editableNodes, parent]\n  )\n\n  const isValid = !!parent?.length && !!value?.length\n\n  const handleChangeParent = useCallback(\n    (e: ChangeEvent<HTMLSelectElement>) => {\n      const selected = e.target.value\n\n      if (selected === parent) {\n        return\n      }\n\n      setParent(selected)\n      setValue('')\n    },\n    [parent]\n  )\n\n  const handleChangeValue = useCallback(\n    (e: ChangeEvent<HTMLSelectElement>) => {\n      const selected = e.target.value\n\n      if (selected === value) {\n        return\n      }\n\n      setValue(selected)\n    },\n    [value]\n  )\n\n  const handleRequestClose = useCallback(() => {\n    setParent('')\n    setValue('')\n    onRequestClose?.()\n  }, [onRequestClose])\n\n  const handlePressSubmit = useCallback(() => {\n    onSubmitEditing?.({\n      parent,\n      value\n    })\n    handleRequestClose()\n  }, [handleRequestClose, onSubmitEditing, parent, value])\n\n  return (\n    <Popup\n      position='down'\n      alignment='start'\n      isVisible={isVisible}\n      onRequestClose={handleRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default p-8 space-y-8 w-320 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        <Field label='Only show when...'>\n          <select value={parent} onChange={handleChangeParent}>\n            <option hidden value=''>\n              Choose one\n            </option>\n            {editableNodes.map((o) => (\n              <option key={o.id} value={o.id}>\n                {o.defaultValue}({o.label})\n              </option>\n            ))}\n          </select>\n        </Field>\n        <Field label='equals...'>\n          <select value={value} onChange={handleChangeValue}>\n            <option hidden value=''>\n              Choose one\n            </option>\n            {options.map((o) => (\n              <option key={o.id} value={o.id}>\n                {o.label}\n              </option>\n            ))}\n          </select>\n        </Field>\n        <div className='flex justify-end'>\n          <Button\n            disabled={!isValid}\n            className='h-32'\n            onPress={handlePressSubmit}\n          >\n            Add condition\n          </Button>\n        </div>\n      </div>\n    </Popup>\n  )\n}\n\nexport default ConditionPopup\n","import React, { FC, MutableRefObject, useCallback } from 'react'\nimport { FiInbox } from '@react-icons/all-files/fi/FiInbox'\nimport { useOrphanNodes } from '../../../core/hooks'\nimport Icon from '../../icon'\nimport Popup from '../../popup'\nimport { FaRegTrashAlt } from '@react-icons/all-files/fa/FaRegTrashAlt'\n\ntype OrphanNodesPopupProps = {\n  anchorRef: MutableRefObject<Element>\n  isVisible: boolean\n  onRequestClose: Fn\n}\n\nconst OrphanNodesPopup: FC<OrphanNodesPopupProps> = ({\n  anchorRef,\n  isVisible,\n  onRequestClose\n}) => {\n  const [orphanNodes, setOrphanNodes] = useOrphanNodes()\n\n  const handlePressDelete = useCallback(\n    (id: string) => {\n      const eventualValue = [...orphanNodes]\n      const index = eventualValue.findIndex((o) => o.id === id)\n\n      if (!~index) {\n        return\n      }\n\n      eventualValue.splice(index, 1)\n      setOrphanNodes(eventualValue)\n    },\n    [orphanNodes, setOrphanNodes]\n  )\n\n  return (\n    <Popup\n      position='down'\n      alignment='end'\n      isVisible={isVisible}\n      onRequestClose={onRequestClose}\n      anchorRef={anchorRef}\n      transparent\n      hideArrow\n      overlayCloseOnClick\n      contentClassName='rounded-default'\n    >\n      <div className='rounded-default p-8 space-y-8 w-320 bg-white border border-gray-300 overflow-hidden text-gray-500'>\n        {!orphanNodes.length && (\n          <div className='flex flex-col items-center justify-center text-center py-20 space-y-4'>\n            <Icon className='text-blue-500 s-28'>\n              <FiInbox />\n            </Icon>\n            <div className='text-heading-2 font-medium'>Spick and span!</div>\n            <div className='text-subhead'>\n              Choose the <span className='text-blue-500'>Save to Icebox</span>{' '}\n              option to create standalone editables that do not appear in the\n              document.\n            </div>\n          </div>\n        )}\n        <div className='space-y-4'>\n          {orphanNodes.map(({ id, defaultValue }) => (\n            <div\n              key={id as any}\n              className='rounded-default bg-blue-500 text-white font-medium px-8 py-8 flex items-center'\n            >\n              <div className='flex-1'>{defaultValue}</div>\n              <Icon\n                onPress={() => handlePressDelete(id as any)}\n                className='cursor-pointer text-white opacity-50 transition-opacity duration-250 hover:opacity-100'\n              >\n                <FaRegTrashAlt />\n              </Icon>\n            </div>\n          ))}\n        </div>\n      </div>\n    </Popup>\n  )\n}\n\nexport default OrphanNodesPopup\n","import React, { FC, useRef, Fragment, useCallback } from 'react'\nimport IconButton from '../icon-button'\nimport { RiImage2Fill } from '@react-icons/all-files/ri/RiImage2Fill'\nimport { RiImageEditFill } from '@react-icons/all-files/ri/RiImageEditFill'\nimport classnames from 'classnames'\nimport { GrUndo } from '@react-icons/all-files/gr/GrUndo'\nimport { GrRedo } from '@react-icons/all-files/gr/GrRedo'\nimport { MdFormatAlignCenter } from '@react-icons/all-files/md/MdFormatAlignCenter'\nimport { MdFormatAlignJustify } from '@react-icons/all-files/md/MdFormatAlignJustify'\nimport { MdFormatAlignLeft } from '@react-icons/all-files/md/MdFormatAlignLeft'\nimport { MdFormatAlignRight } from '@react-icons/all-files/md/MdFormatAlignRight'\nimport { MdFormatBold } from '@react-icons/all-files/md/MdFormatBold'\nimport { MdFormatIndentDecrease } from '@react-icons/all-files/md/MdFormatIndentDecrease'\nimport { MdFormatIndentIncrease } from '@react-icons/all-files/md/MdFormatIndentIncrease'\nimport { MdFormatItalic } from '@react-icons/all-files/md/MdFormatItalic'\nimport { MdFormatListBulleted } from '@react-icons/all-files/md/MdFormatListBulleted'\nimport { MdFormatListNumbered } from '@react-icons/all-files/md/MdFormatListNumbered'\nimport { MdFormatSize } from '@react-icons/all-files/md/MdFormatSize'\nimport { MdFormatStrikethrough } from '@react-icons/all-files/md/MdFormatStrikethrough'\nimport { MdFormatUnderlined } from '@react-icons/all-files/md/MdFormatUnderlined'\nimport { MdTextFields } from '@react-icons/all-files/md/MdTextFields'\nimport { MdTransform } from '@react-icons/all-files/md/MdTransform'\nimport { FiInbox } from '@react-icons/all-files/fi/FiInbox'\nimport Icon from '../icon'\nimport IconGroup from '../icon-group'\nimport {\n  useTextSizeValue,\n  useLeafColorValue,\n  useMouseDown,\n  usePopupUtils,\n  useAlignmentValue,\n  useEditor,\n  useCanUndo,\n  useCanRedo,\n  useConditionActive,\n  useOrphanNodes\n} from '../../core/hooks'\nimport TextSizePopup from '../popups/text-size'\nimport ColorPopup from '../popups/color'\nimport {\n  BlockAlignment,\n  createEditableNode,\n  decreaseIndentation,\n  EditableAttributes,\n  EditableRefAttributes,\n  focusEditor,\n  HeadingFormatType,\n  increaseIndentation,\n  insertEditableBlock,\n  insertImageBlock,\n  isBlockActive,\n  isMarkActive,\n  LeafFormatType,\n  setAlignment,\n  setConditionActive,\n  toggleBlockActive,\n  toggleColorMarkActive,\n  toggleMarkActive,\n  unsetConditionActive\n} from '../../core/tools'\nimport { ImageDimensions, nil, notNil } from '../../core/utils'\nimport { Transforms } from 'slate'\nimport { ALIGNMENTS } from '../../core/constants'\nimport { HistoryEditor } from 'slate-history'\nimport ImagePopup, { ImageProps } from '../popups/image'\nimport ImageSizePopup from '../popups/image-size'\nimport EditablePopupProps from '../popups/editable'\nimport ConditionPopup from '../popups/condition'\nimport OrphanNodesPopup from '../popups/orphan-nodes'\n\nconst Toolbar: FC = () => {\n  const editor = useEditor()\n  const editorSelection = useRef(editor.selection)\n\n  const textSizePopupAnchorRef = useRef(null)\n  const colorPopupAnchorRef = useRef(null)\n  const imagePopupAnchorRef = useRef(null)\n  const imageSizePopupAnchorRef = useRef(null)\n  const conditionPopupAnchorRef = useRef(null)\n  const orphanNodesPopupAnchorRef = useRef(null)\n\n  const textSizePopup = usePopupUtils()\n  const colorPopup = usePopupUtils()\n  const imagePopup = usePopupUtils()\n  const imageSizePopup = usePopupUtils()\n  const editablePopup = usePopupUtils()\n  const conditionPopup = usePopupUtils()\n  const orphanNodesPopup = usePopupUtils()\n\n  const textSizeValue = useTextSizeValue()\n  const leafColorValue = useLeafColorValue()\n  const alignmentValue = useAlignmentValue()\n  const canUndo = useCanUndo()\n  const canRedo = useCanRedo()\n  const conditionActive = useConditionActive()\n\n  const [, setOrphanNodes] = useOrphanNodes()\n\n  const handleChangeTextSizeOption = useCallback(\n    (value: HeadingFormatType) => {\n      const prevValue = textSizeValue?.name\n\n      if (value === prevValue) {\n        return\n      }\n\n      if (notNil(prevValue)) {\n        toggleBlockActive(editor, prevValue)\n      }\n\n      if (notNil(value)) {\n        toggleBlockActive(editor, value)\n      }\n\n      focusEditor(editor)\n    },\n    [editor, textSizeValue]\n  )\n\n  const handleChangeColorOption = useCallback(\n    (value: string, focus = true) => {\n      const prevValue = leafColorValue\n\n      if (value === prevValue) {\n        return\n      }\n\n      if (notNil(editorSelection.current)) {\n        Transforms.select(editor, editorSelection.current)\n      }\n\n      if (notNil(prevValue)) {\n        toggleColorMarkActive(editor, prevValue)\n      }\n\n      if (notNil(value)) {\n        toggleColorMarkActive(editor, value)\n      }\n\n      editorSelection.current = editor.selection\n\n      if (focus) {\n        focusEditor(editor)\n      }\n    },\n    [editor, leafColorValue]\n  )\n\n  const handleCreateImage = useCallback(\n    (value: ImageProps) => {\n      if (notNil(editorSelection.current)) {\n        Transforms.select(editor, editorSelection.current)\n      }\n\n      insertImageBlock(editor, value)\n      focusEditor(editor)\n    },\n    [editor]\n  )\n\n  const handleCreateEditableImage = useCallback(\n    (value: ImageDimensions) => {\n      if (notNil(editorSelection.current)) {\n        Transforms.select(editor, editorSelection.current)\n      }\n\n      insertImageBlock(editor, { dimensions: value }, true)\n      focusEditor(editor)\n    },\n    [editor]\n  )\n\n  const handleCreateEditable = useCallback(\n    (value: EditableAttributes, isOrphan = false) => {\n      if (notNil(editorSelection.current)) {\n        Transforms.select(editor, editorSelection.current)\n      }\n\n      if (isOrphan) {\n        const editableNode = createEditableNode(value, true)\n        setOrphanNodes((o) => [editableNode, ...o])\n      } else {\n        insertEditableBlock(editor, value)\n      }\n\n      focusEditor(editor)\n    },\n    [editor, setOrphanNodes]\n  )\n\n  const handleSetConditionActive = useCallback(\n    (value: EditableRefAttributes) => {\n      if (notNil(editorSelection.current)) {\n        Transforms.select(editor, editorSelection.current)\n      }\n\n      setConditionActive(editor, value)\n      focusEditor(editor)\n    },\n    [editor]\n  )\n\n  const handlePressTextSize = useMouseDown(() => {\n    textSizePopup.open()\n  })\n\n  const handlePressColor = useMouseDown(() => {\n    editorSelection.current = editor.selection\n    colorPopup.open()\n  })\n\n  const handlePressImage = useMouseDown(() => {\n    editorSelection.current = editor.selection\n    imagePopup.open()\n  })\n\n  const handlePressEditableImage = useMouseDown(() => {\n    editorSelection.current = editor.selection\n    imageSizePopup.open()\n  })\n\n  const handlePressInsertEditable = useMouseDown(() => {\n    editorSelection.current = editor.selection\n    editablePopup.open()\n  })\n\n  const handlePressCondition = useMouseDown(() => {\n    if (conditionActive) {\n      unsetConditionActive(editor)\n      return\n    }\n\n    editorSelection.current = editor.selection\n    conditionPopup.open()\n  })\n\n  const handlePressInlineFormat = useCallback(\n    (format: LeafFormatType) => {\n      toggleMarkActive(editor, format)\n    },\n    [editor]\n  )\n\n  const handlePressAlignment = useCallback(\n    (value?: BlockAlignment) => {\n      setAlignment(editor, value)\n    },\n    [editor]\n  )\n\n  const handlePressIncreaseIndentation = useCallback(() => {\n    increaseIndentation(editor)\n  }, [editor])\n\n  const handlePressDecreaseIndentation = useCallback(() => {\n    decreaseIndentation(editor)\n  }, [editor])\n\n  const handlePressNumberedList = useCallback(() => {\n    toggleBlockActive(editor, 'numbered-list')\n  }, [editor])\n\n  const handlePressBulletedList = useCallback(() => {\n    toggleBlockActive(editor, 'bulleted-list')\n  }, [editor])\n\n  const handlePressUndo = useCallback(() => {\n    HistoryEditor.undo(editor)\n  }, [editor])\n\n  const handlePressRedo = useCallback(() => {\n    HistoryEditor.redo(editor)\n  }, [editor])\n\n  return (\n    <Fragment>\n      <div className='border-t border-b border-solid border-gray-300 py-20 px-60 bg-blue-50 flex items-center divide-x divide-gray-300 text-gray-500'>\n        <div className='font-medium flex items-center'>\n          <div\n            ref={textSizePopupAnchorRef}\n            className='flex items-center w-144 space-x-4 flex-1'\n            onMouseDown={handlePressTextSize}\n          >\n            <Icon>\n              <MdFormatSize />\n            </Icon>\n            <span className='flex-1 cursor-pointer transition-colors duration-250 hover:text-blue-500'>\n              {textSizeValue?.label || 'Normal'}\n            </span>\n          </div>\n          <div\n            ref={colorPopupAnchorRef}\n            className={classnames(\n              's-28 cursor-pointer border-2 border-solid border-white mx-16 rounded-full shadow-2 transition-colors duration-250',\n              {\n                'bg-black': nil(leafColorValue)\n              }\n            )}\n            style={{ backgroundColor: leafColorValue }}\n            onMouseDown={handlePressColor}\n          />\n        </div>\n        <IconGroup>\n          <IconButton\n            data='bold'\n            active={isMarkActive(editor, 'bold')}\n            onPress={handlePressInlineFormat}\n          >\n            <MdFormatBold />\n          </IconButton>\n          <IconButton\n            data='italic'\n            active={isMarkActive(editor, 'italic')}\n            onPress={handlePressInlineFormat}\n          >\n            <MdFormatItalic />\n          </IconButton>\n          <IconButton\n            data='underline'\n            active={isMarkActive(editor, 'underline')}\n            onPress={handlePressInlineFormat}\n          >\n            <MdFormatUnderlined />\n          </IconButton>\n          <IconButton\n            data='strikethrough'\n            active={isMarkActive(editor, 'strikethrough')}\n            onPress={handlePressInlineFormat}\n          >\n            <MdFormatStrikethrough />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton\n            active={nil(alignmentValue) || alignmentValue === ALIGNMENTS.left}\n            onPress={handlePressAlignment}\n          >\n            <MdFormatAlignLeft />\n          </IconButton>\n          <IconButton\n            data='center'\n            active={alignmentValue === ALIGNMENTS.center}\n            onPress={handlePressAlignment}\n          >\n            <MdFormatAlignCenter />\n          </IconButton>\n          <IconButton\n            data='right'\n            active={alignmentValue === ALIGNMENTS.right}\n            onPress={handlePressAlignment}\n          >\n            <MdFormatAlignRight />\n          </IconButton>\n          <IconButton\n            data='justify'\n            active={alignmentValue === ALIGNMENTS.justify}\n            onPress={handlePressAlignment}\n          >\n            <MdFormatAlignJustify />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton onPress={handlePressDecreaseIndentation}>\n            <MdFormatIndentDecrease />\n          </IconButton>\n          <IconButton onPress={handlePressIncreaseIndentation}>\n            <MdFormatIndentIncrease />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton\n            active={isBlockActive(editor, 'numbered-list')}\n            onPress={handlePressNumberedList}\n          >\n            <MdFormatListNumbered />\n          </IconButton>\n          <IconButton\n            active={isBlockActive(editor, 'bulleted-list')}\n            onPress={handlePressBulletedList}\n          >\n            <MdFormatListBulleted />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton\n            ref={imagePopupAnchorRef}\n            active={imagePopup.visible}\n            onPress={handlePressImage}\n          >\n            <RiImage2Fill />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton\n            ref={imageSizePopupAnchorRef}\n            active={imageSizePopup.visible}\n            onPress={handlePressEditableImage}\n            className='border border-dotted border-gray-500'\n          >\n            <RiImageEditFill />\n          </IconButton>\n          <IconButton\n            active={editablePopup.visible}\n            className='border border-dotted border-gray-500'\n            onPress={handlePressInsertEditable}\n          >\n            <MdTextFields />\n          </IconButton>\n          <IconButton\n            ref={conditionPopupAnchorRef}\n            active={conditionActive || conditionPopup.visible}\n            onPress={handlePressCondition}\n            className='border border-dotted border-gray-500'\n          >\n            <MdTransform />\n          </IconButton>\n        </IconGroup>\n        <IconGroup>\n          <IconButton onPress={handlePressUndo} disabled={!canUndo}>\n            <GrUndo />\n          </IconButton>\n          <IconButton onPress={handlePressRedo} disabled={!canRedo}>\n            <GrRedo />\n          </IconButton>\n        </IconGroup>\n        <div className='flex flex-1 items-center justify-end border-none'>\n          <IconButton\n            ref={orphanNodesPopupAnchorRef}\n            active={orphanNodesPopup.visible}\n            onPress={orphanNodesPopup.open}\n          >\n            <FiInbox />\n          </IconButton>\n        </div>\n      </div>\n      <TextSizePopup\n        anchorRef={textSizePopupAnchorRef}\n        isVisible={textSizePopup.visible}\n        value={textSizeValue?.name}\n        onPressOption={handleChangeTextSizeOption}\n        onRequestClose={textSizePopup.close}\n      />\n      <ColorPopup\n        anchorRef={colorPopupAnchorRef}\n        isVisible={colorPopup.visible}\n        value={leafColorValue}\n        onChangeColorOption={handleChangeColorOption}\n        onRequestClose={colorPopup.close}\n      />\n      <ImagePopup\n        anchorRef={imagePopupAnchorRef}\n        isVisible={imagePopup.visible}\n        onRequestClose={imagePopup.close}\n        onSubmitEditing={handleCreateImage}\n      />\n      <ImageSizePopup\n        anchorRef={imageSizePopupAnchorRef}\n        isVisible={imageSizePopup.visible}\n        onRequestClose={imageSizePopup.close}\n        onSubmitEditing={handleCreateEditableImage}\n      />\n      <EditablePopupProps\n        isVisible={editablePopup.visible}\n        onRequestClose={editablePopup.close}\n        onSubmit={handleCreateEditable}\n      />\n      <ConditionPopup\n        anchorRef={conditionPopupAnchorRef}\n        isVisible={conditionPopup.visible}\n        onRequestClose={conditionPopup.close}\n        onSubmitEditing={handleSetConditionActive}\n      />\n      <OrphanNodesPopup\n        anchorRef={orphanNodesPopupAnchorRef}\n        isVisible={orphanNodesPopup.visible}\n        onRequestClose={orphanNodesPopup.close}\n      />\n    </Fragment>\n  )\n}\n\nexport default Toolbar\n","import React, { FC } from 'react'\n\ntype TemplateEditorProps = {}\n\nconst TemplateEditor: FC<TemplateEditorProps> = ({ children }) => {\n  return <div className='max-w-6xl m-auto pt-120 px-60'>{children}</div>\n}\n\nexport default TemplateEditor\n","import { Editor, Transforms, Element as SlateElement } from 'slate'\nimport { jsx } from 'slate-hyperscript'\nimport { ReactEditor } from 'slate-react'\n\nconst ELEMENT_TAGS = {\n  A: (element: Element) => ({\n    type: 'link',\n    url: element.getAttribute('href')\n  }),\n  BLOCKQUOTE: () => ({ type: 'quote' }),\n  H1: () => ({ type: 'heading-one' }),\n  H2: () => ({ type: 'heading-two' }),\n  H3: () => ({ type: 'heading-three' }),\n  H4: () => ({ type: 'heading-four' }),\n  H5: () => ({ type: 'heading-five' }),\n  H6: () => ({ type: 'heading-six' }),\n  IMG: (element: Element) => ({\n    type: 'image',\n    url: element.getAttribute('src')\n  }),\n  LI: () => ({ type: 'list-item' }),\n  OL: () => ({ type: 'numbered-list' }),\n  P: () => ({ type: 'paragraph' }),\n  PRE: () => ({ type: 'code' }),\n  UL: () => ({ type: 'bulleted-list' })\n}\n\nconst TEXT_TAGS = {\n  CODE: () => ({ code: true }),\n  DEL: () => ({ strikethrough: true }),\n  EM: () => ({ italic: true }),\n  I: () => ({ italic: true }),\n  S: () => ({ strikethrough: true }),\n  STRONG: () => ({ bold: true }),\n  U: () => ({ underline: true })\n}\n\nexport const deserializeHTML = (el: ChildNode) => {\n  if (el.nodeType === 3) {\n    return el.textContent\n  } else if (el.nodeType !== 1) {\n    return null\n  } else if (el.nodeName === 'BR') {\n    return '\\n'\n  }\n\n  const { nodeName } = el\n  let parent = el\n\n  if (\n    nodeName === 'PRE' &&\n    el.childNodes[0] &&\n    el.childNodes[0].nodeName === 'CODE'\n  ) {\n    parent = el.childNodes[0]\n  }\n\n  const children = Array.from(parent.childNodes).map(deserializeHTML).flat()\n\n  if (el.nodeName === 'BODY') {\n    return jsx('fragment', {}, children)\n  }\n\n  if (ELEMENT_TAGS[nodeName]) {\n    const attrs = ELEMENT_TAGS[nodeName](el)\n    return jsx('element', attrs, children)\n  }\n\n  if (TEXT_TAGS[nodeName]) {\n    const attrs = TEXT_TAGS[nodeName](el)\n    return children.map((child) => jsx('text', attrs, child))\n  }\n\n  return children\n}\n\nexport const withHTML = (editor: Editor & ReactEditor) => {\n  const { insertData, isInline, isVoid } = editor\n\n  editor.isInline = (element: SlateElement) => {\n    return ['link', 'image'].includes(element.type as string)\n      ? true\n      : isInline(element)\n  }\n\n  editor.isVoid = (element) => {\n    return element.type === 'image' ? true : isVoid(element)\n  }\n\n  editor.insertData = (data) => {\n    const html = data.getData('text/html')\n\n    if (html) {\n      const parsed = new DOMParser().parseFromString(html, 'text/html')\n      const fragment = deserializeHTML(parsed.body)\n      Transforms.insertFragment(editor, fragment)\n      return\n    }\n\n    insertData(data)\n  }\n\n  return editor\n}\n","import React, { FC, PropsWithChildren, useMemo } from 'react'\nimport { useFocused, useSelected } from 'slate-react'\nimport classnames from 'classnames'\nimport { EditableElementType } from '../../../core/tools'\nimport { getPlaceholderImage } from '../../../core/utils'\n\nexport type ImageElementType = EditableElementType<{\n  url: string\n  width?: number\n  height?: number\n}>\n\ntype ImageElementProps = PropsWithChildren<{\n  attributes: any\n  element: ImageElementType\n}>\n\nconst ImageElement: FC<ImageElementProps> = ({\n  attributes,\n  children,\n  element\n}) => {\n  const selected = useSelected()\n  const focused = useFocused()\n  const url = useMemo(\n    () =>\n      element.editable\n        ? getPlaceholderImage(element.width, element.height)\n        : element.url,\n    [element.editable, element.height, element.url, element.width]\n  )\n\n  return (\n    <span {...attributes}>\n      {children}\n      <img\n        src={url}\n        style={{ width: element.width, height: element.height }}\n        className={classnames(\n          'inline-block max-w-full rounded-default align-bottom',\n          {\n            'shadow-outline': selected && focused\n          }\n        )}\n      />\n    </span>\n  )\n}\n\nexport default ImageElement\n","import React, { FC, PropsWithChildren, useEffect } from 'react'\nimport { useFocused, useSelected } from 'slate-react'\nimport classnames from 'classnames'\nimport {\n  composeWithClassName,\n  composeWithStyle,\n  EditableAttributes,\n  EditableElementType\n} from '../../../core/tools'\n\ntype EditableElementProps = PropsWithChildren<{\n  attributes: any\n  element: EditableElementType<EditableAttributes>\n}>\n\nconst EditableElement: FC<EditableElementProps> = ({\n  attributes,\n  children,\n  element\n}) => {\n  const selected = useSelected()\n  const focused = useFocused()\n\n  useEffect(() => {\n    return () => {\n      // TODO: Find refs that match unset ref value\n    }\n  }, [])\n\n  return (\n    <span\n      {...composeWithStyle(\n        composeWithClassName(\n          attributes,\n          classnames(\n            'bg-blue-500 text-white font-medium px-4 py-2 rounded-default mx-1',\n            {\n              'shadow-outline': selected && focused\n            }\n          )\n        ),\n        { fontSize: '0.82em' }\n      )}\n      contentEditable={false}\n    >\n      {element.defaultValue}\n      {children}\n    </span>\n  )\n}\n\nexport default EditableElement\n","import React, { FC, PropsWithChildren } from 'react'\nimport ImageElement, { ImageElementType } from '../elements/image'\nimport {\n  BlockAlignment,\n  composeWithAlignmentClassName,\n  composeWithClassName,\n  composeWithStyle,\n  EditableAttributes,\n  EditableElementType,\n  getIndentationPercent\n} from '../../core/tools'\nimport EditableElement from '../elements/editable'\n\nexport type ElementType =\n  | 'quote'\n  | 'code'\n  | 'bulleted-list'\n  | 'heading-one'\n  | 'heading-two'\n  | 'heading-three'\n  | 'heading-four'\n  | 'heading-five'\n  | 'heading-six'\n  | 'list-item'\n  | 'numbered-list'\n  | 'link'\n  | 'image'\n  | 'editable'\n\ntype TemplateElementType = {\n  type: ElementType\n  alignment?: BlockAlignment\n  indentation?: number\n} & ImageElementType &\n  EditableElementType<EditableAttributes>\n\ntype TemplateElementProps = PropsWithChildren<{\n  attributes: any\n  element: TemplateElementType\n}>\n\nconst TemplateElement: FC<TemplateElementProps> = ({\n  attributes,\n  children,\n  element\n}) => {\n  const { type, url, alignment, indentation } = element\n\n  switch (type) {\n    default:\n      return (\n        <p\n          {...composeWithStyle(\n            composeWithAlignmentClassName(attributes, alignment),\n            { paddingLeft: getIndentationPercent(indentation) }\n          )}\n        >\n          {children}\n        </p>\n      )\n    case 'quote':\n      return <blockquote {...attributes}>{children}</blockquote>\n    case 'code':\n      return (\n        <pre>\n          <code {...attributes}>{children}</code>\n        </pre>\n      )\n    case 'bulleted-list':\n      return (\n        <ul {...composeWithClassName(attributes, 'list-disc list-inside')}>\n          {children}\n        </ul>\n      )\n    case 'heading-one':\n      return (\n        <h1\n          {...composeWithStyle(\n            composeWithAlignmentClassName(\n              attributes,\n              alignment,\n              'text-heading-2'\n            ),\n            { paddingLeft: getIndentationPercent(indentation) }\n          )}\n        >\n          {children}\n        </h1>\n      )\n    case 'heading-two':\n      return (\n        <h2\n          {...composeWithStyle(\n            composeWithAlignmentClassName(\n              attributes,\n              alignment,\n              'text-heading-3'\n            ),\n            { paddingLeft: getIndentationPercent(indentation) }\n          )}\n        >\n          {children}\n        </h2>\n      )\n    case 'heading-three':\n      return (\n        <h3\n          {...(composeWithStyle(\n            composeWithAlignmentClassName(\n              attributes,\n              alignment,\n              'text-headline'\n            )\n          ),\n          { paddingLeft: getIndentationPercent(indentation) })}\n        >\n          {children}\n        </h3>\n      )\n    case 'heading-four':\n      return <h4 {...attributes}>{children}</h4>\n    case 'heading-five':\n      return <h5 {...attributes}>{children}</h5>\n    case 'heading-six':\n      return <h6 {...attributes}>{children}</h6>\n    case 'list-item':\n      return (\n        <li\n          {...composeWithStyle(attributes, {\n            paddingLeft: getIndentationPercent(indentation)\n          })}\n        >\n          {children}\n        </li>\n      )\n    case 'numbered-list':\n      return (\n        <ol {...composeWithClassName(attributes, 'list-decimal list-inside')}>\n          {children}\n        </ol>\n      )\n    case 'link':\n      return (\n        <a href={url} {...attributes}>\n          {children}\n        </a>\n      )\n    case 'image':\n      return <ImageElement {...{ attributes, children, element }} />\n    case 'editable':\n      return <EditableElement {...{ attributes, children, element }} />\n  }\n}\n\nexport default TemplateElement\n","import React, { FC, PropsWithChildren } from 'react'\nimport {\n  composeWithClassName,\n  composeWithStyle,\n  EditableRefAttributes\n} from '../../core/tools'\nimport classnames from 'classnames'\nimport { notNil } from '../../core/utils'\n\nexport type TemplateLeafType = Partial<{\n  bold: boolean\n  code: boolean\n  italic: boolean\n  underline: boolean\n  strikethrough: boolean\n  color: string\n  ref: EditableRefAttributes\n}>\n\ntype TemplateLeafProps = PropsWithChildren<{\n  attributes: any\n  leaf: TemplateLeafType\n}>\n\nconst TemplateLeaf: FC<TemplateLeafProps> = ({\n  attributes,\n  children,\n  leaf\n}) => {\n  if (leaf.bold) {\n    children = <strong>{children}</strong>\n  }\n\n  if (leaf.code) {\n    children = <code>{children}</code>\n  }\n\n  if (leaf.italic) {\n    children = <em>{children}</em>\n  }\n\n  if (leaf.underline) {\n    children = <u>{children}</u>\n  }\n\n  if (leaf.strikethrough) {\n    children = <del>{children}</del>\n  }\n\n  return (\n    <span\n      {...composeWithClassName(\n        composeWithStyle(attributes, { color: leaf.color }),\n        classnames({ 'bg-green-highlight': notNil(leaf.ref) })\n      )}\n    >\n      {children}\n    </span>\n  )\n}\n\nexport default TemplateLeaf\n","import React, {\n  useCallback,\n  useMemo,\n  useRef,\n  useState,\n  KeyboardEvent\n} from 'react'\nimport classnames from 'classnames'\nimport 'tailwindcss/tailwind.css'\nimport Header from './modules/header'\nimport Toolbar from './modules/toolbar'\nimport TemplateEditor from './modules/template-editor'\nimport { withHistory } from 'slate-history'\nimport { Editable, Slate, withReact } from 'slate-react'\nimport { createEditor, Node } from 'slate'\nimport { stripHTMLEntities, toDate } from './core/utils'\nimport { withHTML } from './core/plugins/paste-html'\nimport TemplateElement from './modules/template-element'\nimport TemplateLeaf from './modules/template-leaf'\nimport { HOT_KEYS } from './core/constants'\nimport isHotkey from 'is-hotkey'\nimport { DocmakerData, SlateEditorType, toggleMarkActive } from './core/tools'\nimport { withEditable } from './core/plugins/editable'\nimport OrphanNodesContext from './core/contexts/orphan-nodes'\n\ninterface Props {\n  className?: string\n  initialValue?: DocmakerData\n  onSubmitChanges?: (data: DocmakerData) => void\n}\n\nexport const DocmakerEditor = ({\n  className,\n  initialValue,\n  onSubmitChanges\n}: Props) => {\n  const initialData = useRef(initialValue || ({} as DocmakerData)).current\n  const editor = useMemo(\n    () => withEditable(withHTML(withReact(withHistory(createEditor())))),\n    []\n  )\n  const createdAt = useRef(toDate(initialData.createdAt).toISOString()).current\n\n  const [title, setTitle] = useState(initialData.title || '')\n  const [orphanNodes, setOrphanNodes] = useState<Array<Node>>(\n    initialData.orphans || []\n  )\n  const [editorState, setEditorState] = useState<Array<Node>>(\n    initialData.nodes?.length\n      ? initialData.nodes\n      : [\n          {\n            type: 'paragraph',\n            children: [{ text: '' }]\n          }\n        ]\n  )\n\n  const renderElement = useCallback(\n    (props) => <TemplateElement {...props} />,\n    []\n  )\n\n  const renderLeaf = useCallback((props) => <TemplateLeaf {...props} />, [])\n\n  const handleEditorKeydown = useCallback(\n    (event: KeyboardEvent) => {\n      for (const hotkey in HOT_KEYS) {\n        if (isHotkey(hotkey, event as any)) {\n          event.preventDefault()\n          const mark = HOT_KEYS[hotkey]\n          toggleMarkActive(editor as SlateEditorType, mark)\n        }\n      }\n    },\n    [editor]\n  )\n\n  const handlePressSave = useCallback(() => {\n    onSubmitChanges?.({\n      title: stripHTMLEntities(title),\n      createdAt,\n      nodes: editorState as any,\n      orphans: orphanNodes as any\n    })\n  }, [onSubmitChanges, title, createdAt, editorState, orphanNodes])\n\n  return (\n    <div className={classnames('font-sans', className)}>\n      <OrphanNodesContext.Provider value={[orphanNodes, setOrphanNodes]}>\n        <Slate editor={editor} value={editorState} onChange={setEditorState}>\n          <div className='sticky top-0'>\n            <Header\n              title={title}\n              createdAt={createdAt}\n              onChangeTitle={setTitle}\n              onPressSave={handlePressSave}\n            />\n            <Toolbar />\n          </div>\n          <TemplateEditor>\n            <Editable\n              spellCheck\n              placeholder='Start typing...'\n              renderElement={renderElement}\n              renderLeaf={renderLeaf}\n              onKeyDown={handleEditorKeydown}\n            />\n          </TemplateEditor>\n        </Slate>\n      </OrphanNodesContext.Provider>\n    </div>\n  )\n}\n","import { Editor, Element as SlateElement } from 'slate'\nimport { ReactEditor } from 'slate-react'\n\nexport const withEditable = (editor: Editor & ReactEditor) => {\n  const { isInline, isVoid } = editor\n\n  editor.isInline = (element: SlateElement) => {\n    return element.type === 'editable' ? true : isInline(element)\n  }\n\n  editor.isVoid = (element: SlateElement) => {\n    return element.type === 'editable' ? true : isVoid(element)\n  }\n\n  return editor\n}\n","import React from 'react'\n\nimport { DocmakerEditor } from 'react-docmaker'\nimport 'react-docmaker/dist/index.css'\n\nconst App = () => {\n  return <DocmakerEditor onSubmitChanges={console.log} />\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}